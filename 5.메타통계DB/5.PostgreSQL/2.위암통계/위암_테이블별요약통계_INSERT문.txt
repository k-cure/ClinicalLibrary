-- 10001 // 위암 환자수 
	INSERT INTO CNCR_TBL_SMRY_STATS 	SELECT * FROM (WITH W1 AS( SELECT 10001 AS SMRY_STATS_NO, HCODE, PTNO, SUBSTRING(FDX,1,4) AS CRIT_YR, CAST(AGE AS NUMERIC) AS PT_AGE , SEX AS PT_SEX_CD, POPCODE FROM CNCR_RGST WHERE FDX BETWEEN '20100101' AND '20211231')
SELECT 10001 AS SMRY_STATS_NO, A.HCODE AS HOSP_CD, A.CRIT_YR, '위암 환자수' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD, A.POPCODE AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT, '20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT
	FROM (SELECT HCODE, CRIT_YR,PT_AGE,PT_SEX_CD,POPCODE,COUNT(POPCODE) AS NCS, COUNT(DISTINCT PTNO) AS PT_CNT FROM W1 GROUP BY HCODE, CRIT_YR,PT_AGE,PT_SEX_CD, POPCODE) AS A INNER JOIN ( SELECT HCODE,CRIT_YR,PT_AGE,PT_SEX_CD, COUNT(POPCODE)	 AS WHOL_NCS, COUNT(DISTINCT PTNO) AS WHOL_PT_CNT FROM W1 GROUP BY HCODE, CRIT_YR,PT_AGE,PT_SEX_CD) AS B 
ON A.HCODE = B.HCODE AND A.CRIT_YR = B.CRIT_YR AND A.PT_AGE=B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD 	INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON
ENG_TBL_NM = 'CNCR_RGST' AND ENG_COL_NM = 'POPCODE')xx WHERE STATS_TRGT_VL IS NOT NULL AND STATS_TRGT_VL ='04';				

-- 10002 // 위암 음주여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10002, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CUR_DRNK_YN_NOANS_SPCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10002 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 음주여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.CUR_DRNK_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CUR_DRNK_YN_NOANS_SPCD,
COUNT(CUR_DRNK_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CUR_DRNK_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CUR_DRNK_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'CUR_DRNK_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10003 // 위암 음주력여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10003, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DHIS_YN_NOANS_SPCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10003 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 음주력여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DHIS_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DHIS_YN_NOANS_SPCD,
COUNT(DHIS_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DHIS_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DHIS_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'DHIS_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10004 // 위암 음주시작연령별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10004, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRNK_STRT_AGE_VL FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10004 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 음주시작연령별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRNK_STRT_AGE_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRNK_STRT_AGE_VL,
COUNT(DRNK_STRT_AGE_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRNK_STRT_AGE_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRNK_STRT_AGE_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'DRNK_STRT_AGE_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10005 // 위암 음주종류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10005, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRNK_KNCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10005 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 음주종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRNK_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRNK_KNCD,
COUNT(DRNK_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRNK_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRNK_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'DRNK_KNCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10006 // 위암 음주량별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10006, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRNK_QTY FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10006 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 음주량별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRNK_QTY AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRNK_QTY,
COUNT(DRNK_QTY) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRNK_QTY) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRNK_QTY) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'DRNK_QTY') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10007 // 위암 음주횟수별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10007, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRNK_NT FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10007 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 음주횟수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRNK_NT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRNK_NT,
COUNT(DRNK_NT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRNK_NT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRNK_NT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'DRNK_NT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10008 // 위암 음주기간년수별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10008, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRNK_DTRN_YCNT FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10008 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 음주기간년수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRNK_DTRN_YCNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRNK_DTRN_YCNT,
COUNT(DRNK_DTRN_YCNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRNK_DTRN_YCNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRNK_DTRN_YCNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'DRNK_DTRN_YCNT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10009 // 위암 금주시작년도별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10009, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.NDRK_STRT_YR FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10009 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 금주시작년도별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.NDRK_STRT_YR AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, NDRK_STRT_YR,
COUNT(NDRK_STRT_YR) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, NDRK_STRT_YR) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(NDRK_STRT_YR) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'NDRK_STRT_YR') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10010 // 위암 흡연여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10010, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CUR_SMOK_YN_NOANS_SPCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10010 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 흡연여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.CUR_SMOK_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CUR_SMOK_YN_NOANS_SPCD,
COUNT(CUR_SMOK_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CUR_SMOK_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CUR_SMOK_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'CUR_SMOK_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10011 // 위암 흡연력여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10011, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.SHIS_YN_NOANS_SPCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10011 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 흡연력여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.SHIS_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, SHIS_YN_NOANS_SPCD,
COUNT(SHIS_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, SHIS_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(SHIS_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'SHIS_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10012 // 위암 흡연시작연령별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10012, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.SMOK_STRT_AGE_VL FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10012 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 흡연시작연령별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.SMOK_STRT_AGE_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, SMOK_STRT_AGE_VL,
COUNT(SMOK_STRT_AGE_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, SMOK_STRT_AGE_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(SMOK_STRT_AGE_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'SMOK_STRT_AGE_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10013 // 위암 흡연기간년수별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10013, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.SMOK_DTRN_YCNT FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10013 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 흡연기간년수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.SMOK_DTRN_YCNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, SMOK_DTRN_YCNT,
COUNT(SMOK_DTRN_YCNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, SMOK_DTRN_YCNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(SMOK_DTRN_YCNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'SMOK_DTRN_YCNT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10014 // 위암 흡연량별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10014, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.SMOK_QTY FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10014 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 흡연량별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.SMOK_QTY AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, SMOK_QTY,
COUNT(SMOK_QTY) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, SMOK_QTY) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(SMOK_QTY) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'SMOK_QTY') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10015 // 위암 금연시작년도별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10015, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.NSMK_STRT_YR FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10015 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 금연시작년도별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.NSMK_STRT_YR AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, NSMK_STRT_YR,
COUNT(NSMK_STRT_YR) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, NSMK_STRT_YR) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(NSMK_STRT_YR) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'NSMK_STRT_YR') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10016 // 위암 병력여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10016, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_YN_NOANS_SPCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10016 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 병력여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MHIS_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_YN_NOANS_SPCD,
COUNT(MHIS_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10017 // 위암 병력고지혈증여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10017, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_HL_YN_NOANS_SPCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10017 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 병력고지혈증여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MHIS_HL_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_HL_YN_NOANS_SPCD,
COUNT(MHIS_HL_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_HL_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_HL_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_HL_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10018 // 위암 병력고혈압여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10018, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_HTN_YN_NOANS_SPCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10018 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 병력고혈압여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MHIS_HTN_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_HTN_YN_NOANS_SPCD,
COUNT(MHIS_HTN_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_HTN_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_HTN_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_HTN_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10019 // 위암 병력당뇨여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10019, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_DBT_YN_NOANS_SPCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10019 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 병력당뇨여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MHIS_DBT_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_DBT_YN_NOANS_SPCD,
COUNT(MHIS_DBT_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_DBT_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_DBT_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_DBT_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10020 // 위암 병력결핵여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10020, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_TB_YN_NOANS_SPCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10020 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 병력결핵여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MHIS_TB_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_TB_YN_NOANS_SPCD,
COUNT(MHIS_TB_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_TB_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_TB_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_TB_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10021 // 위암 병력간질환여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10021, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_LVDS_YN_NOANS_SPCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10021 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 병력간질환여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MHIS_LVDS_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_LVDS_YN_NOANS_SPCD,
COUNT(MHIS_LVDS_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_LVDS_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_LVDS_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_LVDS_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10022 // 위암 병력암여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10022, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_CNCR_YN_NOANS_SPCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10022 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 병력암여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MHIS_CNCR_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_CNCR_YN_NOANS_SPCD,
COUNT(MHIS_CNCR_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_CNCR_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_CNCR_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_CNCR_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10023 // 위암 병력암종류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10023, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_CNCR_KNCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10023 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 병력암종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MHIS_CNCR_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_CNCR_KNCD,
COUNT(MHIS_CNCR_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_CNCR_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_CNCR_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_CNCR_KNCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10024 // 위암 병력우울증여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10024, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_DEPR_YN_NOANS_SPCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10024 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 병력우울증여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MHIS_DEPR_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_DEPR_YN_NOANS_SPCD,
COUNT(MHIS_DEPR_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_DEPR_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_DEPR_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_DEPR_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10025 // 위암 병력불면증여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10025, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_INSM_YN_NOANS_SPCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10025 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 병력불면증여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MHIS_INSM_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_INSM_YN_NOANS_SPCD,
COUNT(MHIS_INSM_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_INSM_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_INSM_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_INSM_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10026 // 위암 병력심장질환여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10026, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_CADS_YN_NOANS_SPCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10026 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 병력심장질환여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MHIS_CADS_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_CADS_YN_NOANS_SPCD,
COUNT(MHIS_CADS_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_CADS_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_CADS_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_CADS_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10027 // 위암 기타병력여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10027, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ETC_MHIS_YN_NOANS_SPCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10027 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 기타병력여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ETC_MHIS_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ETC_MHIS_YN_NOANS_SPCD,
COUNT(ETC_MHIS_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ETC_MHIS_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ETC_MHIS_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'ETC_MHIS_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10028 // 위암 기타병력질환내용별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10028, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, SUBSTRING(A.ETC_MHIS_DISS_CONT,1,100) AS ETC_MHIS_DISS_CONT FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10028 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 기타병력질환내용별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ETC_MHIS_DISS_CONT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ETC_MHIS_DISS_CONT,
COUNT(ETC_MHIS_DISS_CONT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ETC_MHIS_DISS_CONT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ETC_MHIS_DISS_CONT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'ETC_MHIS_DISS_CONT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10029 // 위암 주증상내용별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10029, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, SUBSTRING(A.MAIN_SYM_CONT,1,100) AS MAIN_SYM_CONT FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10029 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 주증상내용별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MAIN_SYM_CONT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MAIN_SYM_CONT,
COUNT(MAIN_SYM_CONT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MAIN_SYM_CONT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MAIN_SYM_CONT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'MAIN_SYM_CONT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10030 // 위암 주증상여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10030, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MAIN_SYM_YN_NOANS_SPCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10030 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 주증상여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MAIN_SYM_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MAIN_SYM_YN_NOANS_SPCD,
COUNT(MAIN_SYM_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MAIN_SYM_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MAIN_SYM_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'MAIN_SYM_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10031 // 위암 타병원진단후전원여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10031, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OHAD_HSTR_YN_NOANS_SPCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10031 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 타병원진단후전원여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OHAD_HSTR_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OHAD_HSTR_YN_NOANS_SPCD,
COUNT(OHAD_HSTR_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OHAD_HSTR_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OHAD_HSTR_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'OHAD_HSTR_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10032 // 위암 퇴원상태별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10032, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DSCH_STCD FROM GSCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10032 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 퇴원상태별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DSCH_STCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DSCH_STCD,
COUNT(DSCH_STCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DSCH_STCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DSCH_STCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_HLINF' AND ENG_COL_NM = 'DSCH_STCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10033 // 위암 가족력여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10033, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.FMHT_YN_NOANS_SPCD FROM GSCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10033 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 가족력여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.FMHT_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHT_YN_NOANS_SPCD,
COUNT(FMHT_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHT_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHT_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_FMHT' AND ENG_COL_NM = 'FMHT_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10034 // 위암 환자가족관계별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10034, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.PT_FM_RLCD FROM GSCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10034 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 환자가족관계별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.PT_FM_RLCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, PT_FM_RLCD,
COUNT(PT_FM_RLCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, PT_FM_RLCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(PT_FM_RLCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_FMHT' AND ENG_COL_NM = 'PT_FM_RLCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10035 // 위암 환자가족관계기타내용별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10035, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, SUBSTRING(A.PT_FMRL_ETC_CONT,1,100) AS PT_FMRL_ETC_CONT FROM GSCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10035 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 환자가족관계기타내용별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.PT_FMRL_ETC_CONT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, PT_FMRL_ETC_CONT,
COUNT(PT_FMRL_ETC_CONT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, PT_FMRL_ETC_CONT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(PT_FMRL_ETC_CONT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_FMHT' AND ENG_COL_NM = 'PT_FMRL_ETC_CONT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10036 // 위암 가족병력고혈압여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10036, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.FMHS_HTN_YN_NOANS_SPCD FROM GSCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10036 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 가족병력고혈압여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.FMHS_HTN_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHS_HTN_YN_NOANS_SPCD,
COUNT(FMHS_HTN_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHS_HTN_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHS_HTN_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_FMHT' AND ENG_COL_NM = 'FMHS_HTN_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10037 // 위암 가족병력당뇨여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10037, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.FMHS_DBT_YN_NOANS_SPCD FROM GSCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10037 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 가족병력당뇨여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.FMHS_DBT_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHS_DBT_YN_NOANS_SPCD,
COUNT(FMHS_DBT_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHS_DBT_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHS_DBT_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_FMHT' AND ENG_COL_NM = 'FMHS_DBT_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10038 // 위암 가족력결핵여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10038, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.FMHT_TB_YN_NOANS_SPCD FROM GSCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10038 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 가족력결핵여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.FMHT_TB_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHT_TB_YN_NOANS_SPCD,
COUNT(FMHT_TB_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHT_TB_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHT_TB_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_FMHT' AND ENG_COL_NM = 'FMHT_TB_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10039 // 위암 가족병력간질환여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10039, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.FMHS_LVDS_YN_NOANS_SPCD FROM GSCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10039 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 가족병력간질환여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.FMHS_LVDS_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHS_LVDS_YN_NOANS_SPCD,
COUNT(FMHS_LVDS_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHS_LVDS_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHS_LVDS_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_FMHT' AND ENG_COL_NM = 'FMHS_LVDS_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10040 // 위암 가족병력암여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10040, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.FMHS_CNCR_YN_NOANS_SPCD FROM GSCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10040 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 가족병력암여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.FMHS_CNCR_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHS_CNCR_YN_NOANS_SPCD,
COUNT(FMHS_CNCR_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHS_CNCR_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHS_CNCR_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_FMHT' AND ENG_COL_NM = 'FMHS_CNCR_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10041 // 위암 가족력암종류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10041, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.FMHT_CNCR_KNCD FROM GSCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10041 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 가족력암종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.FMHT_CNCR_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHT_CNCR_KNCD,
COUNT(FMHT_CNCR_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHT_CNCR_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHT_CNCR_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_FMHT' AND ENG_COL_NM = 'FMHT_CNCR_KNCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10042 // 위암 가족력암종류기타내용별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10042, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, SUBSTRING(A.FMHT_CNCR_KIND_ETC_CONT,1,100) AS FMHT_CNCR_KIND_ETC_CONT FROM GSCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10042 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 가족력암종류기타내용별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.FMHT_CNCR_KIND_ETC_CONT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHT_CNCR_KIND_ETC_CONT,
COUNT(FMHT_CNCR_KIND_ETC_CONT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHT_CNCR_KIND_ETC_CONT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHT_CNCR_KIND_ETC_CONT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_FMHT' AND ENG_COL_NM = 'FMHT_CNCR_KIND_ETC_CONT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10043 // 위암 가족병력기타여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10043, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.FMHS_ETC_YN_NOANS_SPCD FROM GSCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10043 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 가족병력기타여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.FMHS_ETC_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHS_ETC_YN_NOANS_SPCD,
COUNT(FMHS_ETC_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHS_ETC_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHS_ETC_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_FMHT' AND ENG_COL_NM = 'FMHS_ETC_YN_NOANS_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10044 // 위암 가족병력기타내용별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10044, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, SUBSTRING(A.FMHS_ETC_CONT,1,100) AS FMHS_ETC_CONT FROM GSCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10044 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 가족병력기타내용별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.FMHS_ETC_CONT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHS_ETC_CONT,
COUNT(FMHS_ETC_CONT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHS_ETC_CONT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHS_ETC_CONT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_PT_FMHT' AND ENG_COL_NM = 'FMHS_ETC_CONT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10045 // 위암 신장측정별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10045, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTH_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.HT_MSRM_VL FROM GSCN_DIAG_ANINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTH_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10045 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 신장측정별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.HT_MSRM_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, HT_MSRM_VL,
COUNT(HT_MSRM_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, HT_MSRM_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(HT_MSRM_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_ANINF' AND ENG_COL_NM = 'HT_MSRM_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10046 // 위암 체중측정별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10046, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTH_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.WT_MSRM_VL FROM GSCN_DIAG_ANINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTH_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10046 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 체중측정별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.WT_MSRM_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, WT_MSRM_VL,
COUNT(WT_MSRM_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, WT_MSRM_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(WT_MSRM_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_ANINF' AND ENG_COL_NM = 'WT_MSRM_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10047 // 위암 BMI별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10047, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTH_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BMI_VL FROM GSCN_DIAG_ANINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTH_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10047 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 BMI별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.BMI_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BMI_VL,
COUNT(BMI_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BMI_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BMI_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_ANINF' AND ENG_COL_NM = 'BMI_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10048 // 위암 이완혈압별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10048, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTH_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RLXT_BLPR_VL FROM GSCN_DIAG_ANINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTH_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10048 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 이완혈압별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.RLXT_BLPR_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RLXT_BLPR_VL,
COUNT(RLXT_BLPR_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RLXT_BLPR_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RLXT_BLPR_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_ANINF' AND ENG_COL_NM = 'RLXT_BLPR_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10049 // 위암 수축혈압별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10049, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTH_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CTRT_BLPR_VL FROM GSCN_DIAG_ANINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTH_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10049 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수축혈압별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.CTRT_BLPR_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CTRT_BLPR_VL,
COUNT(CTRT_BLPR_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CTRT_BLPR_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CTRT_BLPR_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_ANINF' AND ENG_COL_NM = 'CTRT_BLPR_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10050 // 위암 ECOG코드별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10050, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTH_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ECOG_CD FROM GSCN_DIAG_ANINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTH_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10050 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 ECOG코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ECOG_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ECOG_CD,
COUNT(ECOG_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ECOG_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ECOG_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_ANINF' AND ENG_COL_NM = 'ECOG_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10051 // 위암 위암진단종류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10051, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_RGST_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.GSCN_DIAG_KNCD FROM GSCN_DIAG_INF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_RGST_YMD BETWEEN '20100101' AND '20211231')
SELECT	10051 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 위암진단종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.GSCN_DIAG_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, GSCN_DIAG_KNCD,
COUNT(GSCN_DIAG_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, GSCN_DIAG_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(GSCN_DIAG_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_INF' AND ENG_COL_NM = 'GSCN_DIAG_KNCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10052 // 위암 진단SNOMEDCT코드별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10052, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_RGST_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DIAG_SMCT_CD FROM GSCN_DIAG_INF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_RGST_YMD BETWEEN '20100101' AND '20211231')
SELECT	10052 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 진단SNOMEDCT코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DIAG_SMCT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DIAG_SMCT_CD,
COUNT(DIAG_SMCT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DIAG_SMCT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DIAG_SMCT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_INF' AND ENG_COL_NM = 'DIAG_SMCT_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10053 // 위암 진단SNOMEDCT명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10053, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_RGST_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DIAG_SMCT_NM FROM GSCN_DIAG_INF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_RGST_YMD BETWEEN '20100101' AND '20211231')
SELECT	10053 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 진단SNOMEDCT명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DIAG_SMCT_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DIAG_SMCT_NM,
COUNT(DIAG_SMCT_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DIAG_SMCT_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DIAG_SMCT_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_INF' AND ENG_COL_NM = 'DIAG_SMCT_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10054 // 위암 임상종양특성별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10054, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_STAG_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CLNC_TUMR_PRTY_CD FROM GSCN_DIAG_STAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_STAG_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10054 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 임상종양특성별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.CLNC_TUMR_PRTY_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CLNC_TUMR_PRTY_CD,
COUNT(CLNC_TUMR_PRTY_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CLNC_TUMR_PRTY_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CLNC_TUMR_PRTY_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_STAG' AND ENG_COL_NM = 'CLNC_TUMR_PRTY_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10055 // 위암 AJCC년도별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10055, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_STAG_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AJCC_YR FROM GSCN_DIAG_STAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_STAG_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10055 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 AJCC년도별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.AJCC_YR AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AJCC_YR,
COUNT(AJCC_YR) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AJCC_YR) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AJCC_YR) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_STAG' AND ENG_COL_NM = 'AJCC_YR') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10056 // 위암 임상TNM병기별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10056, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_STAG_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CLNC_TNM_STAG_VL FROM GSCN_DIAG_STAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_STAG_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10056 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 임상TNM병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.CLNC_TNM_STAG_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CLNC_TNM_STAG_VL,
COUNT(CLNC_TNM_STAG_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CLNC_TNM_STAG_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CLNC_TNM_STAG_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_STAG' AND ENG_COL_NM = 'CLNC_TNM_STAG_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10057 // 위암 임상T병기별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10057, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_STAG_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CLNC_T_STAG_VL FROM GSCN_DIAG_STAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_STAG_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10057 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 임상T병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.CLNC_T_STAG_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CLNC_T_STAG_VL,
COUNT(CLNC_T_STAG_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CLNC_T_STAG_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CLNC_T_STAG_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_STAG' AND ENG_COL_NM = 'CLNC_T_STAG_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10058 // 위암 임상N병기별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10058, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_STAG_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CLNC_N_STAG_VL FROM GSCN_DIAG_STAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_STAG_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10058 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 임상N병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.CLNC_N_STAG_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CLNC_N_STAG_VL,
COUNT(CLNC_N_STAG_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CLNC_N_STAG_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CLNC_N_STAG_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_STAG' AND ENG_COL_NM = 'CLNC_N_STAG_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10059 // 위암 임상M병기별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10059, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_STAG_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CLNC_M_STAG_VL FROM GSCN_DIAG_STAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_STAG_RCRD_YMD BETWEEN '20100101' AND '20211231')
SELECT	10059 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 임상M병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.CLNC_M_STAG_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CLNC_M_STAG_VL,
COUNT(CLNC_M_STAG_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CLNC_M_STAG_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CLNC_M_STAG_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_STAG' AND ENG_COL_NM = 'CLNC_M_STAG_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10060 // 위암 전이진단방법별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10060, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.MTDG_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MTDG_MTCD FROM GSCN_DIAG_MTST AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	MTDG_YMD BETWEEN '20100101' AND '20211231')
SELECT	10060 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 전이진단방법별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MTDG_MTCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MTDG_MTCD,
COUNT(MTDG_MTCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MTDG_MTCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MTDG_MTCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_MTST' AND ENG_COL_NM = 'MTDG_MTCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10061 // 위암 전이부위별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10061, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.MTDG_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MTST_SITE_CD FROM GSCN_DIAG_MTST AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	MTDG_YMD BETWEEN '20100101' AND '20211231')
SELECT	10061 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 전이부위별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MTST_SITE_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MTST_SITE_CD,
COUNT(MTST_SITE_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MTST_SITE_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MTST_SITE_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_MTST' AND ENG_COL_NM = 'MTST_SITE_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10062 // 위암 전이양상별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10062, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.MTDG_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MTST_ASPT_CD FROM GSCN_DIAG_MTST AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	MTDG_YMD BETWEEN '20100101' AND '20211231')
SELECT	10062 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 전이양상별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MTST_ASPT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MTST_ASPT_CD,
COUNT(MTST_ASPT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MTST_ASPT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MTST_ASPT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_MTST' AND ENG_COL_NM = 'MTST_ASPT_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10063 // 위암 진단검사종류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10063, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.CEXM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CEXM_KNCD FROM GSCN_EXAM_DIAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	CEXM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10063 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 진단검사종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.CEXM_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CEXM_KNCD,
COUNT(CEXM_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CEXM_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CEXM_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_DIAG' AND ENG_COL_NM = 'CEXM_KNCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10064 // 위암 진단검사EDI코드별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10064, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.CEXM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CEXM_EDI_CD FROM GSCN_EXAM_DIAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	CEXM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10064 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 진단검사EDI코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.CEXM_EDI_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CEXM_EDI_CD,
COUNT(CEXM_EDI_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CEXM_EDI_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CEXM_EDI_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_DIAG' AND ENG_COL_NM = 'CEXM_EDI_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10065 // 위암 진단검사EDI명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10065, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.CEXM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CEXM_EDI_NM FROM GSCN_EXAM_DIAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	CEXM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10065 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 진단검사EDI명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.CEXM_EDI_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CEXM_EDI_NM,
COUNT(CEXM_EDI_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CEXM_EDI_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CEXM_EDI_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_DIAG' AND ENG_COL_NM = 'CEXM_EDI_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10066 // 위암 진단검사SNOMEDCT코드별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10066, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.CEXM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CEXM_SMCT_CD FROM GSCN_EXAM_DIAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	CEXM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10066 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 진단검사SNOMEDCT코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.CEXM_SMCT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CEXM_SMCT_CD,
COUNT(CEXM_SMCT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CEXM_SMCT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CEXM_SMCT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_DIAG' AND ENG_COL_NM = 'CEXM_SMCT_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10067 // 위암 진단검사SNOMEDCT명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10067, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.CEXM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CEXM_SMCT_NM FROM GSCN_EXAM_DIAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	CEXM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10067 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 진단검사SNOMEDCT명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.CEXM_SMCT_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CEXM_SMCT_NM,
COUNT(CEXM_SMCT_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CEXM_SMCT_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CEXM_SMCT_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_DIAG' AND ENG_COL_NM = 'CEXM_SMCT_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10068 // 위암 진단검사LOINC코드별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10068, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.CEXM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CEXM_LOINC_CD FROM GSCN_EXAM_DIAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	CEXM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10068 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 진단검사LOINC코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.CEXM_LOINC_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CEXM_LOINC_CD,
COUNT(CEXM_LOINC_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CEXM_LOINC_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CEXM_LOINC_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_DIAG' AND ENG_COL_NM = 'CEXM_LOINC_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10069 // 위암 진단검사LOINC명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10069, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.CEXM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CEXM_LOINC_NM FROM GSCN_EXAM_DIAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	CEXM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10069 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 진단검사LOINC명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.CEXM_LOINC_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CEXM_LOINC_NM,
COUNT(CEXM_LOINC_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CEXM_LOINC_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CEXM_LOINC_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_DIAG' AND ENG_COL_NM = 'CEXM_LOINC_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10070 // 위암 영상검사종류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10070, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.IMEX_KNCD FROM GSCN_EXAM_IMAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEX_YMD BETWEEN '20100101' AND '20211231')
SELECT	10070 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 영상검사종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.IMEX_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, IMEX_KNCD,
COUNT(IMEX_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, IMEX_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(IMEX_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_IMAG' AND ENG_COL_NM = 'IMEX_KNCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10071 // 위암 영상검사EDI코드별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10071, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.IMEX_EDI_CD FROM GSCN_EXAM_IMAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEX_YMD BETWEEN '20100101' AND '20211231')
SELECT	10071 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 영상검사EDI코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.IMEX_EDI_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, IMEX_EDI_CD,
COUNT(IMEX_EDI_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, IMEX_EDI_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(IMEX_EDI_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_IMAG' AND ENG_COL_NM = 'IMEX_EDI_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10072 // 위암 영상검사EDI명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10072, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.IMEX_EDI_NM FROM GSCN_EXAM_IMAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEX_YMD BETWEEN '20100101' AND '20211231')
SELECT	10072 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 영상검사EDI명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.IMEX_EDI_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, IMEX_EDI_NM,
COUNT(IMEX_EDI_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, IMEX_EDI_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(IMEX_EDI_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_IMAG' AND ENG_COL_NM = 'IMEX_EDI_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10073 // 위암 영상검사SNOMEDCT코드별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10073, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.IMEX_SMCT_CD FROM GSCN_EXAM_IMAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEX_YMD BETWEEN '20100101' AND '20211231')
SELECT	10073 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 영상검사SNOMEDCT코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.IMEX_SMCT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, IMEX_SMCT_CD,
COUNT(IMEX_SMCT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, IMEX_SMCT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(IMEX_SMCT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_IMAG' AND ENG_COL_NM = 'IMEX_SMCT_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10074 // 위암 영상검사SNOMEDCT명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10074, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.IMEX_SMCT_NM FROM GSCN_EXAM_IMAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEX_YMD BETWEEN '20100101' AND '20211231')
SELECT	10074 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 영상검사SNOMEDCT명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.IMEX_SMCT_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, IMEX_SMCT_NM,
COUNT(IMEX_SMCT_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, IMEX_SMCT_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(IMEX_SMCT_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_IMAG' AND ENG_COL_NM = 'IMEX_SMCT_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10075 // 위암 면역병리검사명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10075, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.IMEM_NM FROM GSCN_EXAM_IMPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10075 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 면역병리검사명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.IMEM_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, IMEM_NM,
COUNT(IMEM_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, IMEM_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(IMEM_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_IMPT' AND ENG_COL_NM = 'IMEM_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10076 // 위암 면역병리검사종류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10076, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.IMEM_KNCD FROM GSCN_EXAM_IMPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10076 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 면역병리검사종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.IMEM_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, IMEM_KNCD,
COUNT(IMEM_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, IMEM_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(IMEM_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_IMPT' AND ENG_COL_NM = 'IMEM_KNCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10077 // 위암 면역병리검사소견별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10077, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.IMEM_OPN_CD FROM GSCN_EXAM_IMPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10077 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 면역병리검사소견별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.IMEM_OPN_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, IMEM_OPN_CD,
COUNT(IMEM_OPN_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, IMEM_OPN_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(IMEM_OPN_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_IMPT' AND ENG_COL_NM = 'IMEM_OPN_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10078 // 위암 분자병리검사종류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10078, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.MLEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MLEM_KNCD FROM GSCN_EXAM_MLPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	MLEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10078 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 분자병리검사종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MLEM_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MLEM_KNCD,
COUNT(MLEM_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MLEM_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MLEM_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_MLPT' AND ENG_COL_NM = 'MLEM_KNCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10079 // 위암 분자병리검사소견별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10079, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.MLEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MLEM_OPN_CD FROM GSCN_EXAM_MLPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	MLEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10079 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 분자병리검사소견별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MLEM_OPN_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MLEM_OPN_CD,
COUNT(MLEM_OPN_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MLEM_OPN_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MLEM_OPN_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_MLPT' AND ENG_COL_NM = 'MLEM_OPN_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10080 // 위암 생체검사부위별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10080, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.BPSY_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BPSY_SITE_CD FROM GSCN_EXAM_BYPS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	BPSY_YMD BETWEEN '20100101' AND '20211231')
SELECT	10080 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 생체검사부위별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.BPSY_SITE_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BPSY_SITE_CD,
COUNT(BPSY_SITE_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BPSY_SITE_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BPSY_SITE_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_BYPS' AND ENG_COL_NM = 'BPSY_SITE_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10081 // 위암 생체검사방법종류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10081, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.BPSY_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BPSY_MTHD_KNCD FROM GSCN_EXAM_BYPS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	BPSY_YMD BETWEEN '20100101' AND '20211231')
SELECT	10081 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 생체검사방법종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.BPSY_MTHD_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BPSY_MTHD_KNCD,
COUNT(BPSY_MTHD_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BPSY_MTHD_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BPSY_MTHD_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_BYPS' AND ENG_COL_NM = 'BPSY_MTHD_KNCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10082 // 위암 생체검사결과내용별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10082, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.BPSY_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, SUBSTRING(A.BPSY_RSLT_CONT,1,100) AS BPSY_RSLT_CONT FROM GSCN_EXAM_BYPS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	BPSY_YMD BETWEEN '20100101' AND '20211231')
SELECT	10082 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 생체검사결과내용별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.BPSY_RSLT_CONT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BPSY_RSLT_CONT,
COUNT(BPSY_RSLT_CONT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BPSY_RSLT_CONT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BPSY_RSLT_CONT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_BYPS' AND ENG_COL_NM = 'BPSY_RSLT_CONT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10083 // 위암 조직학적진단별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10083, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.BPSY_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.HTLG_DIAG_CD FROM GSCN_EXAM_BYPS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	BPSY_YMD BETWEEN '20100101' AND '20211231')
SELECT	10083 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 조직학적진단별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.HTLG_DIAG_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, HTLG_DIAG_CD,
COUNT(HTLG_DIAG_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, HTLG_DIAG_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(HTLG_DIAG_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_BYPS' AND ENG_COL_NM = 'HTLG_DIAG_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10084 // 위암 조직학적분화도별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10084, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.BPSY_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.HTLG_DFGD_CD FROM GSCN_EXAM_BYPS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	BPSY_YMD BETWEEN '20100101' AND '20211231')
SELECT	10084 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 조직학적분화도별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.HTLG_DFGD_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, HTLG_DFGD_CD,
COUNT(HTLG_DFGD_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, HTLG_DFGD_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(HTLG_DFGD_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_BYPS' AND ENG_COL_NM = 'HTLG_DFGD_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10085 // 위암 HPYLORI검사방법별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10085, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.HPLI_EXAM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.HPLI_EXAM_MTCD FROM GSCN_EXAM_HPLI AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	HPLI_EXAM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10085 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 HPYLORI검사방법별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.HPLI_EXAM_MTCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, HPLI_EXAM_MTCD,
COUNT(HPLI_EXAM_MTCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, HPLI_EXAM_MTCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(HPLI_EXAM_MTCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_HPLI' AND ENG_COL_NM = 'HPLI_EXAM_MTCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10086 // 위암 HPYLORI검사결과별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10086, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.HPLI_EXAM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.HPLI_EXAM_RSLT_CD FROM GSCN_EXAM_HPLI AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	HPLI_EXAM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10086 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 HPYLORI검사결과별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.HPLI_EXAM_RSLT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, HPLI_EXAM_RSLT_CD,
COUNT(HPLI_EXAM_RSLT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, HPLI_EXAM_RSLT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(HPLI_EXAM_RSLT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_HPLI' AND ENG_COL_NM = 'HPLI_EXAM_RSLT_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10087 // 위암 위내시경검사목적별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10087, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.STMC_EDEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.STMC_EDEX_PRPS_CD FROM GSCN_EXAM_GTSP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	STMC_EDEX_YMD BETWEEN '20100101' AND '20211231')
SELECT	10087 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 위내시경검사목적별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.STMC_EDEX_PRPS_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, STMC_EDEX_PRPS_CD,
COUNT(STMC_EDEX_PRPS_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, STMC_EDEX_PRPS_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(STMC_EDEX_PRPS_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_GTSP' AND ENG_COL_NM = 'STMC_EDEX_PRPS_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10088 // 위암 위내시경조직표본수별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10088, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.STMC_EDEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.GTSP_TSPC_CNT FROM GSCN_EXAM_GTSP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	STMC_EDEX_YMD BETWEEN '20100101' AND '20211231')
SELECT	10088 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 위내시경조직표본수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.GTSP_TSPC_CNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, GTSP_TSPC_CNT,
COUNT(GTSP_TSPC_CNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, GTSP_TSPC_CNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(GTSP_TSPC_CNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_GTSP' AND ENG_COL_NM = 'GTSP_TSPC_CNT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10089 // 위암 위내시경검사결과내용별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10089, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.STMC_EDEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, SUBSTRING(A.STMC_EDEX_RSLT_CONT,1,100) AS STMC_EDEX_RSLT_CONT FROM GSCN_EXAM_GTSP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	STMC_EDEX_YMD BETWEEN '20100101' AND '20211231')
SELECT	10089 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 위내시경검사결과내용별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.STMC_EDEX_RSLT_CONT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, STMC_EDEX_RSLT_CONT,
COUNT(STMC_EDEX_RSLT_CONT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, STMC_EDEX_RSLT_CONT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(STMC_EDEX_RSLT_CONT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_GTSP' AND ENG_COL_NM = 'STMC_EDEX_RSLT_CONT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10090 // 위암 위내시경검사결과유형별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10090, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.STMC_EDEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.STMC_EDEX_RSLT_TPCD FROM GSCN_EXAM_GTSP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	STMC_EDEX_YMD BETWEEN '20100101' AND '20211231')
SELECT	10090 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 위내시경검사결과유형별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.STMC_EDEX_RSLT_TPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, STMC_EDEX_RSLT_TPCD,
COUNT(STMC_EDEX_RSLT_TPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, STMC_EDEX_RSLT_TPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(STMC_EDEX_RSLT_TPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_GTSP' AND ENG_COL_NM = 'STMC_EDEX_RSLT_TPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10091 // 위암 위내시경합병증등급별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10091, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.STMC_EDEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.GTSP_COMP_GRCD FROM GSCN_EXAM_GTSP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	STMC_EDEX_YMD BETWEEN '20100101' AND '20211231')
SELECT	10091 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 위내시경합병증등급별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.GTSP_COMP_GRCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, GTSP_COMP_GRCD,
COUNT(GTSP_COMP_GRCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, GTSP_COMP_GRCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(GTSP_COMP_GRCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_GTSP' AND ENG_COL_NM = 'GTSP_COMP_GRCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10092 // 위암 위내시경합병증별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10092, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.STMC_EDEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.GTSP_COMP_CD FROM GSCN_EXAM_GTSP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	STMC_EDEX_YMD BETWEEN '20100101' AND '20211231')
SELECT	10092 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 위내시경합병증별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.GTSP_COMP_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, GTSP_COMP_CD,
COUNT(GTSP_COMP_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, GTSP_COMP_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(GTSP_COMP_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_GTSP' AND ENG_COL_NM = 'GTSP_COMP_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10093 // 위암 EUS_T병기별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10093, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.EUS_EXAM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.EUS_T_STAG_CD FROM GSCN_EXAM_EUS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	EUS_EXAM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10093 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 EUS_T병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.EUS_T_STAG_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, EUS_T_STAG_CD,
COUNT(EUS_T_STAG_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, EUS_T_STAG_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(EUS_T_STAG_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_EUS' AND ENG_COL_NM = 'EUS_T_STAG_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10094 // 위암 EUS_N병기별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10094, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.EUS_EXAM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.EUS_N_STAG_CD FROM GSCN_EXAM_EUS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	EUS_EXAM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10094 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 EUS_N병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.EUS_N_STAG_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, EUS_N_STAG_CD,
COUNT(EUS_N_STAG_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, EUS_N_STAG_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(EUS_N_STAG_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_EUS' AND ENG_COL_NM = 'EUS_N_STAG_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10095 // 위암 EUS_M병기별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10095, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.EUS_EXAM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.EUS_M_STAG_CD FROM GSCN_EXAM_EUS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	EUS_EXAM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10095 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 EUS_M병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.EUS_M_STAG_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, EUS_M_STAG_CD,
COUNT(EUS_M_STAG_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, EUS_M_STAG_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(EUS_M_STAG_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_EUS' AND ENG_COL_NM = 'EUS_M_STAG_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10096 // 위암 EUS합병증별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10096, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.EUS_EXAM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.EUS_COMP_CD FROM GSCN_EXAM_EUS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	EUS_EXAM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10096 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 EUS합병증별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.EUS_COMP_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, EUS_COMP_CD,
COUNT(EUS_COMP_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, EUS_COMP_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(EUS_COMP_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_EUS' AND ENG_COL_NM = 'EUS_COMP_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10097 // 위암 수술종류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10097, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_KNCD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10097 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRT_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_KNCD,
COUNT(OPRT_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_KNCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10098 // 위암 수술EDI코드별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10098, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_EDI_CD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10098 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술EDI코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRT_EDI_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_EDI_CD,
COUNT(OPRT_EDI_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_EDI_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_EDI_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_EDI_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10099 // 위암 수술EDI명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10099, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_EDI_NM FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10099 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술EDI명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRT_EDI_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_EDI_NM,
COUNT(OPRT_EDI_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_EDI_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_EDI_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_EDI_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10100 // 위암 수술SNOMEDCT코드별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10100, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_SMCT_CD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10100 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술SNOMEDCT코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRT_SMCT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_SMCT_CD,
COUNT(OPRT_SMCT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_SMCT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_SMCT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_SMCT_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10101 // 위암 수술SNOMEDCT명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10101, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_SMCT_NM FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10101 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술SNOMEDCT명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRT_SMCT_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_SMCT_NM,
COUNT(OPRT_SMCT_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_SMCT_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_SMCT_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_SMCT_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10102 // 위암 수술ICD9CM명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10102, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_ICD9CM_NM FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10102 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술ICD9CM명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRT_ICD9CM_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_ICD9CM_NM,
COUNT(OPRT_ICD9CM_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_ICD9CM_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_ICD9CM_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_ICD9CM_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10103 // 위암 수술목적별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10103, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_PRPS_CD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10103 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술목적별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRT_PRPS_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_PRPS_CD,
COUNT(OPRT_PRPS_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_PRPS_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_PRPS_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_PRPS_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10104 // 위암 수술방법별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10104, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_MTCD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10104 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술방법별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRT_MTCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_MTCD,
COUNT(OPRT_MTCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_MTCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_MTCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_MTCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10105 // 위암 수술마취부위별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10105, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_ANST_SITE_CD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10105 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술마취부위별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRT_ANST_SITE_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_ANST_SITE_CD,
COUNT(OPRT_ANST_SITE_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_ANST_SITE_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_ANST_SITE_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_ANST_SITE_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10106 // 위암 ASA점수별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10106, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ASA_SCOR_CD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10106 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 ASA점수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ASA_SCOR_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ASA_SCOR_CD,
COUNT(ASA_SCOR_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ASA_SCOR_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ASA_SCOR_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'ASA_SCOR_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10107 // 위암 수술절개방법별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10107, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_INCS_MTCD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10107 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술절개방법별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRT_INCS_MTCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_INCS_MTCD,
COUNT(OPRT_INCS_MTCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_INCS_MTCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_INCS_MTCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_INCS_MTCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10108 // 위암 수술둘레방향종양위치별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10108, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_CRMR_TUMR_LOCA_CD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10108 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술둘레방향종양위치별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRT_CRMR_TUMR_LOCA_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_CRMR_TUMR_LOCA_CD,
COUNT(OPRT_CRMR_TUMR_LOCA_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_CRMR_TUMR_LOCA_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_CRMR_TUMR_LOCA_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_CRMR_TUMR_LOCA_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10109 // 위암 수술종방향1종양위치별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10109, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_LNGT_1_TUMR_LOCA_CD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10109 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술종방향1종양위치별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRT_LNGT_1_TUMR_LOCA_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_LNGT_1_TUMR_LOCA_CD,
COUNT(OPRT_LNGT_1_TUMR_LOCA_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_LNGT_1_TUMR_LOCA_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_LNGT_1_TUMR_LOCA_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_LNGT_1_TUMR_LOCA_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10110 // 위암 수술종방향2종양위치별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10110, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_LNGT_2_TUMR_LOCA_CD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10110 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술종방향2종양위치별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRT_LNGT_2_TUMR_LOCA_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_LNGT_2_TUMR_LOCA_CD,
COUNT(OPRT_LNGT_2_TUMR_LOCA_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_LNGT_2_TUMR_LOCA_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_LNGT_2_TUMR_LOCA_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_LNGT_2_TUMR_LOCA_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10111 // 위암 진단복강경검사여부확인불가구분별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10111, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DIAG_LPEX_YN_UNID_SPCD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10111 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 진단복강경검사여부확인불가구분별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DIAG_LPEX_YN_UNID_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DIAG_LPEX_YN_UNID_SPCD,
COUNT(DIAG_LPEX_YN_UNID_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DIAG_LPEX_YN_UNID_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DIAG_LPEX_YN_UNID_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'DIAG_LPEX_YN_UNID_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10112 // 위암 수술장내시경사용여부확인불가구분별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10112, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRM_ENSP_USE_YN_UNID_SPCD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10112 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술장내시경사용여부확인불가구분별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRM_ENSP_USE_YN_UNID_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRM_ENSP_USE_YN_UNID_SPCD,
COUNT(OPRM_ENSP_USE_YN_UNID_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRM_ENSP_USE_YN_UNID_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRM_ENSP_USE_YN_UNID_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRM_ENSP_USE_YN_UNID_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10113 // 위암 형광영상사용여부확인불가구분별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10113, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.FLRN_IMAG_USE_YN_UNID_SPCD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10113 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 형광영상사용여부확인불가구분별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.FLRN_IMAG_USE_YN_UNID_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FLRN_IMAG_USE_YN_UNID_SPCD,
COUNT(FLRN_IMAG_USE_YN_UNID_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FLRN_IMAG_USE_YN_UNID_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FLRN_IMAG_USE_YN_UNID_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'FLRN_IMAG_USE_YN_UNID_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10114 // 위암 수술시항암요법별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10114, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.INOP_ANTP_CD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10114 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술시항암요법별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.INOP_ANTP_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, INOP_ANTP_CD,
COUNT(INOP_ANTP_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, INOP_ANTP_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(INOP_ANTP_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'INOP_ANTP_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10115 // 위암 유착방지제사용여부확인불가구분별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10115, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ADH_IBTR_USE_YN_UNID_SPCD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10115 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 유착방지제사용여부확인불가구분별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ADH_IBTR_USE_YN_UNID_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ADH_IBTR_USE_YN_UNID_SPCD,
COUNT(ADH_IBTR_USE_YN_UNID_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ADH_IBTR_USE_YN_UNID_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ADH_IBTR_USE_YN_UNID_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'ADH_IBTR_USE_YN_UNID_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10116 // 위암 유착방지제제품명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10116, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ADH_IBTR_GODS_NM FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10116 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 유착방지제제품명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ADH_IBTR_GODS_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ADH_IBTR_GODS_NM,
COUNT(ADH_IBTR_GODS_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ADH_IBTR_GODS_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ADH_IBTR_GODS_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'ADH_IBTR_GODS_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10117 // 위암 그물막절제범위별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10117, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OMNL_SRMV_RANG_CD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10117 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 그물막절제범위별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OMNL_SRMV_RANG_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OMNL_SRMV_RANG_CD,
COUNT(OMNL_SRMV_RANG_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OMNL_SRMV_RANG_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OMNL_SRMV_RANG_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'OMNL_SRMV_RANG_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10118 // 위암 근치도별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10118, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CURDG_CD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10118 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 근치도별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.CURDG_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CURDG_CD,
COUNT(CURDG_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CURDG_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CURDG_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'CURDG_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10119 // 위암 림프절절제정도별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10119, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.LN_SRMV_DGRE_CD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10119 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 림프절절제정도별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.LN_SRMV_DGRE_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, LN_SRMV_DGRE_CD,
COUNT(LN_SRMV_DGRE_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, LN_SRMV_DGRE_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(LN_SRMV_DGRE_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'LN_SRMV_DGRE_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10120 // 위암 림프절절제정도상세내용별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10120, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, SUBSTRING(A.LN_SRMV_DGRE_DETL_CONT,1,100) AS LN_SRMV_DGRE_DETL_CONT FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10120 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 림프절절제정도상세내용별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.LN_SRMV_DGRE_DETL_CONT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, LN_SRMV_DGRE_DETL_CONT,
COUNT(LN_SRMV_DGRE_DETL_CONT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, LN_SRMV_DGRE_DETL_CONT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(LN_SRMV_DGRE_DETL_CONT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'LN_SRMV_DGRE_DETL_CONT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10121 // 위암 합병절제부위별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10121, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MRGE_SRMV_SITE_CD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10121 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 합병절제부위별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.MRGE_SRMV_SITE_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MRGE_SRMV_SITE_CD,
COUNT(MRGE_SRMV_SITE_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MRGE_SRMV_SITE_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MRGE_SRMV_SITE_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'MRGE_SRMV_SITE_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10122 // 위암 재건술종류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10122, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.REPR_KNCD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10122 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 재건술종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.REPR_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, REPR_KNCD,
COUNT(REPR_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, REPR_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(REPR_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'REPR_KNCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10123 // 위암 재건술사용도구명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10123, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.REPR_USE_DVCE_NM FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10123 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 재건술사용도구명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.REPR_USE_DVCE_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, REPR_USE_DVCE_NM,
COUNT(REPR_USE_DVCE_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, REPR_USE_DVCE_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(REPR_USE_DVCE_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'REPR_USE_DVCE_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10124 // 위암 재건술방법별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10124, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.REPR_MTCD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10124 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 재건술방법별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.REPR_MTCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, REPR_MTCD,
COUNT(REPR_MTCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, REPR_MTCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(REPR_MTCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'REPR_MTCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10125 // 위암 재건술접근법별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10125, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.REPR_APRMTHD_CD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10125 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 재건술접근법별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.REPR_APRMTHD_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, REPR_APRMTHD_CD,
COUNT(REPR_APRMTHD_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, REPR_APRMTHD_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(REPR_APRMTHD_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'REPR_APRMTHD_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10126 // 위암 수술추정실혈량별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10126, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_EBL_QTY FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10126 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술추정실혈량별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRT_EBL_QTY AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_EBL_QTY,
COUNT(OPRT_EBL_QTY) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_EBL_QTY) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_EBL_QTY) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_EBL_QTY') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10127 // 위암 복수여부확인불가구분별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10127, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ASCT_YN_UNID_SPCD FROM GSCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10127 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 복수여부확인불가구분별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ASCT_YN_UNID_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ASCT_YN_UNID_SPCD,
COUNT(ASCT_YN_UNID_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ASCT_YN_UNID_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ASCT_YN_UNID_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_OPRT' AND ENG_COL_NM = 'ASCT_YN_UNID_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10128 // 위암 ESD병변크기별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10128, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ESD_SRPR_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ESD_LESN_SIZE_VL FROM GSCN_TRTM_SRPR AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ESD_SRPR_YMD BETWEEN '20100101' AND '20211231')
SELECT	10128 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 ESD병변크기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ESD_LESN_SIZE_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ESD_LESN_SIZE_VL,
COUNT(ESD_LESN_SIZE_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ESD_LESN_SIZE_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ESD_LESN_SIZE_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_SRPR' AND ENG_COL_NM = 'ESD_LESN_SIZE_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10129 // 위암 ESD병변모양별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10129, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ESD_SRPR_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ESD_LESN_SHAP_CD FROM GSCN_TRTM_SRPR AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ESD_SRPR_YMD BETWEEN '20100101' AND '20211231')
SELECT	10129 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 ESD병변모양별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ESD_LESN_SHAP_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ESD_LESN_SHAP_CD,
COUNT(ESD_LESN_SHAP_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ESD_LESN_SHAP_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ESD_LESN_SHAP_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_SRPR' AND ENG_COL_NM = 'ESD_LESN_SHAP_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10130 // 위암 ESD병변가로위치별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10130, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ESD_SRPR_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ESD_LESN_LOCA_WDTH_CD FROM GSCN_TRTM_SRPR AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ESD_SRPR_YMD BETWEEN '20100101' AND '20211231')
SELECT	10130 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 ESD병변가로위치별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ESD_LESN_LOCA_WDTH_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ESD_LESN_LOCA_WDTH_CD,
COUNT(ESD_LESN_LOCA_WDTH_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ESD_LESN_LOCA_WDTH_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ESD_LESN_LOCA_WDTH_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_SRPR' AND ENG_COL_NM = 'ESD_LESN_LOCA_WDTH_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10131 // 위암 ESD병변세로위치별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10131, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ESD_SRPR_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ESD_LESN_LOCA_LGTD_CD FROM GSCN_TRTM_SRPR AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ESD_SRPR_YMD BETWEEN '20100101' AND '20211231')
SELECT	10131 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 ESD병변세로위치별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ESD_LESN_LOCA_LGTD_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ESD_LESN_LOCA_LGTD_CD,
COUNT(ESD_LESN_LOCA_LGTD_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ESD_LESN_LOCA_LGTD_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ESD_LESN_LOCA_LGTD_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_SRPR' AND ENG_COL_NM = 'ESD_LESN_LOCA_LGTD_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10132 // 위암 ESD궤양여부확인불가구분별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10132, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ESD_SRPR_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ESD_ULCR_YN_UNID_SPCD FROM GSCN_TRTM_SRPR AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ESD_SRPR_YMD BETWEEN '20100101' AND '20211231')
SELECT	10132 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 ESD궤양여부확인불가구분별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ESD_ULCR_YN_UNID_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ESD_ULCR_YN_UNID_SPCD,
COUNT(ESD_ULCR_YN_UNID_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ESD_ULCR_YN_UNID_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ESD_ULCR_YN_UNID_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_SRPR' AND ENG_COL_NM = 'ESD_ULCR_YN_UNID_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10133 // 위암 ESD천공여부확인불가구분별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10133, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ESD_SRPR_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ESD_PERF_YN_UNID_SPCD FROM GSCN_TRTM_SRPR AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ESD_SRPR_YMD BETWEEN '20100101' AND '20211231')
SELECT	10133 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 ESD천공여부확인불가구분별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ESD_PERF_YN_UNID_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ESD_PERF_YN_UNID_SPCD,
COUNT(ESD_PERF_YN_UNID_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ESD_PERF_YN_UNID_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ESD_PERF_YN_UNID_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_SRPR' AND ENG_COL_NM = 'ESD_PERF_YN_UNID_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10134 // 위암 ESD천공조치별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10134, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ESD_SRPR_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ESD_PERF_MSRE_CD FROM GSCN_TRTM_SRPR AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ESD_SRPR_YMD BETWEEN '20100101' AND '20211231')
SELECT	10134 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 ESD천공조치별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ESD_PERF_MSRE_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ESD_PERF_MSRE_CD,
COUNT(ESD_PERF_MSRE_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ESD_PERF_MSRE_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ESD_PERF_MSRE_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_SRPR' AND ENG_COL_NM = 'ESD_PERF_MSRE_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10135 // 위암 ESD결과별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10135, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ESD_SRPR_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ESD_RSLT_CD FROM GSCN_TRTM_SRPR AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ESD_SRPR_YMD BETWEEN '20100101' AND '20211231')
SELECT	10135 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 ESD결과별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ESD_RSLT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ESD_RSLT_CD,
COUNT(ESD_RSLT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ESD_RSLT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ESD_RSLT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_SRPR' AND ENG_COL_NM = 'ESD_RSLT_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10136 // 위암 ESD소견내용별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10136, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ESD_SRPR_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, SUBSTRING(A.ESD_OPN_CONT,1,100) AS ESD_OPN_CONT FROM GSCN_TRTM_SRPR AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ESD_SRPR_YMD BETWEEN '20100101' AND '20211231')
SELECT	10136 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 ESD소견내용별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ESD_OPN_CONT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ESD_OPN_CONT,
COUNT(ESD_OPN_CONT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ESD_OPN_CONT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ESD_OPN_CONT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_SRPR' AND ENG_COL_NM = 'ESD_OPN_CONT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10137 // 위암 외과병리채취부위별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10137, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.SGPT_HVST_SITE_CD FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10137 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 외과병리채취부위별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.SGPT_HVST_SITE_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, SGPT_HVST_SITE_CD,
COUNT(SGPT_HVST_SITE_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, SGPT_HVST_SITE_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(SGPT_HVST_SITE_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'SGPT_HVST_SITE_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10138 // 위암 외과병리검사결과종양수별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10138, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.SRGC_PTEM_RSLT_TUMR_CNT FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10138 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 외과병리검사결과종양수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.SRGC_PTEM_RSLT_TUMR_CNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, SRGC_PTEM_RSLT_TUMR_CNT,
COUNT(SRGC_PTEM_RSLT_TUMR_CNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, SRGC_PTEM_RSLT_TUMR_CNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(SRGC_PTEM_RSLT_TUMR_CNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'SRGC_PTEM_RSLT_TUMR_CNT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10139 // 위암 조직학적진단별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10139, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.HTLG_DIAG_CD FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10139 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 조직학적진단별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.HTLG_DIAG_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, HTLG_DIAG_CD,
COUNT(HTLG_DIAG_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, HTLG_DIAG_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(HTLG_DIAG_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'HTLG_DIAG_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10140 // 위암 조직학적분화도별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10140, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.HTLG_DFGD_CD FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10140 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 조직학적분화도별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.HTLG_DFGD_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, HTLG_DFGD_CD,
COUNT(HTLG_DFGD_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, HTLG_DFGD_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(HTLG_DFGD_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'HTLG_DFGD_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10141 // 위암 수술후둘레방향종양위치별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10141, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AFOP_CRMR_TUMR_LOCA_CD FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10141 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술후둘레방향종양위치별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.AFOP_CRMR_TUMR_LOCA_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AFOP_CRMR_TUMR_LOCA_CD,
COUNT(AFOP_CRMR_TUMR_LOCA_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AFOP_CRMR_TUMR_LOCA_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AFOP_CRMR_TUMR_LOCA_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'AFOP_CRMR_TUMR_LOCA_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10142 // 위암 수술후종방향1종양위치별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10142, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AFOP_LNGT_1_TUMR_LOCA_CD FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10142 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술후종방향1종양위치별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.AFOP_LNGT_1_TUMR_LOCA_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AFOP_LNGT_1_TUMR_LOCA_CD,
COUNT(AFOP_LNGT_1_TUMR_LOCA_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AFOP_LNGT_1_TUMR_LOCA_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AFOP_LNGT_1_TUMR_LOCA_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'AFOP_LNGT_1_TUMR_LOCA_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10143 // 위암 수술후종방향2종양위치별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10143, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AFOP_LNGT_2_TUMR_LOCA_CD FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10143 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술후종방향2종양위치별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.AFOP_LNGT_2_TUMR_LOCA_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AFOP_LNGT_2_TUMR_LOCA_CD,
COUNT(AFOP_LNGT_2_TUMR_LOCA_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AFOP_LNGT_2_TUMR_LOCA_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AFOP_LNGT_2_TUMR_LOCA_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'AFOP_LNGT_2_TUMR_LOCA_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10144 // 위암 GROSS유형별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10144, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.GROS_TPCD FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10144 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 GROSS유형별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.GROS_TPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, GROS_TPCD,
COUNT(GROS_TPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, GROS_TPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(GROS_TPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'GROS_TPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10145 // 위암 종양가로길이별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10145, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.TUMR_WDTH_LNTH_VL FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10145 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 종양가로길이별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.TUMR_WDTH_LNTH_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, TUMR_WDTH_LNTH_VL,
COUNT(TUMR_WDTH_LNTH_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, TUMR_WDTH_LNTH_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(TUMR_WDTH_LNTH_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'TUMR_WDTH_LNTH_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10146 // 위암 종양세로길이별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10146, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.TUMR_LGTD_LNTH_VL FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10146 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 종양세로길이별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.TUMR_LGTD_LNTH_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, TUMR_LGTD_LNTH_VL,
COUNT(TUMR_LGTD_LNTH_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, TUMR_LGTD_LNTH_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(TUMR_LGTD_LNTH_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'TUMR_LGTD_LNTH_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10147 // 위암 종양높이별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10147, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.TUMR_HGHT_VL FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10147 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 종양높이별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.TUMR_HGHT_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, TUMR_HGHT_VL,
COUNT(TUMR_HGHT_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, TUMR_HGHT_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(TUMR_HGHT_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'TUMR_HGHT_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10148 // 위암 종양최대직경별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10148, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.TUMR_MAX_DIAM_VL FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10148 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 종양최대직경별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.TUMR_MAX_DIAM_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, TUMR_MAX_DIAM_VL,
COUNT(TUMR_MAX_DIAM_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, TUMR_MAX_DIAM_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(TUMR_MAX_DIAM_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'TUMR_MAX_DIAM_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10149 // 위암 침습장기별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10149, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.IFLT_ORGN_CD FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10149 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 침습장기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.IFLT_ORGN_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, IFLT_ORGN_CD,
COUNT(IFLT_ORGN_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, IFLT_ORGN_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(IFLT_ORGN_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'IFLT_ORGN_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10150 // 위암 침윤정도별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10150, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.INVA_DGRE_CD FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10150 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 침윤정도별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.INVA_DGRE_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, INVA_DGRE_CD,
COUNT(INVA_DGRE_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, INVA_DGRE_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(INVA_DGRE_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'INVA_DGRE_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10151 // 위암 침윤깊이별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10151, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.INVA_DPTH_VL FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10151 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 침윤깊이별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.INVA_DPTH_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, INVA_DPTH_VL,
COUNT(INVA_DPTH_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, INVA_DPTH_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(INVA_DPTH_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'INVA_DPTH_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10152 // 위암 림프성침윤존재여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10152, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.LYMP_INVA_EX_YN_SPCD FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10152 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 림프성침윤존재여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.LYMP_INVA_EX_YN_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, LYMP_INVA_EX_YN_SPCD,
COUNT(LYMP_INVA_EX_YN_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, LYMP_INVA_EX_YN_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(LYMP_INVA_EX_YN_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'LYMP_INVA_EX_YN_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10153 // 위암 혈관성침윤존재여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10153, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.VASC_INVA_EX_YN_SPCD FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10153 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 혈관성침윤존재여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.VASC_INVA_EX_YN_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, VASC_INVA_EX_YN_SPCD,
COUNT(VASC_INVA_EX_YN_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, VASC_INVA_EX_YN_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(VASC_INVA_EX_YN_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'VASC_INVA_EX_YN_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10154 // 위암 신경주위침윤존재여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10154, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.NERV_PREX_EX_YN_SPCD FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10154 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 신경주위침윤존재여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.NERV_PREX_EX_YN_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, NERV_PREX_EX_YN_SPCD,
COUNT(NERV_PREX_EX_YN_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, NERV_PREX_EX_YN_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(NERV_PREX_EX_YN_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'NERV_PREX_EX_YN_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10155 // 위암 수술근위절제면잔존암포함여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10155, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_PMRG_RLCR_INVL_YN_SPCD FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10155 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술근위절제면잔존암포함여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRT_PMRG_RLCR_INVL_YN_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_PMRG_RLCR_INVL_YN_SPCD,
COUNT(OPRT_PMRG_RLCR_INVL_YN_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_PMRG_RLCR_INVL_YN_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_PMRG_RLCR_INVL_YN_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'OPRT_PMRG_RLCR_INVL_YN_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10156 // 위암 수술근위절제면크기별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10156, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_PMRG_SIZE_VL FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10156 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술근위절제면크기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRT_PMRG_SIZE_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_PMRG_SIZE_VL,
COUNT(OPRT_PMRG_SIZE_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_PMRG_SIZE_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_PMRG_SIZE_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'OPRT_PMRG_SIZE_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10157 // 위암 수술원위절제면잔존암포함여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10157, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_DMRG_RLCR_INVL_YN_SPCD FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10157 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술원위절제면잔존암포함여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRT_DMRG_RLCR_INVL_YN_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_DMRG_RLCR_INVL_YN_SPCD,
COUNT(OPRT_DMRG_RLCR_INVL_YN_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_DMRG_RLCR_INVL_YN_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_DMRG_RLCR_INVL_YN_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'OPRT_DMRG_RLCR_INVL_YN_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10158 // 위암 수술원위절제면크기별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10158, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_DMRG_SIZE_VL FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10158 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술원위절제면크기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.OPRT_DMRG_SIZE_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_DMRG_SIZE_VL,
COUNT(OPRT_DMRG_SIZE_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_DMRG_SIZE_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_DMRG_SIZE_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'OPRT_DMRG_SIZE_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10159 // 위암 위식도경계부위암분류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10159, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.STES_BNST_CNCR_CLCD FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10159 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 위식도경계부위암분류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.STES_BNST_CNCR_CLCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, STES_BNST_CNCR_CLCD,
COUNT(STES_BNST_CNCR_CLCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, STES_BNST_CNCR_CLCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(STES_BNST_CNCR_CLCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'STES_BNST_CNCR_CLCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10160 // 위암 총림프절수별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10160, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.TOTL_LN_CNT FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10160 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 총림프절수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.TOTL_LN_CNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, TOTL_LN_CNT,
COUNT(TOTL_LN_CNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, TOTL_LN_CNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(TOTL_LN_CNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'TOTL_LN_CNT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10161 // 위암 양성림프절수별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10161, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.PSTV_LN_CNT FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10161 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 양성림프절수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.PSTV_LN_CNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, PSTV_LN_CNT,
COUNT(PSTV_LN_CNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, PSTV_LN_CNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(PSTV_LN_CNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'PSTV_LN_CNT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10162 // 위암 림프절위치별전이내용별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10162, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, SUBSTRING(A.LN_BYLC_MTST_CONT,1,100) AS LN_BYLC_MTST_CONT FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10162 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 림프절위치별전이내용별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.LN_BYLC_MTST_CONT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, LN_BYLC_MTST_CONT,
COUNT(LN_BYLC_MTST_CONT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, LN_BYLC_MTST_CONT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(LN_BYLC_MTST_CONT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'LN_BYLC_MTST_CONT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10163 // 위암 수술후병리TNM병기별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10163, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AFOP_PATH_TNM_STAG_VL FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10163 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술후병리TNM병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.AFOP_PATH_TNM_STAG_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AFOP_PATH_TNM_STAG_VL,
COUNT(AFOP_PATH_TNM_STAG_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AFOP_PATH_TNM_STAG_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AFOP_PATH_TNM_STAG_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'AFOP_PATH_TNM_STAG_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10164 // 위암 수술후병리T병기별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10164, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AFOP_PATH_T_STAG_VL FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10164 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술후병리T병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.AFOP_PATH_T_STAG_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AFOP_PATH_T_STAG_VL,
COUNT(AFOP_PATH_T_STAG_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AFOP_PATH_T_STAG_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AFOP_PATH_T_STAG_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'AFOP_PATH_T_STAG_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10165 // 위암 수술후병리N병기별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10165, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AFOP_PATH_N_STAG_VL FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10165 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술후병리N병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.AFOP_PATH_N_STAG_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AFOP_PATH_N_STAG_VL,
COUNT(AFOP_PATH_N_STAG_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AFOP_PATH_N_STAG_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AFOP_PATH_N_STAG_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'AFOP_PATH_N_STAG_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10166 // 위암 수술후병리M병기별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10166, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AFOP_PATH_M_STAG_VL FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10166 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술후병리M병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.AFOP_PATH_M_STAG_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AFOP_PATH_M_STAG_VL,
COUNT(AFOP_PATH_M_STAG_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AFOP_PATH_M_STAG_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AFOP_PATH_M_STAG_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'AFOP_PATH_M_STAG_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10167 // 위암 ESD수직절제면잔존암양성여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10167, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ESD_VMRG_RLCR_PSTV_YN_SPCD FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10167 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 ESD수직절제면잔존암양성여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ESD_VMRG_RLCR_PSTV_YN_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ESD_VMRG_RLCR_PSTV_YN_SPCD,
COUNT(ESD_VMRG_RLCR_PSTV_YN_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ESD_VMRG_RLCR_PSTV_YN_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ESD_VMRG_RLCR_PSTV_YN_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'ESD_VMRG_RLCR_PSTV_YN_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10168 // 위암 ESD수직절제면별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10168, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ESD_VMRG_VL FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10168 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 ESD수직절제면별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ESD_VMRG_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ESD_VMRG_VL,
COUNT(ESD_VMRG_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ESD_VMRG_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ESD_VMRG_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'ESD_VMRG_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10169 // 위암 ESD수평절제면잔존암양성여부별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10169, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ESD_HMRG_RLCR_PSTV_YN_SPCD FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10169 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 ESD수평절제면잔존암양성여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ESD_HMRG_RLCR_PSTV_YN_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ESD_HMRG_RLCR_PSTV_YN_SPCD,
COUNT(ESD_HMRG_RLCR_PSTV_YN_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ESD_HMRG_RLCR_PSTV_YN_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ESD_HMRG_RLCR_PSTV_YN_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'ESD_HMRG_RLCR_PSTV_YN_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10170 // 위암 ESD수평절제면별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10170, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ESD_HMRG_VL FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10170 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 ESD수평절제면별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ESD_HMRG_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ESD_HMRG_VL,
COUNT(ESD_HMRG_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ESD_HMRG_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ESD_HMRG_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'ESD_HMRG_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10171 // 위암 ESD수평절제면잔존암길이별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10171, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ESD_HMRG_RLCR_LNTH_VL FROM GSCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231')
SELECT	10171 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 ESD수평절제면잔존암길이별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ESD_HMRG_RLCR_LNTH_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ESD_HMRG_RLCR_LNTH_VL,
COUNT(ESD_HMRG_RLCR_LNTH_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ESD_HMRG_RLCR_LNTH_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ESD_HMRG_RLCR_LNTH_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_EXAM_SGPT' AND ENG_COL_NM = 'ESD_HMRG_RLCR_LNTH_VL') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10172 // 위암 수술후합병증분류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10172, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.COMP_OCRN_OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AFOC_CLCD FROM GSCN_DIAG_AFOC AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	COMP_OCRN_OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10172 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술후합병증분류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.AFOC_CLCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AFOC_CLCD,
COUNT(AFOC_CLCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AFOC_CLCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AFOC_CLCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_AFOC' AND ENG_COL_NM = 'AFOC_CLCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10173 // 위암 수술후합병증별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10173, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.COMP_OCRN_OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AFOC_CD FROM GSCN_DIAG_AFOC AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	COMP_OCRN_OPRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10173 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수술후합병증별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.AFOC_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AFOC_CD,
COUNT(AFOC_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AFOC_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AFOC_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_DIAG_AFOC' AND ENG_COL_NM = 'AFOC_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10174 // 위암 혈액제제종류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10174, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.BLTR_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BLPT_KNCD FROM GSCN_TRTM_BLTR AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	BLTR_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10174 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 혈액제제종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.BLPT_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BLPT_KNCD,
COUNT(BLPT_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BLPT_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BLPT_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_BLTR' AND ENG_COL_NM = 'BLPT_KNCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10175 // 위암 수혈팩수별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10175, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.BLTR_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BLTR_PACK_CNT FROM GSCN_TRTM_BLTR AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	BLTR_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10175 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수혈팩수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.BLTR_PACK_CNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BLTR_PACK_CNT,
COUNT(BLTR_PACK_CNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BLTR_PACK_CNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BLTR_PACK_CNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_BLTR' AND ENG_COL_NM = 'BLTR_PACK_CNT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10176 // 위암 수혈총량별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10176, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.BLTR_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BLTR_TOTL_QTY FROM GSCN_TRTM_BLTR AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	BLTR_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10176 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 수혈총량별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.BLTR_TOTL_QTY AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BLTR_TOTL_QTY,
COUNT(BLTR_TOTL_QTY) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BLTR_TOTL_QTY) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BLTR_TOTL_QTY) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_BLTR' AND ENG_COL_NM = 'BLTR_TOTL_QTY') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10177 // 위암 약제분류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10177, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_CLCD FROM GSCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10177 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 약제분류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRUG_CLCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_CLCD,
COUNT(DRUG_CLCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_CLCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_CLCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_CLCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10178 // 위암 약제구분별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10178, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_SPCD FROM GSCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10178 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 약제구분별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRUG_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_SPCD,
COUNT(DRUG_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10179 // 위암 약제성분종류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10179, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRIN_KNCD FROM GSCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10179 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 약제성분종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRIN_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRIN_KNCD,
COUNT(DRIN_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRIN_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRIN_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_DRIN' AND ENG_COL_NM = 'DRIN_KNCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10180 // 위암 약제성분별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10180, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRIN_CD FROM GSCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10180 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 약제성분별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRIN_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRIN_CD,
COUNT(DRIN_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRIN_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRIN_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_DRIN' AND ENG_COL_NM = 'DRIN_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10181 // 위암 약제성분명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10181, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRIN_NM FROM GSCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10181 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 약제성분명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRIN_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRIN_NM,
COUNT(DRIN_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRIN_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRIN_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_DRIN' AND ENG_COL_NM = 'DRIN_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10182 // 위암 약제성분SNOMEDCT코드별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10182, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRIN_SMCT_CD FROM GSCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10182 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 약제성분SNOMEDCT코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRIN_SMCT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRIN_SMCT_CD,
COUNT(DRIN_SMCT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRIN_SMCT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRIN_SMCT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_DRIN' AND ENG_COL_NM = 'DRIN_SMCT_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10183 // 위암 약제성분SNOMEDCT명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10183, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRIN_SMCT_NM FROM GSCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10183 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 약제성분SNOMEDCT명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRIN_SMCT_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRIN_SMCT_NM,
COUNT(DRIN_SMCT_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRIN_SMCT_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRIN_SMCT_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_DRIN' AND ENG_COL_NM = 'DRIN_SMCT_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10184 // 위암 약제EDI코드별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10184, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_EDI_CD FROM GSCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10184 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 약제EDI코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRUG_EDI_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_EDI_CD,
COUNT(DRUG_EDI_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_EDI_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_EDI_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_EDI_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10185 // 위암 약제EDI명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10185, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_EDI_NM FROM GSCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10185 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 약제EDI명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRUG_EDI_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_EDI_NM,
COUNT(DRUG_EDI_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_EDI_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_EDI_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_EDI_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10186 // 위암 약제ATC코드별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10186, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_ATC_CD FROM GSCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10186 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 약제ATC코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRUG_ATC_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_ATC_CD,
COUNT(DRUG_ATC_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_ATC_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_ATC_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_ATC_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10187 // 위암 약제ATC명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10187, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_ATC_NM FROM GSCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10187 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 약제ATC명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRUG_ATC_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_ATC_NM,
COUNT(DRUG_ATC_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_ATC_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_ATC_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_ATC_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10188 // 위암 약제RXNORM코드별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10188, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_RXNM_CD FROM GSCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10188 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 약제RXNORM코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRUG_RXNM_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_RXNM_CD,
COUNT(DRUG_RXNM_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_RXNM_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_RXNM_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_RXNM_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10189 // 위암 약제RXNORM명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10189, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_RXNM_NM FROM GSCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10189 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 약제RXNORM명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRUG_RXNM_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_RXNM_NM,
COUNT(DRUG_RXNM_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_RXNM_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_RXNM_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_RXNM_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10190 // 위암 약제처방용량별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10190, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_PRSC_CAPA FROM GSCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10190 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 약제처방용량별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRUG_PRSC_CAPA AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_PRSC_CAPA,
COUNT(DRUG_PRSC_CAPA) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_PRSC_CAPA) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_PRSC_CAPA) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_PRSC_CAPA') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10191 // 위암 약제투여경로별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10191, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_INJC_PTH_CD FROM GSCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10191 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 약제투여경로별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRUG_INJC_PTH_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_INJC_PTH_CD,
COUNT(DRUG_INJC_PTH_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_INJC_PTH_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_INJC_PTH_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_INJC_PTH_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10192 // 위암 약제처방용량단위별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10192, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_PRSC_CAPA_UNIT_CD FROM GSCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10192 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 약제처방용량단위별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRUG_PRSC_CAPA_UNIT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_PRSC_CAPA_UNIT_CD,
COUNT(DRUG_PRSC_CAPA_UNIT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_PRSC_CAPA_UNIT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_PRSC_CAPA_UNIT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_PRSC_CAPA_UNIT_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10193 // 위암 약제투약기간월수별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10193, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_MDCT_DTRN_MCNT FROM GSCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10193 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 약제투약기간월수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.DRUG_MDCT_DTRN_MCNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_MDCT_DTRN_MCNT,
COUNT(DRUG_MDCT_DTRN_MCNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_MDCT_DTRN_MCNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_MDCT_DTRN_MCNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_MDCT_DTRN_MCNT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10194 // 위암 항암요법라인수별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10194, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTP_STRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ANTP_LINE_CNT FROM GSCN_TRTM_ANTP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTP_STRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10194 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 항암요법라인수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ANTP_LINE_CNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ANTP_LINE_CNT,
COUNT(ANTP_LINE_CNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ANTP_LINE_CNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ANTP_LINE_CNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_ANTP' AND ENG_COL_NM = 'ANTP_LINE_CNT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10195 // 위암 항암요법총주기수별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10195, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTP_STRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ANTP_TOTL_CYCL_CNT FROM GSCN_TRTM_ANTP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTP_STRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10195 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 항암요법총주기수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ANTP_TOTL_CYCL_CNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ANTP_TOTL_CYCL_CNT,
COUNT(ANTP_TOTL_CYCL_CNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ANTP_TOTL_CYCL_CNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ANTP_TOTL_CYCL_CNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_ANTP' AND ENG_COL_NM = 'ANTP_TOTL_CYCL_CNT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10196 // 위암 항암요법치료목적별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10196, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTP_STRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ANTP_TRTM_PRPS_CD FROM GSCN_TRTM_ANTP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTP_STRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10196 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 항암요법치료목적별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ANTP_TRTM_PRPS_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ANTP_TRTM_PRPS_CD,
COUNT(ANTP_TRTM_PRPS_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ANTP_TRTM_PRPS_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ANTP_TRTM_PRPS_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_ANTP' AND ENG_COL_NM = 'ANTP_TRTM_PRPS_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10197 // 위암 항암요법임시중단여부확인불가구분별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10197, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTP_STRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ANTP_TEMP_STOP_YN_UNID_SPCD FROM GSCN_TRTM_ANTP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTP_STRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10197 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 항암요법임시중단여부확인불가구분별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ANTP_TEMP_STOP_YN_UNID_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ANTP_TEMP_STOP_YN_UNID_SPCD,
COUNT(ANTP_TEMP_STOP_YN_UNID_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ANTP_TEMP_STOP_YN_UNID_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ANTP_TEMP_STOP_YN_UNID_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_ANTP' AND ENG_COL_NM = 'ANTP_TEMP_STOP_YN_UNID_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10198 // 위암 항암요법종료이유별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10198, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTP_STRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ANTP_END_RESN_CD FROM GSCN_TRTM_ANTP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTP_STRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10198 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 항암요법종료이유별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ANTP_END_RESN_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ANTP_END_RESN_CD,
COUNT(ANTP_END_RESN_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ANTP_END_RESN_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ANTP_END_RESN_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_ANTP' AND ENG_COL_NM = 'ANTP_END_RESN_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10199 // 위암 항암요법평가항목별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10199, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTP_STRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ANTP_ASMT_ITEM_CD FROM GSCN_TRTM_ANTP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTP_STRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10199 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 항암요법평가항목별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ANTP_ASMT_ITEM_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ANTP_ASMT_ITEM_CD,
COUNT(ANTP_ASMT_ITEM_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ANTP_ASMT_ITEM_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ANTP_ASMT_ITEM_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_ANTP' AND ENG_COL_NM = 'ANTP_ASMT_ITEM_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10200 // 위암 항암요법부작용별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10200, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTP_STRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ANTP_SEFF_CD FROM GSCN_TRTM_ANTP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTP_STRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10200 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 항암요법부작용별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ANTP_SEFF_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ANTP_SEFF_CD,
COUNT(ANTP_SEFF_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ANTP_SEFF_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ANTP_SEFF_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_ANTP' AND ENG_COL_NM = 'ANTP_SEFF_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10201 // 위암 항암요법부작용등급별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10201, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTP_STRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ANTP_SEFF_GRCD FROM GSCN_TRTM_ANTP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTP_STRT_YMD BETWEEN '20100101' AND '20211231')
SELECT	10201 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 항암요법부작용등급별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.ANTP_SEFF_GRCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ANTP_SEFF_GRCD,
COUNT(ANTP_SEFF_GRCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ANTP_SEFF_GRCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ANTP_SEFF_GRCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_ANTP' AND ENG_COL_NM = 'ANTP_SEFF_GRCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10202 // 위암 방사선치료종류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10202, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_KNCD FROM GSCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10202 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 방사선치료종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.RDT_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_KNCD,
COUNT(RDT_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_RD' AND ENG_COL_NM = 'RDT_KNCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10203 // 위암 방사선치료EDI코드별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10203, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_EDI_CD FROM GSCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10203 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 방사선치료EDI코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.RDT_EDI_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_EDI_CD,
COUNT(RDT_EDI_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_EDI_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_EDI_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_RD' AND ENG_COL_NM = 'RDT_EDI_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10204 // 위암 방사선치료EDI명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10204, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_EDI_NM FROM GSCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10204 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 방사선치료EDI명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.RDT_EDI_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_EDI_NM,
COUNT(RDT_EDI_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_EDI_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_EDI_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_RD' AND ENG_COL_NM = 'RDT_EDI_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10205 // 위암 방사선치료SNOMEDCT코드별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10205, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_SMCT_CD FROM GSCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10205 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 방사선치료SNOMEDCT코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.RDT_SMCT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_SMCT_CD,
COUNT(RDT_SMCT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_SMCT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_SMCT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_RD' AND ENG_COL_NM = 'RDT_SMCT_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10206 // 위암 방사선치료SNOMEDCT명별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10206, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_SMCT_NM FROM GSCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10206 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 방사선치료SNOMEDCT명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.RDT_SMCT_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_SMCT_NM,
COUNT(RDT_SMCT_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_SMCT_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_SMCT_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_RD' AND ENG_COL_NM = 'RDT_SMCT_NM') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10207 // 위암 방사선치료목적별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10207, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_PRPS_CD FROM GSCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10207 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 방사선치료목적별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.RDT_PRPS_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_PRPS_CD,
COUNT(RDT_PRPS_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_PRPS_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_PRPS_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_RD' AND ENG_COL_NM = 'RDT_PRPS_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10208 // 위암 방사선치료부위별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10208, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_SITE_CD FROM GSCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10208 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 방사선치료부위별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.RDT_SITE_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_SITE_CD,
COUNT(RDT_SITE_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_SITE_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_SITE_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_RD' AND ENG_COL_NM = 'RDT_SITE_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10209 // 위암 부위별방사선시행횟수별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10209, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BYST_RD_IMPL_NT FROM GSCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10209 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 부위별방사선시행횟수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.BYST_RD_IMPL_NT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BYST_RD_IMPL_NT,
COUNT(BYST_RD_IMPL_NT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BYST_RD_IMPL_NT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BYST_RD_IMPL_NT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_RD' AND ENG_COL_NM = 'BYST_RD_IMPL_NT') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10210 // 위암 방사선선량별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10210, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RD_GY FROM GSCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10210 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 방사선선량별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.RD_GY AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RD_GY,
COUNT(RD_GY) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RD_GY) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RD_GY) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_RD' AND ENG_COL_NM = 'RD_GY') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10211 // 위암 부위별방사선총선량별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10211, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BYST_RD_TOTL_GY FROM GSCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10211 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 부위별방사선총선량별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.BYST_RD_TOTL_GY AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BYST_RD_TOTL_GY,
COUNT(BYST_RD_TOTL_GY) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BYST_RD_TOTL_GY) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BYST_RD_TOTL_GY) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_RD' AND ENG_COL_NM = 'BYST_RD_TOTL_GY') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10212 // 위암 방사선치료평가항목별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10212, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_ASMT_ITEM_CD FROM GSCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10212 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 방사선치료평가항목별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.RDT_ASMT_ITEM_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_ASMT_ITEM_CD,
COUNT(RDT_ASMT_ITEM_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_ASMT_ITEM_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_ASMT_ITEM_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_RD' AND ENG_COL_NM = 'RDT_ASMT_ITEM_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10213 // 위암 방사선치료부작용시기구분별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10213, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_SEFF_PERD_SPCD FROM GSCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10213 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 방사선치료부작용시기구분별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.RDT_SEFF_PERD_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_SEFF_PERD_SPCD,
COUNT(RDT_SEFF_PERD_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_SEFF_PERD_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_SEFF_PERD_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_RD' AND ENG_COL_NM = 'RDT_SEFF_PERD_SPCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10214 // 위암 방사선치료부작용종류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10214, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_SEFF_KNCD FROM GSCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10214 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 방사선치료부작용종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.RDT_SEFF_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_SEFF_KNCD,
COUNT(RDT_SEFF_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_SEFF_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_SEFF_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_RD' AND ENG_COL_NM = 'RDT_SEFF_KNCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10215 // 위암 방사선치료부작용등급별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10215, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_SEFF_GRCD FROM GSCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231')
SELECT	10215 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 방사선치료부작용등급별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.RDT_SEFF_GRCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_SEFF_GRCD,
COUNT(RDT_SEFF_GRCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_SEFF_GRCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_SEFF_GRCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_TRTM_RD' AND ENG_COL_NM = 'RDT_SEFF_GRCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10216 // 위암 재발진단방법별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10216, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RLDG_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RLDG_MTCD FROM GSCN_FUOR_RLPS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RLDG_YMD BETWEEN '20100101' AND '20211231')
SELECT	10216 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 재발진단방법별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.RLDG_MTCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RLDG_MTCD,
COUNT(RLDG_MTCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RLDG_MTCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RLDG_MTCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_FUOR_RLPS' AND ENG_COL_NM = 'RLDG_MTCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10217 // 위암 재발부위별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10217, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RLDG_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RLPS_SITE_CD FROM GSCN_FUOR_RLPS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RLDG_YMD BETWEEN '20100101' AND '20211231')
SELECT	10217 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 재발부위별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.RLPS_SITE_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RLPS_SITE_CD,
COUNT(RLPS_SITE_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RLPS_SITE_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RLPS_SITE_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_FUOR_RLPS' AND ENG_COL_NM = 'RLPS_SITE_CD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);

-- 10218 // 위암 재발종류별 
	INSERT INTO CNCR_TBL_SMRY_STATS (	SELECT * FROM( WITH W1 AS (SELECT 	10218, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RLDG_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RLPS_KNCD FROM GSCN_FUOR_RLPS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RLDG_YMD BETWEEN '20100101' AND '20211231')
SELECT	10218 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'위암 재발종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, CAST(A.PT_AGE AS NUMERIC) AS PT_AGE, A.PT_SEX_CD,
 A.RLPS_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RLPS_KNCD,
COUNT(RLPS_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RLPS_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RLPS_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'GSCN_FUOR_RLPS' AND ENG_COL_NM = 'RLPS_KNCD') xx
WHERE STATS_TRGT_VL IS NOT NULL
);
