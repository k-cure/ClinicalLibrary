INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98020' AS TBL_ID, '9802001' AS COL_ID,  1 AS COL_SEQ FROM OBSERVATION_PERIOD WHERE OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM OBSERVATION_PERIOD WHERE  OBSERVATION_PERIOD_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM OBSERVATION_PERIOD WHERE  OBSERVATION_PERIOD_ID IS NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM OBSERVATION_PERIOD WHERE PERSON_ID  IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(OBSERVATION_PERIOD_ID) AS AVE FROM OBSERVATION_PERIOD WHERE  OBSERVATION_PERIOD_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(OBSERVATION_PERIOD_ID) AS MIN_VL FROM OBSERVATION_PERIOD WHERE  OBSERVATION_PERIOD_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY OBSERVATION_PERIOD_ID) AS N1_QRTL_CNT FROM OBSERVATION_PERIOD WHERE OBSERVATION_PERIOD_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY OBSERVATION_PERIOD_ID) AS N2_QRTL_CNT FROM OBSERVATION_PERIOD WHERE OBSERVATION_PERIOD_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY OBSERVATION_PERIOD_ID) AS N3_QRTL_CNT FROM OBSERVATION_PERIOD WHERE OBSERVATION_PERIOD_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(OBSERVATION_PERIOD_ID) AS N4_QRTL_CNT FROM OBSERVATION_PERIOD WHERE  OBSERVATION_PERIOD_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT OBSERVATION_PERIOD_ID AS MODE_VL, COUNT(OBSERVATION_PERIOD_ID) AS MODE_CNT FROM OBSERVATION_PERIOD WHERE  OBSERVATION_PERIOD_ID IS NOT NULL  AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY OBSERVATION_PERIOD_ID ORDER BY COUNT(OBSERVATION_PERIOD_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98020' AS TBL_ID, '9802002' AS COL_ID,  2 AS COL_SEQ FROM OBSERVATION_PERIOD WHERE OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM OBSERVATION_PERIOD WHERE  PERSON_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM OBSERVATION_PERIOD WHERE  PERSON_ID IS NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM OBSERVATION_PERIOD WHERE PERSON_ID  IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PERSON_ID) AS AVE FROM OBSERVATION_PERIOD WHERE  PERSON_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PERSON_ID) AS MIN_VL FROM OBSERVATION_PERIOD WHERE  PERSON_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PERSON_ID) AS N1_QRTL_CNT FROM OBSERVATION_PERIOD WHERE PERSON_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PERSON_ID) AS N2_QRTL_CNT FROM OBSERVATION_PERIOD WHERE PERSON_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PERSON_ID) AS N3_QRTL_CNT FROM OBSERVATION_PERIOD WHERE PERSON_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PERSON_ID) AS N4_QRTL_CNT FROM OBSERVATION_PERIOD WHERE  PERSON_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PERSON_ID AS MODE_VL, COUNT(PERSON_ID) AS MODE_CNT FROM OBSERVATION_PERIOD WHERE  PERSON_ID IS NOT NULL  AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PERSON_ID ORDER BY COUNT(PERSON_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98020' AS TBL_ID, '9802005' AS COL_ID,  5 AS COL_SEQ FROM OBSERVATION_PERIOD WHERE OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM OBSERVATION_PERIOD WHERE  PERIOD_TYPE_CONCEPT_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM OBSERVATION_PERIOD WHERE  PERIOD_TYPE_CONCEPT_ID IS NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM OBSERVATION_PERIOD WHERE PERSON_ID  IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PERIOD_TYPE_CONCEPT_ID) AS AVE FROM OBSERVATION_PERIOD WHERE  PERIOD_TYPE_CONCEPT_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PERIOD_TYPE_CONCEPT_ID) AS MIN_VL FROM OBSERVATION_PERIOD WHERE  PERIOD_TYPE_CONCEPT_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PERIOD_TYPE_CONCEPT_ID) AS N1_QRTL_CNT FROM OBSERVATION_PERIOD WHERE PERIOD_TYPE_CONCEPT_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PERIOD_TYPE_CONCEPT_ID) AS N2_QRTL_CNT FROM OBSERVATION_PERIOD WHERE PERIOD_TYPE_CONCEPT_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PERIOD_TYPE_CONCEPT_ID) AS N3_QRTL_CNT FROM OBSERVATION_PERIOD WHERE PERIOD_TYPE_CONCEPT_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PERIOD_TYPE_CONCEPT_ID) AS N4_QRTL_CNT FROM OBSERVATION_PERIOD WHERE  PERIOD_TYPE_CONCEPT_ID IS NOT NULL AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PERIOD_TYPE_CONCEPT_ID AS MODE_VL, COUNT(PERIOD_TYPE_CONCEPT_ID) AS MODE_CNT FROM OBSERVATION_PERIOD WHERE  PERIOD_TYPE_CONCEPT_ID IS NOT NULL  AND OBSERVATION_PERIOD_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PERIOD_TYPE_CONCEPT_ID ORDER BY COUNT(PERIOD_TYPE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98030' AS TBL_ID, '9803001' AS COL_ID,  1 AS COL_SEQ FROM VISIT_OCCURRENCE WHERE VISIT_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_OCCURRENCE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_OCCURRENCE WHERE  VISIT_OCCURRENCE_ID IS NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_OCCURRENCE_ID) AS AVE FROM VISIT_OCCURRENCE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_OCCURRENCE_ID) AS MIN_VL FROM VISIT_OCCURRENCE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N1_QRTL_CNT FROM VISIT_OCCURRENCE WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N2_QRTL_CNT FROM VISIT_OCCURRENCE WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N3_QRTL_CNT FROM VISIT_OCCURRENCE WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_OCCURRENCE_ID) AS N4_QRTL_CNT FROM VISIT_OCCURRENCE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_OCCURRENCE_ID AS MODE_VL, COUNT(VISIT_OCCURRENCE_ID) AS MODE_CNT FROM VISIT_OCCURRENCE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL  AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_OCCURRENCE_ID ORDER BY COUNT(VISIT_OCCURRENCE_ID) DESC LIMIT 1 ) A ) K ;*/
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98030' AS TBL_ID, '9803002' AS COL_ID,  2 AS COL_SEQ FROM VISIT_OCCURRENCE WHERE VISIT_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_OCCURRENCE WHERE  PERSON_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_OCCURRENCE WHERE  PERSON_ID IS NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PERSON_ID) AS AVE FROM VISIT_OCCURRENCE WHERE  PERSON_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PERSON_ID) AS MIN_VL FROM VISIT_OCCURRENCE WHERE  PERSON_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PERSON_ID) AS N1_QRTL_CNT FROM VISIT_OCCURRENCE WHERE PERSON_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PERSON_ID) AS N2_QRTL_CNT FROM VISIT_OCCURRENCE WHERE PERSON_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PERSON_ID) AS N3_QRTL_CNT FROM VISIT_OCCURRENCE WHERE PERSON_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PERSON_ID) AS N4_QRTL_CNT FROM VISIT_OCCURRENCE WHERE  PERSON_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PERSON_ID AS MODE_VL, COUNT(PERSON_ID) AS MODE_CNT FROM VISIT_OCCURRENCE WHERE  PERSON_ID IS NOT NULL  AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PERSON_ID ORDER BY COUNT(PERSON_ID) DESC LIMIT 1 ) A ) K ;*/
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98030' AS TBL_ID, '9803003' AS COL_ID,  3 AS COL_SEQ FROM VISIT_OCCURRENCE WHERE VISIT_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_OCCURRENCE WHERE  VISIT_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_OCCURRENCE WHERE  VISIT_CONCEPT_ID IS NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_CONCEPT_ID) AS AVE FROM VISIT_OCCURRENCE WHERE  VISIT_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_CONCEPT_ID) AS MIN_VL FROM VISIT_OCCURRENCE WHERE  VISIT_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_CONCEPT_ID) AS N1_QRTL_CNT FROM VISIT_OCCURRENCE WHERE VISIT_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_CONCEPT_ID) AS N2_QRTL_CNT FROM VISIT_OCCURRENCE WHERE VISIT_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_CONCEPT_ID) AS N3_QRTL_CNT FROM VISIT_OCCURRENCE WHERE VISIT_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_CONCEPT_ID) AS N4_QRTL_CNT FROM VISIT_OCCURRENCE WHERE  VISIT_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_CONCEPT_ID AS MODE_VL, COUNT(VISIT_CONCEPT_ID) AS MODE_CNT FROM VISIT_OCCURRENCE WHERE  VISIT_CONCEPT_ID IS NOT NULL  AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_CONCEPT_ID ORDER BY COUNT(VISIT_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98030' AS TBL_ID, '9803008' AS COL_ID,  8 AS COL_SEQ FROM VISIT_OCCURRENCE WHERE VISIT_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_OCCURRENCE WHERE  VISIT_TYPE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_OCCURRENCE WHERE  VISIT_TYPE_CONCEPT_ID IS NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_TYPE_CONCEPT_ID) AS AVE FROM VISIT_OCCURRENCE WHERE  VISIT_TYPE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_TYPE_CONCEPT_ID) AS MIN_VL FROM VISIT_OCCURRENCE WHERE  VISIT_TYPE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_TYPE_CONCEPT_ID) AS N1_QRTL_CNT FROM VISIT_OCCURRENCE WHERE VISIT_TYPE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_TYPE_CONCEPT_ID) AS N2_QRTL_CNT FROM VISIT_OCCURRENCE WHERE VISIT_TYPE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_TYPE_CONCEPT_ID) AS N3_QRTL_CNT FROM VISIT_OCCURRENCE WHERE VISIT_TYPE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_TYPE_CONCEPT_ID) AS N4_QRTL_CNT FROM VISIT_OCCURRENCE WHERE  VISIT_TYPE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_TYPE_CONCEPT_ID AS MODE_VL, COUNT(VISIT_TYPE_CONCEPT_ID) AS MODE_CNT FROM VISIT_OCCURRENCE WHERE  VISIT_TYPE_CONCEPT_ID IS NOT NULL  AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_TYPE_CONCEPT_ID ORDER BY COUNT(VISIT_TYPE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98030' AS TBL_ID, '9803009' AS COL_ID,  9 AS COL_SEQ FROM VISIT_OCCURRENCE WHERE VISIT_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_OCCURRENCE WHERE  PROVIDER_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_OCCURRENCE WHERE  PROVIDER_ID IS NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PROVIDER_ID) AS AVE FROM VISIT_OCCURRENCE WHERE  PROVIDER_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PROVIDER_ID) AS MIN_VL FROM VISIT_OCCURRENCE WHERE  PROVIDER_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N1_QRTL_CNT FROM VISIT_OCCURRENCE WHERE PROVIDER_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N2_QRTL_CNT FROM VISIT_OCCURRENCE WHERE PROVIDER_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N3_QRTL_CNT FROM VISIT_OCCURRENCE WHERE PROVIDER_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PROVIDER_ID) AS N4_QRTL_CNT FROM VISIT_OCCURRENCE WHERE  PROVIDER_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PROVIDER_ID AS MODE_VL, COUNT(PROVIDER_ID) AS MODE_CNT FROM VISIT_OCCURRENCE WHERE  PROVIDER_ID IS NOT NULL  AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PROVIDER_ID ORDER BY COUNT(PROVIDER_ID) DESC LIMIT 1 ) A ) K ;*/
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98030' AS TBL_ID, '9803010' AS COL_ID,  10 AS COL_SEQ FROM VISIT_OCCURRENCE WHERE VISIT_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_OCCURRENCE WHERE  CARE_SITE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_OCCURRENCE WHERE  CARE_SITE_ID IS NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(CARE_SITE_ID) AS AVE FROM VISIT_OCCURRENCE WHERE  CARE_SITE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(CARE_SITE_ID) AS MIN_VL FROM VISIT_OCCURRENCE WHERE  CARE_SITE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY CARE_SITE_ID) AS N1_QRTL_CNT FROM VISIT_OCCURRENCE WHERE CARE_SITE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY CARE_SITE_ID) AS N2_QRTL_CNT FROM VISIT_OCCURRENCE WHERE CARE_SITE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY CARE_SITE_ID) AS N3_QRTL_CNT FROM VISIT_OCCURRENCE WHERE CARE_SITE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(CARE_SITE_ID) AS N4_QRTL_CNT FROM VISIT_OCCURRENCE WHERE  CARE_SITE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT CARE_SITE_ID AS MODE_VL, COUNT(CARE_SITE_ID) AS MODE_CNT FROM VISIT_OCCURRENCE WHERE  CARE_SITE_ID IS NOT NULL  AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY CARE_SITE_ID ORDER BY COUNT(CARE_SITE_ID) DESC LIMIT 1 ) A ) K ;*/
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98030' AS TBL_ID, '9803012' AS COL_ID,  12 AS COL_SEQ FROM VISIT_OCCURRENCE WHERE VISIT_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_OCCURRENCE WHERE  VISIT_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_OCCURRENCE WHERE  VISIT_SOURCE_CONCEPT_ID IS NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_SOURCE_CONCEPT_ID) AS AVE FROM VISIT_OCCURRENCE WHERE  VISIT_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_SOURCE_CONCEPT_ID) AS MIN_VL FROM VISIT_OCCURRENCE WHERE  VISIT_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_SOURCE_CONCEPT_ID) AS N1_QRTL_CNT FROM VISIT_OCCURRENCE WHERE VISIT_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_SOURCE_CONCEPT_ID) AS N2_QRTL_CNT FROM VISIT_OCCURRENCE WHERE VISIT_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_SOURCE_CONCEPT_ID) AS N3_QRTL_CNT FROM VISIT_OCCURRENCE WHERE VISIT_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_SOURCE_CONCEPT_ID) AS N4_QRTL_CNT FROM VISIT_OCCURRENCE WHERE  VISIT_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_SOURCE_CONCEPT_ID AS MODE_VL, COUNT(VISIT_SOURCE_CONCEPT_ID) AS MODE_CNT FROM VISIT_OCCURRENCE WHERE  VISIT_SOURCE_CONCEPT_ID IS NOT NULL  AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_SOURCE_CONCEPT_ID ORDER BY COUNT(VISIT_SOURCE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98030' AS TBL_ID, '9803013' AS COL_ID,  13 AS COL_SEQ FROM VISIT_OCCURRENCE WHERE VISIT_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_OCCURRENCE WHERE  ADMITTING_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_OCCURRENCE WHERE  ADMITTING_SOURCE_CONCEPT_ID IS NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(ADMITTING_SOURCE_CONCEPT_ID) AS AVE FROM VISIT_OCCURRENCE WHERE  ADMITTING_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(ADMITTING_SOURCE_CONCEPT_ID) AS MIN_VL FROM VISIT_OCCURRENCE WHERE  ADMITTING_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY ADMITTING_SOURCE_CONCEPT_ID) AS N1_QRTL_CNT FROM VISIT_OCCURRENCE WHERE ADMITTING_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY ADMITTING_SOURCE_CONCEPT_ID) AS N2_QRTL_CNT FROM VISIT_OCCURRENCE WHERE ADMITTING_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY ADMITTING_SOURCE_CONCEPT_ID) AS N3_QRTL_CNT FROM VISIT_OCCURRENCE WHERE ADMITTING_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(ADMITTING_SOURCE_CONCEPT_ID) AS N4_QRTL_CNT FROM VISIT_OCCURRENCE WHERE  ADMITTING_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT ADMITTING_SOURCE_CONCEPT_ID AS MODE_VL, COUNT(ADMITTING_SOURCE_CONCEPT_ID) AS MODE_CNT FROM VISIT_OCCURRENCE WHERE  ADMITTING_SOURCE_CONCEPT_ID IS NOT NULL  AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY ADMITTING_SOURCE_CONCEPT_ID ORDER BY COUNT(ADMITTING_SOURCE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98030' AS TBL_ID, '9803015' AS COL_ID,  15 AS COL_SEQ FROM VISIT_OCCURRENCE WHERE VISIT_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_OCCURRENCE WHERE  DISCHARGE_TO_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_OCCURRENCE WHERE  DISCHARGE_TO_CONCEPT_ID IS NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(DISCHARGE_TO_CONCEPT_ID) AS AVE FROM VISIT_OCCURRENCE WHERE  DISCHARGE_TO_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(DISCHARGE_TO_CONCEPT_ID) AS MIN_VL FROM VISIT_OCCURRENCE WHERE  DISCHARGE_TO_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY DISCHARGE_TO_CONCEPT_ID) AS N1_QRTL_CNT FROM VISIT_OCCURRENCE WHERE DISCHARGE_TO_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY DISCHARGE_TO_CONCEPT_ID) AS N2_QRTL_CNT FROM VISIT_OCCURRENCE WHERE DISCHARGE_TO_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY DISCHARGE_TO_CONCEPT_ID) AS N3_QRTL_CNT FROM VISIT_OCCURRENCE WHERE DISCHARGE_TO_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(DISCHARGE_TO_CONCEPT_ID) AS N4_QRTL_CNT FROM VISIT_OCCURRENCE WHERE  DISCHARGE_TO_CONCEPT_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT DISCHARGE_TO_CONCEPT_ID AS MODE_VL, COUNT(DISCHARGE_TO_CONCEPT_ID) AS MODE_CNT FROM VISIT_OCCURRENCE WHERE  DISCHARGE_TO_CONCEPT_ID IS NOT NULL  AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY DISCHARGE_TO_CONCEPT_ID ORDER BY COUNT(DISCHARGE_TO_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98030' AS TBL_ID, '9803017' AS COL_ID,  17 AS COL_SEQ FROM VISIT_OCCURRENCE WHERE VISIT_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_OCCURRENCE WHERE  PRECEDING_VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_OCCURRENCE WHERE  PRECEDING_VISIT_OCCURRENCE_ID IS NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PRECEDING_VISIT_OCCURRENCE_ID) AS AVE FROM VISIT_OCCURRENCE WHERE  PRECEDING_VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PRECEDING_VISIT_OCCURRENCE_ID) AS MIN_VL FROM VISIT_OCCURRENCE WHERE  PRECEDING_VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PRECEDING_VISIT_OCCURRENCE_ID) AS N1_QRTL_CNT FROM VISIT_OCCURRENCE WHERE PRECEDING_VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PRECEDING_VISIT_OCCURRENCE_ID) AS N2_QRTL_CNT FROM VISIT_OCCURRENCE WHERE PRECEDING_VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PRECEDING_VISIT_OCCURRENCE_ID) AS N3_QRTL_CNT FROM VISIT_OCCURRENCE WHERE PRECEDING_VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PRECEDING_VISIT_OCCURRENCE_ID) AS N4_QRTL_CNT FROM VISIT_OCCURRENCE WHERE  PRECEDING_VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PRECEDING_VISIT_OCCURRENCE_ID AS MODE_VL, COUNT(PRECEDING_VISIT_OCCURRENCE_ID) AS MODE_CNT FROM VISIT_OCCURRENCE WHERE  PRECEDING_VISIT_OCCURRENCE_ID IS NOT NULL  AND VISIT_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PRECEDING_VISIT_OCCURRENCE_ID ORDER BY COUNT(PRECEDING_VISIT_OCCURRENCE_ID) DESC LIMIT 1 ) A ) K ;*/
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98040' AS TBL_ID, '9804001' AS COL_ID,  1 AS COL_SEQ FROM VISIT_DETAIL WHERE VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_DETAIL WHERE  VISIT_DETAIL_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_DETAIL WHERE  VISIT_DETAIL_ID IS NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_DETAIL WHERE PERSON_ID  IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_DETAIL_ID) AS AVE FROM VISIT_DETAIL WHERE  VISIT_DETAIL_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_DETAIL_ID) AS MIN_VL FROM VISIT_DETAIL WHERE  VISIT_DETAIL_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N1_QRTL_CNT FROM VISIT_DETAIL WHERE VISIT_DETAIL_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N2_QRTL_CNT FROM VISIT_DETAIL WHERE VISIT_DETAIL_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N3_QRTL_CNT FROM VISIT_DETAIL WHERE VISIT_DETAIL_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_DETAIL_ID) AS N4_QRTL_CNT FROM VISIT_DETAIL WHERE  VISIT_DETAIL_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_DETAIL_ID AS MODE_VL, COUNT(VISIT_DETAIL_ID) AS MODE_CNT FROM VISIT_DETAIL WHERE  VISIT_DETAIL_ID IS NOT NULL  AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_DETAIL_ID ORDER BY COUNT(VISIT_DETAIL_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98040' AS TBL_ID, '9804002' AS COL_ID,  2 AS COL_SEQ FROM VISIT_DETAIL WHERE VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_DETAIL WHERE  PERSON_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_DETAIL WHERE  PERSON_ID IS NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_DETAIL WHERE PERSON_ID  IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PERSON_ID) AS AVE FROM VISIT_DETAIL WHERE  PERSON_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PERSON_ID) AS MIN_VL FROM VISIT_DETAIL WHERE  PERSON_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PERSON_ID) AS N1_QRTL_CNT FROM VISIT_DETAIL WHERE PERSON_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PERSON_ID) AS N2_QRTL_CNT FROM VISIT_DETAIL WHERE PERSON_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PERSON_ID) AS N3_QRTL_CNT FROM VISIT_DETAIL WHERE PERSON_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PERSON_ID) AS N4_QRTL_CNT FROM VISIT_DETAIL WHERE  PERSON_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PERSON_ID AS MODE_VL, COUNT(PERSON_ID) AS MODE_CNT FROM VISIT_DETAIL WHERE  PERSON_ID IS NOT NULL  AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PERSON_ID ORDER BY COUNT(PERSON_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98040' AS TBL_ID, '9804003' AS COL_ID,  3 AS COL_SEQ FROM VISIT_DETAIL WHERE VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_DETAIL WHERE  VISIT_DETAIL_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_DETAIL WHERE  VISIT_DETAIL_CONCEPT_ID IS NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_DETAIL WHERE PERSON_ID  IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_DETAIL_CONCEPT_ID) AS AVE FROM VISIT_DETAIL WHERE  VISIT_DETAIL_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_DETAIL_CONCEPT_ID) AS MIN_VL FROM VISIT_DETAIL WHERE  VISIT_DETAIL_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_DETAIL_CONCEPT_ID) AS N1_QRTL_CNT FROM VISIT_DETAIL WHERE VISIT_DETAIL_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_DETAIL_CONCEPT_ID) AS N2_QRTL_CNT FROM VISIT_DETAIL WHERE VISIT_DETAIL_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_DETAIL_CONCEPT_ID) AS N3_QRTL_CNT FROM VISIT_DETAIL WHERE VISIT_DETAIL_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_DETAIL_CONCEPT_ID) AS N4_QRTL_CNT FROM VISIT_DETAIL WHERE  VISIT_DETAIL_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_DETAIL_CONCEPT_ID AS MODE_VL, COUNT(VISIT_DETAIL_CONCEPT_ID) AS MODE_CNT FROM VISIT_DETAIL WHERE  VISIT_DETAIL_CONCEPT_ID IS NOT NULL  AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_DETAIL_CONCEPT_ID ORDER BY COUNT(VISIT_DETAIL_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98040' AS TBL_ID, '9804008' AS COL_ID,  8 AS COL_SEQ FROM VISIT_DETAIL WHERE VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_DETAIL WHERE  VISIT_DETAIL_TYPE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_DETAIL WHERE  VISIT_DETAIL_TYPE_CONCEPT_ID IS NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_DETAIL WHERE PERSON_ID  IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_DETAIL_TYPE_CONCEPT_ID) AS AVE FROM VISIT_DETAIL WHERE  VISIT_DETAIL_TYPE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_DETAIL_TYPE_CONCEPT_ID) AS MIN_VL FROM VISIT_DETAIL WHERE  VISIT_DETAIL_TYPE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_DETAIL_TYPE_CONCEPT_ID) AS N1_QRTL_CNT FROM VISIT_DETAIL WHERE VISIT_DETAIL_TYPE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_DETAIL_TYPE_CONCEPT_ID) AS N2_QRTL_CNT FROM VISIT_DETAIL WHERE VISIT_DETAIL_TYPE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_DETAIL_TYPE_CONCEPT_ID) AS N3_QRTL_CNT FROM VISIT_DETAIL WHERE VISIT_DETAIL_TYPE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_DETAIL_TYPE_CONCEPT_ID) AS N4_QRTL_CNT FROM VISIT_DETAIL WHERE  VISIT_DETAIL_TYPE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_DETAIL_TYPE_CONCEPT_ID AS MODE_VL, COUNT(VISIT_DETAIL_TYPE_CONCEPT_ID) AS MODE_CNT FROM VISIT_DETAIL WHERE  VISIT_DETAIL_TYPE_CONCEPT_ID IS NOT NULL  AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_DETAIL_TYPE_CONCEPT_ID ORDER BY COUNT(VISIT_DETAIL_TYPE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98040' AS TBL_ID, '9804009' AS COL_ID,  9 AS COL_SEQ FROM VISIT_DETAIL WHERE VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_DETAIL WHERE  PROVIDER_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_DETAIL WHERE  PROVIDER_ID IS NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_DETAIL WHERE PERSON_ID  IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PROVIDER_ID) AS AVE FROM VISIT_DETAIL WHERE  PROVIDER_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PROVIDER_ID) AS MIN_VL FROM VISIT_DETAIL WHERE  PROVIDER_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N1_QRTL_CNT FROM VISIT_DETAIL WHERE PROVIDER_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N2_QRTL_CNT FROM VISIT_DETAIL WHERE PROVIDER_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N3_QRTL_CNT FROM VISIT_DETAIL WHERE PROVIDER_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PROVIDER_ID) AS N4_QRTL_CNT FROM VISIT_DETAIL WHERE  PROVIDER_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PROVIDER_ID AS MODE_VL, COUNT(PROVIDER_ID) AS MODE_CNT FROM VISIT_DETAIL WHERE  PROVIDER_ID IS NOT NULL  AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PROVIDER_ID ORDER BY COUNT(PROVIDER_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98040' AS TBL_ID, '9804010' AS COL_ID,  10 AS COL_SEQ FROM VISIT_DETAIL WHERE VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_DETAIL WHERE  CARE_SITE_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_DETAIL WHERE  CARE_SITE_ID IS NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_DETAIL WHERE PERSON_ID  IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(CARE_SITE_ID) AS AVE FROM VISIT_DETAIL WHERE  CARE_SITE_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(CARE_SITE_ID) AS MIN_VL FROM VISIT_DETAIL WHERE  CARE_SITE_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY CARE_SITE_ID) AS N1_QRTL_CNT FROM VISIT_DETAIL WHERE CARE_SITE_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY CARE_SITE_ID) AS N2_QRTL_CNT FROM VISIT_DETAIL WHERE CARE_SITE_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY CARE_SITE_ID) AS N3_QRTL_CNT FROM VISIT_DETAIL WHERE CARE_SITE_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(CARE_SITE_ID) AS N4_QRTL_CNT FROM VISIT_DETAIL WHERE  CARE_SITE_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT CARE_SITE_ID AS MODE_VL, COUNT(CARE_SITE_ID) AS MODE_CNT FROM VISIT_DETAIL WHERE  CARE_SITE_ID IS NOT NULL  AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY CARE_SITE_ID ORDER BY COUNT(CARE_SITE_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98040' AS TBL_ID, '9804012' AS COL_ID,  12 AS COL_SEQ FROM VISIT_DETAIL WHERE VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_DETAIL WHERE  VISIT_DETAIL_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_DETAIL WHERE  VISIT_DETAIL_SOURCE_CONCEPT_ID IS NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_DETAIL WHERE PERSON_ID  IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_DETAIL_SOURCE_CONCEPT_ID) AS AVE FROM VISIT_DETAIL WHERE  VISIT_DETAIL_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_DETAIL_SOURCE_CONCEPT_ID) AS MIN_VL FROM VISIT_DETAIL WHERE  VISIT_DETAIL_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_DETAIL_SOURCE_CONCEPT_ID) AS N1_QRTL_CNT FROM VISIT_DETAIL WHERE VISIT_DETAIL_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_DETAIL_SOURCE_CONCEPT_ID) AS N2_QRTL_CNT FROM VISIT_DETAIL WHERE VISIT_DETAIL_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_DETAIL_SOURCE_CONCEPT_ID) AS N3_QRTL_CNT FROM VISIT_DETAIL WHERE VISIT_DETAIL_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_DETAIL_SOURCE_CONCEPT_ID) AS N4_QRTL_CNT FROM VISIT_DETAIL WHERE  VISIT_DETAIL_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_DETAIL_SOURCE_CONCEPT_ID AS MODE_VL, COUNT(VISIT_DETAIL_SOURCE_CONCEPT_ID) AS MODE_CNT FROM VISIT_DETAIL WHERE  VISIT_DETAIL_SOURCE_CONCEPT_ID IS NOT NULL  AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_DETAIL_SOURCE_CONCEPT_ID ORDER BY COUNT(VISIT_DETAIL_SOURCE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98040' AS TBL_ID, '9804014' AS COL_ID,  14 AS COL_SEQ FROM VISIT_DETAIL WHERE VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_DETAIL WHERE  ADMITTING_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_DETAIL WHERE  ADMITTING_SOURCE_CONCEPT_ID IS NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_DETAIL WHERE PERSON_ID  IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(ADMITTING_SOURCE_CONCEPT_ID) AS AVE FROM VISIT_DETAIL WHERE  ADMITTING_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(ADMITTING_SOURCE_CONCEPT_ID) AS MIN_VL FROM VISIT_DETAIL WHERE  ADMITTING_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY ADMITTING_SOURCE_CONCEPT_ID) AS N1_QRTL_CNT FROM VISIT_DETAIL WHERE ADMITTING_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY ADMITTING_SOURCE_CONCEPT_ID) AS N2_QRTL_CNT FROM VISIT_DETAIL WHERE ADMITTING_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY ADMITTING_SOURCE_CONCEPT_ID) AS N3_QRTL_CNT FROM VISIT_DETAIL WHERE ADMITTING_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(ADMITTING_SOURCE_CONCEPT_ID) AS N4_QRTL_CNT FROM VISIT_DETAIL WHERE  ADMITTING_SOURCE_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT ADMITTING_SOURCE_CONCEPT_ID AS MODE_VL, COUNT(ADMITTING_SOURCE_CONCEPT_ID) AS MODE_CNT FROM VISIT_DETAIL WHERE  ADMITTING_SOURCE_CONCEPT_ID IS NOT NULL  AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY ADMITTING_SOURCE_CONCEPT_ID ORDER BY COUNT(ADMITTING_SOURCE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98040' AS TBL_ID, '9804016' AS COL_ID,  16 AS COL_SEQ FROM VISIT_DETAIL WHERE VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_DETAIL WHERE  DISCHARGE_TO_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_DETAIL WHERE  DISCHARGE_TO_CONCEPT_ID IS NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_DETAIL WHERE PERSON_ID  IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(DISCHARGE_TO_CONCEPT_ID) AS AVE FROM VISIT_DETAIL WHERE  DISCHARGE_TO_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(DISCHARGE_TO_CONCEPT_ID) AS MIN_VL FROM VISIT_DETAIL WHERE  DISCHARGE_TO_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY DISCHARGE_TO_CONCEPT_ID) AS N1_QRTL_CNT FROM VISIT_DETAIL WHERE DISCHARGE_TO_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY DISCHARGE_TO_CONCEPT_ID) AS N2_QRTL_CNT FROM VISIT_DETAIL WHERE DISCHARGE_TO_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY DISCHARGE_TO_CONCEPT_ID) AS N3_QRTL_CNT FROM VISIT_DETAIL WHERE DISCHARGE_TO_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(DISCHARGE_TO_CONCEPT_ID) AS N4_QRTL_CNT FROM VISIT_DETAIL WHERE  DISCHARGE_TO_CONCEPT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT DISCHARGE_TO_CONCEPT_ID AS MODE_VL, COUNT(DISCHARGE_TO_CONCEPT_ID) AS MODE_CNT FROM VISIT_DETAIL WHERE  DISCHARGE_TO_CONCEPT_ID IS NOT NULL  AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY DISCHARGE_TO_CONCEPT_ID ORDER BY COUNT(DISCHARGE_TO_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98040' AS TBL_ID, '9804017' AS COL_ID,  17 AS COL_SEQ FROM VISIT_DETAIL WHERE VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_DETAIL WHERE  PRECEDING_VISIT_DETAIL_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_DETAIL WHERE  PRECEDING_VISIT_DETAIL_ID IS NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_DETAIL WHERE PERSON_ID  IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PRECEDING_VISIT_DETAIL_ID) AS AVE FROM VISIT_DETAIL WHERE  PRECEDING_VISIT_DETAIL_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PRECEDING_VISIT_DETAIL_ID) AS MIN_VL FROM VISIT_DETAIL WHERE  PRECEDING_VISIT_DETAIL_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PRECEDING_VISIT_DETAIL_ID) AS N1_QRTL_CNT FROM VISIT_DETAIL WHERE PRECEDING_VISIT_DETAIL_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PRECEDING_VISIT_DETAIL_ID) AS N2_QRTL_CNT FROM VISIT_DETAIL WHERE PRECEDING_VISIT_DETAIL_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PRECEDING_VISIT_DETAIL_ID) AS N3_QRTL_CNT FROM VISIT_DETAIL WHERE PRECEDING_VISIT_DETAIL_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PRECEDING_VISIT_DETAIL_ID) AS N4_QRTL_CNT FROM VISIT_DETAIL WHERE  PRECEDING_VISIT_DETAIL_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PRECEDING_VISIT_DETAIL_ID AS MODE_VL, COUNT(PRECEDING_VISIT_DETAIL_ID) AS MODE_CNT FROM VISIT_DETAIL WHERE  PRECEDING_VISIT_DETAIL_ID IS NOT NULL  AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PRECEDING_VISIT_DETAIL_ID ORDER BY COUNT(PRECEDING_VISIT_DETAIL_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98040' AS TBL_ID, '9804018' AS COL_ID,  18 AS COL_SEQ FROM VISIT_DETAIL WHERE VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_DETAIL WHERE  VISIT_DETAIL_PARENT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_DETAIL WHERE  VISIT_DETAIL_PARENT_ID IS NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_DETAIL WHERE PERSON_ID  IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_DETAIL_PARENT_ID) AS AVE FROM VISIT_DETAIL WHERE  VISIT_DETAIL_PARENT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_DETAIL_PARENT_ID) AS MIN_VL FROM VISIT_DETAIL WHERE  VISIT_DETAIL_PARENT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_DETAIL_PARENT_ID) AS N1_QRTL_CNT FROM VISIT_DETAIL WHERE VISIT_DETAIL_PARENT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_DETAIL_PARENT_ID) AS N2_QRTL_CNT FROM VISIT_DETAIL WHERE VISIT_DETAIL_PARENT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_DETAIL_PARENT_ID) AS N3_QRTL_CNT FROM VISIT_DETAIL WHERE VISIT_DETAIL_PARENT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_DETAIL_PARENT_ID) AS N4_QRTL_CNT FROM VISIT_DETAIL WHERE  VISIT_DETAIL_PARENT_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_DETAIL_PARENT_ID AS MODE_VL, COUNT(VISIT_DETAIL_PARENT_ID) AS MODE_CNT FROM VISIT_DETAIL WHERE  VISIT_DETAIL_PARENT_ID IS NOT NULL  AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_DETAIL_PARENT_ID ORDER BY COUNT(VISIT_DETAIL_PARENT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98040' AS TBL_ID, '9804019' AS COL_ID,  19 AS COL_SEQ FROM VISIT_DETAIL WHERE VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM VISIT_DETAIL WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM VISIT_DETAIL WHERE  VISIT_OCCURRENCE_ID IS NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM VISIT_DETAIL WHERE PERSON_ID  IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_OCCURRENCE_ID) AS AVE FROM VISIT_DETAIL WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_OCCURRENCE_ID) AS MIN_VL FROM VISIT_DETAIL WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N1_QRTL_CNT FROM VISIT_DETAIL WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N2_QRTL_CNT FROM VISIT_DETAIL WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N3_QRTL_CNT FROM VISIT_DETAIL WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_OCCURRENCE_ID) AS N4_QRTL_CNT FROM VISIT_DETAIL WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_OCCURRENCE_ID AS MODE_VL, COUNT(VISIT_OCCURRENCE_ID) AS MODE_CNT FROM VISIT_DETAIL WHERE  VISIT_OCCURRENCE_ID IS NOT NULL  AND VISIT_DETAIL_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_OCCURRENCE_ID ORDER BY COUNT(VISIT_OCCURRENCE_ID) DESC LIMIT 1 ) A ) K ;
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98050' AS TBL_ID, '9805001' AS COL_ID,  1 AS COL_SEQ FROM CONDITION_OCCURRENCE WHERE CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM CONDITION_OCCURRENCE WHERE  CONDITION_OCCURRENCE_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM CONDITION_OCCURRENCE WHERE  CONDITION_OCCURRENCE_ID IS NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM CONDITION_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(CONDITION_OCCURRENCE_ID) AS AVE FROM CONDITION_OCCURRENCE WHERE  CONDITION_OCCURRENCE_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(CONDITION_OCCURRENCE_ID) AS MIN_VL FROM CONDITION_OCCURRENCE WHERE  CONDITION_OCCURRENCE_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY CONDITION_OCCURRENCE_ID) AS N1_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE CONDITION_OCCURRENCE_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY CONDITION_OCCURRENCE_ID) AS N2_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE CONDITION_OCCURRENCE_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY CONDITION_OCCURRENCE_ID) AS N3_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE CONDITION_OCCURRENCE_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(CONDITION_OCCURRENCE_ID) AS N4_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE  CONDITION_OCCURRENCE_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT CONDITION_OCCURRENCE_ID AS MODE_VL, COUNT(CONDITION_OCCURRENCE_ID) AS MODE_CNT FROM CONDITION_OCCURRENCE WHERE  CONDITION_OCCURRENCE_ID IS NOT NULL  AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY CONDITION_OCCURRENCE_ID ORDER BY COUNT(CONDITION_OCCURRENCE_ID) DESC LIMIT 1 ) A ) K ;*/
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98050' AS TBL_ID, '9805002' AS COL_ID,  2 AS COL_SEQ FROM CONDITION_OCCURRENCE WHERE CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM CONDITION_OCCURRENCE WHERE  PERSON_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM CONDITION_OCCURRENCE WHERE  PERSON_ID IS NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM CONDITION_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PERSON_ID) AS AVE FROM CONDITION_OCCURRENCE WHERE  PERSON_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PERSON_ID) AS MIN_VL FROM CONDITION_OCCURRENCE WHERE  PERSON_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PERSON_ID) AS N1_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE PERSON_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PERSON_ID) AS N2_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE PERSON_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PERSON_ID) AS N3_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE PERSON_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PERSON_ID) AS N4_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE  PERSON_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PERSON_ID AS MODE_VL, COUNT(PERSON_ID) AS MODE_CNT FROM CONDITION_OCCURRENCE WHERE  PERSON_ID IS NOT NULL  AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PERSON_ID ORDER BY COUNT(PERSON_ID) DESC LIMIT 1 ) A ) K ;*/
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98050' AS TBL_ID, '9805003' AS COL_ID,  3 AS COL_SEQ FROM CONDITION_OCCURRENCE WHERE CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM CONDITION_OCCURRENCE WHERE  CONDITION_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM CONDITION_OCCURRENCE WHERE  CONDITION_CONCEPT_ID IS NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM CONDITION_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(CONDITION_CONCEPT_ID) AS AVE FROM CONDITION_OCCURRENCE WHERE  CONDITION_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(CONDITION_CONCEPT_ID) AS MIN_VL FROM CONDITION_OCCURRENCE WHERE  CONDITION_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY CONDITION_CONCEPT_ID) AS N1_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE CONDITION_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY CONDITION_CONCEPT_ID) AS N2_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE CONDITION_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY CONDITION_CONCEPT_ID) AS N3_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE CONDITION_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(CONDITION_CONCEPT_ID) AS N4_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE  CONDITION_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT CONDITION_CONCEPT_ID AS MODE_VL, COUNT(CONDITION_CONCEPT_ID) AS MODE_CNT FROM CONDITION_OCCURRENCE WHERE  CONDITION_CONCEPT_ID IS NOT NULL  AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY CONDITION_CONCEPT_ID ORDER BY COUNT(CONDITION_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98050' AS TBL_ID, '9805008' AS COL_ID,  8 AS COL_SEQ FROM CONDITION_OCCURRENCE WHERE CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM CONDITION_OCCURRENCE WHERE  CONDITION_TYPE_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM CONDITION_OCCURRENCE WHERE  CONDITION_TYPE_CONCEPT_ID IS NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM CONDITION_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(CONDITION_TYPE_CONCEPT_ID) AS AVE FROM CONDITION_OCCURRENCE WHERE  CONDITION_TYPE_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(CONDITION_TYPE_CONCEPT_ID) AS MIN_VL FROM CONDITION_OCCURRENCE WHERE  CONDITION_TYPE_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY CONDITION_TYPE_CONCEPT_ID) AS N1_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE CONDITION_TYPE_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY CONDITION_TYPE_CONCEPT_ID) AS N2_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE CONDITION_TYPE_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY CONDITION_TYPE_CONCEPT_ID) AS N3_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE CONDITION_TYPE_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(CONDITION_TYPE_CONCEPT_ID) AS N4_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE  CONDITION_TYPE_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT CONDITION_TYPE_CONCEPT_ID AS MODE_VL, COUNT(CONDITION_TYPE_CONCEPT_ID) AS MODE_CNT FROM CONDITION_OCCURRENCE WHERE  CONDITION_TYPE_CONCEPT_ID IS NOT NULL  AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY CONDITION_TYPE_CONCEPT_ID ORDER BY COUNT(CONDITION_TYPE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98050' AS TBL_ID, '9805009' AS COL_ID,  9 AS COL_SEQ FROM CONDITION_OCCURRENCE WHERE CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM CONDITION_OCCURRENCE WHERE  CONDITION_STATUS_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM CONDITION_OCCURRENCE WHERE  CONDITION_STATUS_CONCEPT_ID IS NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM CONDITION_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(CONDITION_STATUS_CONCEPT_ID) AS AVE FROM CONDITION_OCCURRENCE WHERE  CONDITION_STATUS_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(CONDITION_STATUS_CONCEPT_ID) AS MIN_VL FROM CONDITION_OCCURRENCE WHERE  CONDITION_STATUS_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY CONDITION_STATUS_CONCEPT_ID) AS N1_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE CONDITION_STATUS_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY CONDITION_STATUS_CONCEPT_ID) AS N2_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE CONDITION_STATUS_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY CONDITION_STATUS_CONCEPT_ID) AS N3_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE CONDITION_STATUS_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(CONDITION_STATUS_CONCEPT_ID) AS N4_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE  CONDITION_STATUS_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT CONDITION_STATUS_CONCEPT_ID AS MODE_VL, COUNT(CONDITION_STATUS_CONCEPT_ID) AS MODE_CNT FROM CONDITION_OCCURRENCE WHERE  CONDITION_STATUS_CONCEPT_ID IS NOT NULL  AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY CONDITION_STATUS_CONCEPT_ID ORDER BY COUNT(CONDITION_STATUS_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98050' AS TBL_ID, '9805011' AS COL_ID,  11 AS COL_SEQ FROM CONDITION_OCCURRENCE WHERE CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM CONDITION_OCCURRENCE WHERE  PROVIDER_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM CONDITION_OCCURRENCE WHERE  PROVIDER_ID IS NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM CONDITION_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PROVIDER_ID) AS AVE FROM CONDITION_OCCURRENCE WHERE  PROVIDER_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PROVIDER_ID) AS MIN_VL FROM CONDITION_OCCURRENCE WHERE  PROVIDER_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N1_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE PROVIDER_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N2_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE PROVIDER_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N3_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE PROVIDER_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PROVIDER_ID) AS N4_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE  PROVIDER_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PROVIDER_ID AS MODE_VL, COUNT(PROVIDER_ID) AS MODE_CNT FROM CONDITION_OCCURRENCE WHERE  PROVIDER_ID IS NOT NULL  AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PROVIDER_ID ORDER BY COUNT(PROVIDER_ID) DESC LIMIT 1 ) A ) K ;*/
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98050' AS TBL_ID, '9805012' AS COL_ID,  12 AS COL_SEQ FROM CONDITION_OCCURRENCE WHERE CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM CONDITION_OCCURRENCE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM CONDITION_OCCURRENCE WHERE  VISIT_OCCURRENCE_ID IS NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM CONDITION_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_OCCURRENCE_ID) AS AVE FROM CONDITION_OCCURRENCE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_OCCURRENCE_ID) AS MIN_VL FROM CONDITION_OCCURRENCE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N1_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N2_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N3_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_OCCURRENCE_ID) AS N4_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_OCCURRENCE_ID AS MODE_VL, COUNT(VISIT_OCCURRENCE_ID) AS MODE_CNT FROM CONDITION_OCCURRENCE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL  AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_OCCURRENCE_ID ORDER BY COUNT(VISIT_OCCURRENCE_ID) DESC LIMIT 1 ) A ) K ;*/
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98050' AS TBL_ID, '9805013' AS COL_ID,  13 AS COL_SEQ FROM CONDITION_OCCURRENCE WHERE CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM CONDITION_OCCURRENCE WHERE  VISIT_DETAIL_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM CONDITION_OCCURRENCE WHERE  VISIT_DETAIL_ID IS NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM CONDITION_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_DETAIL_ID) AS AVE FROM CONDITION_OCCURRENCE WHERE  VISIT_DETAIL_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_DETAIL_ID) AS MIN_VL FROM CONDITION_OCCURRENCE WHERE  VISIT_DETAIL_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N1_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE VISIT_DETAIL_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N2_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE VISIT_DETAIL_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N3_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE VISIT_DETAIL_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_DETAIL_ID) AS N4_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE  VISIT_DETAIL_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_DETAIL_ID AS MODE_VL, COUNT(VISIT_DETAIL_ID) AS MODE_CNT FROM CONDITION_OCCURRENCE WHERE  VISIT_DETAIL_ID IS NOT NULL  AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_DETAIL_ID ORDER BY COUNT(VISIT_DETAIL_ID) DESC LIMIT 1 ) A ) K ;*/
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98050' AS TBL_ID, '9805015' AS COL_ID,  15 AS COL_SEQ FROM CONDITION_OCCURRENCE WHERE CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM CONDITION_OCCURRENCE WHERE  CONDITION_SOURCE_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM CONDITION_OCCURRENCE WHERE  CONDITION_SOURCE_CONCEPT_ID IS NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM CONDITION_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(CONDITION_SOURCE_CONCEPT_ID) AS AVE FROM CONDITION_OCCURRENCE WHERE  CONDITION_SOURCE_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(CONDITION_SOURCE_CONCEPT_ID) AS MIN_VL FROM CONDITION_OCCURRENCE WHERE  CONDITION_SOURCE_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY CONDITION_SOURCE_CONCEPT_ID) AS N1_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE CONDITION_SOURCE_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY CONDITION_SOURCE_CONCEPT_ID) AS N2_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE CONDITION_SOURCE_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY CONDITION_SOURCE_CONCEPT_ID) AS N3_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE CONDITION_SOURCE_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(CONDITION_SOURCE_CONCEPT_ID) AS N4_QRTL_CNT FROM CONDITION_OCCURRENCE WHERE  CONDITION_SOURCE_CONCEPT_ID IS NOT NULL AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT CONDITION_SOURCE_CONCEPT_ID AS MODE_VL, COUNT(CONDITION_SOURCE_CONCEPT_ID) AS MODE_CNT FROM CONDITION_OCCURRENCE WHERE  CONDITION_SOURCE_CONCEPT_ID IS NOT NULL  AND CONDITION_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY CONDITION_SOURCE_CONCEPT_ID ORDER BY COUNT(CONDITION_SOURCE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98060' AS TBL_ID, '9806001' AS COL_ID,  1 AS COL_SEQ FROM DRUG_EXPOSURE WHERE DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DRUG_EXPOSURE WHERE  DRUG_EXPOSURE_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DRUG_EXPOSURE WHERE  DRUG_EXPOSURE_ID IS NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DRUG_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(DRUG_EXPOSURE_ID) AS AVE FROM DRUG_EXPOSURE WHERE  DRUG_EXPOSURE_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(DRUG_EXPOSURE_ID) AS MIN_VL FROM DRUG_EXPOSURE WHERE  DRUG_EXPOSURE_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY DRUG_EXPOSURE_ID) AS N1_QRTL_CNT FROM DRUG_EXPOSURE WHERE DRUG_EXPOSURE_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY DRUG_EXPOSURE_ID) AS N2_QRTL_CNT FROM DRUG_EXPOSURE WHERE DRUG_EXPOSURE_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY DRUG_EXPOSURE_ID) AS N3_QRTL_CNT FROM DRUG_EXPOSURE WHERE DRUG_EXPOSURE_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(DRUG_EXPOSURE_ID) AS N4_QRTL_CNT FROM DRUG_EXPOSURE WHERE  DRUG_EXPOSURE_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT DRUG_EXPOSURE_ID AS MODE_VL, COUNT(DRUG_EXPOSURE_ID) AS MODE_CNT FROM DRUG_EXPOSURE WHERE  DRUG_EXPOSURE_ID IS NOT NULL  AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY DRUG_EXPOSURE_ID ORDER BY COUNT(DRUG_EXPOSURE_ID) DESC LIMIT 1 ) A ) K ;*/
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98060' AS TBL_ID, '9806002' AS COL_ID,  2 AS COL_SEQ FROM DRUG_EXPOSURE WHERE DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DRUG_EXPOSURE WHERE  PERSON_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DRUG_EXPOSURE WHERE  PERSON_ID IS NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DRUG_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PERSON_ID) AS AVE FROM DRUG_EXPOSURE WHERE  PERSON_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PERSON_ID) AS MIN_VL FROM DRUG_EXPOSURE WHERE  PERSON_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PERSON_ID) AS N1_QRTL_CNT FROM DRUG_EXPOSURE WHERE PERSON_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PERSON_ID) AS N2_QRTL_CNT FROM DRUG_EXPOSURE WHERE PERSON_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PERSON_ID) AS N3_QRTL_CNT FROM DRUG_EXPOSURE WHERE PERSON_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PERSON_ID) AS N4_QRTL_CNT FROM DRUG_EXPOSURE WHERE  PERSON_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PERSON_ID AS MODE_VL, COUNT(PERSON_ID) AS MODE_CNT FROM DRUG_EXPOSURE WHERE  PERSON_ID IS NOT NULL  AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PERSON_ID ORDER BY COUNT(PERSON_ID) DESC LIMIT 1 ) A ) K ;*/
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98060' AS TBL_ID, '9806003' AS COL_ID,  3 AS COL_SEQ FROM DRUG_EXPOSURE WHERE DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DRUG_EXPOSURE WHERE  DRUG_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DRUG_EXPOSURE WHERE  DRUG_CONCEPT_ID IS NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DRUG_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(DRUG_CONCEPT_ID) AS AVE FROM DRUG_EXPOSURE WHERE  DRUG_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(DRUG_CONCEPT_ID) AS MIN_VL FROM DRUG_EXPOSURE WHERE  DRUG_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY DRUG_CONCEPT_ID) AS N1_QRTL_CNT FROM DRUG_EXPOSURE WHERE DRUG_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY DRUG_CONCEPT_ID) AS N2_QRTL_CNT FROM DRUG_EXPOSURE WHERE DRUG_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY DRUG_CONCEPT_ID) AS N3_QRTL_CNT FROM DRUG_EXPOSURE WHERE DRUG_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(DRUG_CONCEPT_ID) AS N4_QRTL_CNT FROM DRUG_EXPOSURE WHERE  DRUG_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT DRUG_CONCEPT_ID AS MODE_VL, COUNT(DRUG_CONCEPT_ID) AS MODE_CNT FROM DRUG_EXPOSURE WHERE  DRUG_CONCEPT_ID IS NOT NULL  AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY DRUG_CONCEPT_ID ORDER BY COUNT(DRUG_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98060' AS TBL_ID, '9806009' AS COL_ID,  9 AS COL_SEQ FROM DRUG_EXPOSURE WHERE DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DRUG_EXPOSURE WHERE  DRUG_TYPE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DRUG_EXPOSURE WHERE  DRUG_TYPE_CONCEPT_ID IS NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DRUG_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(DRUG_TYPE_CONCEPT_ID) AS AVE FROM DRUG_EXPOSURE WHERE  DRUG_TYPE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(DRUG_TYPE_CONCEPT_ID) AS MIN_VL FROM DRUG_EXPOSURE WHERE  DRUG_TYPE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY DRUG_TYPE_CONCEPT_ID) AS N1_QRTL_CNT FROM DRUG_EXPOSURE WHERE DRUG_TYPE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY DRUG_TYPE_CONCEPT_ID) AS N2_QRTL_CNT FROM DRUG_EXPOSURE WHERE DRUG_TYPE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY DRUG_TYPE_CONCEPT_ID) AS N3_QRTL_CNT FROM DRUG_EXPOSURE WHERE DRUG_TYPE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(DRUG_TYPE_CONCEPT_ID) AS N4_QRTL_CNT FROM DRUG_EXPOSURE WHERE  DRUG_TYPE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT DRUG_TYPE_CONCEPT_ID AS MODE_VL, COUNT(DRUG_TYPE_CONCEPT_ID) AS MODE_CNT FROM DRUG_EXPOSURE WHERE  DRUG_TYPE_CONCEPT_ID IS NOT NULL  AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY DRUG_TYPE_CONCEPT_ID ORDER BY COUNT(DRUG_TYPE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98060' AS TBL_ID, '9806011' AS COL_ID,  11 AS COL_SEQ FROM DRUG_EXPOSURE WHERE DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DRUG_EXPOSURE WHERE  REFILLS IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DRUG_EXPOSURE WHERE  REFILLS IS NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DRUG_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(REFILLS) AS AVE FROM DRUG_EXPOSURE WHERE  REFILLS IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(REFILLS) AS MIN_VL FROM DRUG_EXPOSURE WHERE  REFILLS IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY REFILLS) AS N1_QRTL_CNT FROM DRUG_EXPOSURE WHERE REFILLS IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY REFILLS) AS N2_QRTL_CNT FROM DRUG_EXPOSURE WHERE REFILLS IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY REFILLS) AS N3_QRTL_CNT FROM DRUG_EXPOSURE WHERE REFILLS IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(REFILLS) AS N4_QRTL_CNT FROM DRUG_EXPOSURE WHERE  REFILLS IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT REFILLS AS MODE_VL, COUNT(REFILLS) AS MODE_CNT FROM DRUG_EXPOSURE WHERE  REFILLS IS NOT NULL  AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY REFILLS ORDER BY COUNT(REFILLS) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98060' AS TBL_ID, '9806012' AS COL_ID,  12 AS COL_SEQ FROM DRUG_EXPOSURE WHERE DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DRUG_EXPOSURE WHERE  QUANTITY IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DRUG_EXPOSURE WHERE  QUANTITY IS NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DRUG_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(QUANTITY) AS AVE FROM DRUG_EXPOSURE WHERE  QUANTITY IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(QUANTITY) AS MIN_VL FROM DRUG_EXPOSURE WHERE  QUANTITY IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY QUANTITY) AS N1_QRTL_CNT FROM DRUG_EXPOSURE WHERE QUANTITY IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY QUANTITY) AS N2_QRTL_CNT FROM DRUG_EXPOSURE WHERE QUANTITY IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY QUANTITY) AS N3_QRTL_CNT FROM DRUG_EXPOSURE WHERE QUANTITY IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(QUANTITY) AS N4_QRTL_CNT FROM DRUG_EXPOSURE WHERE  QUANTITY IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT QUANTITY AS MODE_VL, COUNT(QUANTITY) AS MODE_CNT FROM DRUG_EXPOSURE WHERE  QUANTITY IS NOT NULL  AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY QUANTITY ORDER BY COUNT(QUANTITY) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98060' AS TBL_ID, '9806013' AS COL_ID,  13 AS COL_SEQ FROM DRUG_EXPOSURE WHERE DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DRUG_EXPOSURE WHERE  DAYS_SUPPLY IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DRUG_EXPOSURE WHERE  DAYS_SUPPLY IS NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DRUG_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(DAYS_SUPPLY) AS AVE FROM DRUG_EXPOSURE WHERE  DAYS_SUPPLY IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(DAYS_SUPPLY) AS MIN_VL FROM DRUG_EXPOSURE WHERE  DAYS_SUPPLY IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY DAYS_SUPPLY) AS N1_QRTL_CNT FROM DRUG_EXPOSURE WHERE DAYS_SUPPLY IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY DAYS_SUPPLY) AS N2_QRTL_CNT FROM DRUG_EXPOSURE WHERE DAYS_SUPPLY IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY DAYS_SUPPLY) AS N3_QRTL_CNT FROM DRUG_EXPOSURE WHERE DAYS_SUPPLY IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(DAYS_SUPPLY) AS N4_QRTL_CNT FROM DRUG_EXPOSURE WHERE  DAYS_SUPPLY IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT DAYS_SUPPLY AS MODE_VL, COUNT(DAYS_SUPPLY) AS MODE_CNT FROM DRUG_EXPOSURE WHERE  DAYS_SUPPLY IS NOT NULL  AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY DAYS_SUPPLY ORDER BY COUNT(DAYS_SUPPLY) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98060' AS TBL_ID, '9806015' AS COL_ID,  15 AS COL_SEQ FROM DRUG_EXPOSURE WHERE DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DRUG_EXPOSURE WHERE  ROUTE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DRUG_EXPOSURE WHERE  ROUTE_CONCEPT_ID IS NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DRUG_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(ROUTE_CONCEPT_ID) AS AVE FROM DRUG_EXPOSURE WHERE  ROUTE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(ROUTE_CONCEPT_ID) AS MIN_VL FROM DRUG_EXPOSURE WHERE  ROUTE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY ROUTE_CONCEPT_ID) AS N1_QRTL_CNT FROM DRUG_EXPOSURE WHERE ROUTE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY ROUTE_CONCEPT_ID) AS N2_QRTL_CNT FROM DRUG_EXPOSURE WHERE ROUTE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY ROUTE_CONCEPT_ID) AS N3_QRTL_CNT FROM DRUG_EXPOSURE WHERE ROUTE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(ROUTE_CONCEPT_ID) AS N4_QRTL_CNT FROM DRUG_EXPOSURE WHERE  ROUTE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT ROUTE_CONCEPT_ID AS MODE_VL, COUNT(ROUTE_CONCEPT_ID) AS MODE_CNT FROM DRUG_EXPOSURE WHERE  ROUTE_CONCEPT_ID IS NOT NULL  AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY ROUTE_CONCEPT_ID ORDER BY COUNT(ROUTE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98060' AS TBL_ID, '9806017' AS COL_ID,  17 AS COL_SEQ FROM DRUG_EXPOSURE WHERE DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DRUG_EXPOSURE WHERE  PROVIDER_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DRUG_EXPOSURE WHERE  PROVIDER_ID IS NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DRUG_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PROVIDER_ID) AS AVE FROM DRUG_EXPOSURE WHERE  PROVIDER_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PROVIDER_ID) AS MIN_VL FROM DRUG_EXPOSURE WHERE  PROVIDER_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N1_QRTL_CNT FROM DRUG_EXPOSURE WHERE PROVIDER_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N2_QRTL_CNT FROM DRUG_EXPOSURE WHERE PROVIDER_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N3_QRTL_CNT FROM DRUG_EXPOSURE WHERE PROVIDER_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PROVIDER_ID) AS N4_QRTL_CNT FROM DRUG_EXPOSURE WHERE  PROVIDER_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PROVIDER_ID AS MODE_VL, COUNT(PROVIDER_ID) AS MODE_CNT FROM DRUG_EXPOSURE WHERE  PROVIDER_ID IS NOT NULL  AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PROVIDER_ID ORDER BY COUNT(PROVIDER_ID) DESC LIMIT 1 ) A ) K ;*/
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98060' AS TBL_ID, '9806018' AS COL_ID,  18 AS COL_SEQ FROM DRUG_EXPOSURE WHERE DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DRUG_EXPOSURE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DRUG_EXPOSURE WHERE  VISIT_OCCURRENCE_ID IS NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DRUG_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_OCCURRENCE_ID) AS AVE FROM DRUG_EXPOSURE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_OCCURRENCE_ID) AS MIN_VL FROM DRUG_EXPOSURE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N1_QRTL_CNT FROM DRUG_EXPOSURE WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N2_QRTL_CNT FROM DRUG_EXPOSURE WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N3_QRTL_CNT FROM DRUG_EXPOSURE WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_OCCURRENCE_ID) AS N4_QRTL_CNT FROM DRUG_EXPOSURE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_OCCURRENCE_ID AS MODE_VL, COUNT(VISIT_OCCURRENCE_ID) AS MODE_CNT FROM DRUG_EXPOSURE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL  AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_OCCURRENCE_ID ORDER BY COUNT(VISIT_OCCURRENCE_ID) DESC LIMIT 1 ) A ) K ;*/
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98060' AS TBL_ID, '9806019' AS COL_ID,  19 AS COL_SEQ FROM DRUG_EXPOSURE WHERE DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DRUG_EXPOSURE WHERE  VISIT_DETAIL_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DRUG_EXPOSURE WHERE  VISIT_DETAIL_ID IS NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DRUG_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_DETAIL_ID) AS AVE FROM DRUG_EXPOSURE WHERE  VISIT_DETAIL_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_DETAIL_ID) AS MIN_VL FROM DRUG_EXPOSURE WHERE  VISIT_DETAIL_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N1_QRTL_CNT FROM DRUG_EXPOSURE WHERE VISIT_DETAIL_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N2_QRTL_CNT FROM DRUG_EXPOSURE WHERE VISIT_DETAIL_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N3_QRTL_CNT FROM DRUG_EXPOSURE WHERE VISIT_DETAIL_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_DETAIL_ID) AS N4_QRTL_CNT FROM DRUG_EXPOSURE WHERE  VISIT_DETAIL_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_DETAIL_ID AS MODE_VL, COUNT(VISIT_DETAIL_ID) AS MODE_CNT FROM DRUG_EXPOSURE WHERE  VISIT_DETAIL_ID IS NOT NULL  AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_DETAIL_ID ORDER BY COUNT(VISIT_DETAIL_ID) DESC LIMIT 1 ) A ) K ;*/
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98060' AS TBL_ID, '9806021' AS COL_ID,  21 AS COL_SEQ FROM DRUG_EXPOSURE WHERE DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DRUG_EXPOSURE WHERE  DRUG_SOURCE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DRUG_EXPOSURE WHERE  DRUG_SOURCE_CONCEPT_ID IS NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DRUG_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(DRUG_SOURCE_CONCEPT_ID) AS AVE FROM DRUG_EXPOSURE WHERE  DRUG_SOURCE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(DRUG_SOURCE_CONCEPT_ID) AS MIN_VL FROM DRUG_EXPOSURE WHERE  DRUG_SOURCE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY DRUG_SOURCE_CONCEPT_ID) AS N1_QRTL_CNT FROM DRUG_EXPOSURE WHERE DRUG_SOURCE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY DRUG_SOURCE_CONCEPT_ID) AS N2_QRTL_CNT FROM DRUG_EXPOSURE WHERE DRUG_SOURCE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY DRUG_SOURCE_CONCEPT_ID) AS N3_QRTL_CNT FROM DRUG_EXPOSURE WHERE DRUG_SOURCE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(DRUG_SOURCE_CONCEPT_ID) AS N4_QRTL_CNT FROM DRUG_EXPOSURE WHERE  DRUG_SOURCE_CONCEPT_ID IS NOT NULL AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT DRUG_SOURCE_CONCEPT_ID AS MODE_VL, COUNT(DRUG_SOURCE_CONCEPT_ID) AS MODE_CNT FROM DRUG_EXPOSURE WHERE  DRUG_SOURCE_CONCEPT_ID IS NOT NULL  AND DRUG_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY DRUG_SOURCE_CONCEPT_ID ORDER BY COUNT(DRUG_SOURCE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98070' AS TBL_ID, '9807001' AS COL_ID,  1 AS COL_SEQ FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_OCCURRENCE_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_OCCURRENCE_ID IS NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PROCEDURE_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PROCEDURE_OCCURRENCE_ID) AS AVE FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_OCCURRENCE_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PROCEDURE_OCCURRENCE_ID) AS MIN_VL FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_OCCURRENCE_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PROCEDURE_OCCURRENCE_ID) AS N1_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_OCCURRENCE_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PROCEDURE_OCCURRENCE_ID) AS N2_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_OCCURRENCE_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PROCEDURE_OCCURRENCE_ID) AS N3_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_OCCURRENCE_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PROCEDURE_OCCURRENCE_ID) AS N4_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_OCCURRENCE_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PROCEDURE_OCCURRENCE_ID AS MODE_VL, COUNT(PROCEDURE_OCCURRENCE_ID) AS MODE_CNT FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_OCCURRENCE_ID IS NOT NULL  AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PROCEDURE_OCCURRENCE_ID ORDER BY COUNT(PROCEDURE_OCCURRENCE_ID) DESC LIMIT 1 ) A ) K ;*/
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98070' AS TBL_ID, '9807002' AS COL_ID,  2 AS COL_SEQ FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PROCEDURE_OCCURRENCE WHERE  PERSON_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM PROCEDURE_OCCURRENCE WHERE  PERSON_ID IS NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PROCEDURE_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PERSON_ID) AS AVE FROM PROCEDURE_OCCURRENCE WHERE  PERSON_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PERSON_ID) AS MIN_VL FROM PROCEDURE_OCCURRENCE WHERE  PERSON_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PERSON_ID) AS N1_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE PERSON_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PERSON_ID) AS N2_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE PERSON_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PERSON_ID) AS N3_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE PERSON_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PERSON_ID) AS N4_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE  PERSON_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PERSON_ID AS MODE_VL, COUNT(PERSON_ID) AS MODE_CNT FROM PROCEDURE_OCCURRENCE WHERE  PERSON_ID IS NOT NULL  AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PERSON_ID ORDER BY COUNT(PERSON_ID) DESC LIMIT 1 ) A ) K ;*/
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98070' AS TBL_ID, '9807003' AS COL_ID,  3 AS COL_SEQ FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_CONCEPT_ID IS NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PROCEDURE_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PROCEDURE_CONCEPT_ID) AS AVE FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PROCEDURE_CONCEPT_ID) AS MIN_VL FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PROCEDURE_CONCEPT_ID) AS N1_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PROCEDURE_CONCEPT_ID) AS N2_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PROCEDURE_CONCEPT_ID) AS N3_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PROCEDURE_CONCEPT_ID) AS N4_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PROCEDURE_CONCEPT_ID AS MODE_VL, COUNT(PROCEDURE_CONCEPT_ID) AS MODE_CNT FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_CONCEPT_ID IS NOT NULL  AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PROCEDURE_CONCEPT_ID ORDER BY COUNT(PROCEDURE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98070' AS TBL_ID, '9807006' AS COL_ID,  6 AS COL_SEQ FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_TYPE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_TYPE_CONCEPT_ID IS NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PROCEDURE_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PROCEDURE_TYPE_CONCEPT_ID) AS AVE FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_TYPE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PROCEDURE_TYPE_CONCEPT_ID) AS MIN_VL FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_TYPE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PROCEDURE_TYPE_CONCEPT_ID) AS N1_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_TYPE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PROCEDURE_TYPE_CONCEPT_ID) AS N2_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_TYPE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PROCEDURE_TYPE_CONCEPT_ID) AS N3_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_TYPE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PROCEDURE_TYPE_CONCEPT_ID) AS N4_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_TYPE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PROCEDURE_TYPE_CONCEPT_ID AS MODE_VL, COUNT(PROCEDURE_TYPE_CONCEPT_ID) AS MODE_CNT FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_TYPE_CONCEPT_ID IS NOT NULL  AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PROCEDURE_TYPE_CONCEPT_ID ORDER BY COUNT(PROCEDURE_TYPE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98070' AS TBL_ID, '9807007' AS COL_ID,  7 AS COL_SEQ FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PROCEDURE_OCCURRENCE WHERE  MODIFIER_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM PROCEDURE_OCCURRENCE WHERE  MODIFIER_CONCEPT_ID IS NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PROCEDURE_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(MODIFIER_CONCEPT_ID) AS AVE FROM PROCEDURE_OCCURRENCE WHERE  MODIFIER_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(MODIFIER_CONCEPT_ID) AS MIN_VL FROM PROCEDURE_OCCURRENCE WHERE  MODIFIER_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY MODIFIER_CONCEPT_ID) AS N1_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE MODIFIER_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY MODIFIER_CONCEPT_ID) AS N2_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE MODIFIER_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY MODIFIER_CONCEPT_ID) AS N3_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE MODIFIER_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(MODIFIER_CONCEPT_ID) AS N4_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE  MODIFIER_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT MODIFIER_CONCEPT_ID AS MODE_VL, COUNT(MODIFIER_CONCEPT_ID) AS MODE_CNT FROM PROCEDURE_OCCURRENCE WHERE  MODIFIER_CONCEPT_ID IS NOT NULL  AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY MODIFIER_CONCEPT_ID ORDER BY COUNT(MODIFIER_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98070' AS TBL_ID, '9807008' AS COL_ID,  8 AS COL_SEQ FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PROCEDURE_OCCURRENCE WHERE  QUANTITY IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM PROCEDURE_OCCURRENCE WHERE  QUANTITY IS NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PROCEDURE_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(QUANTITY) AS AVE FROM PROCEDURE_OCCURRENCE WHERE  QUANTITY IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(QUANTITY) AS MIN_VL FROM PROCEDURE_OCCURRENCE WHERE  QUANTITY IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY QUANTITY) AS N1_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE QUANTITY IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY QUANTITY) AS N2_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE QUANTITY IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY QUANTITY) AS N3_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE QUANTITY IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(QUANTITY) AS N4_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE  QUANTITY IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT QUANTITY AS MODE_VL, COUNT(QUANTITY) AS MODE_CNT FROM PROCEDURE_OCCURRENCE WHERE  QUANTITY IS NOT NULL  AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY QUANTITY ORDER BY COUNT(QUANTITY) DESC LIMIT 1 ) A ) K ;
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98070' AS TBL_ID, '9807009' AS COL_ID,  9 AS COL_SEQ FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PROCEDURE_OCCURRENCE WHERE  PROVIDER_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM PROCEDURE_OCCURRENCE WHERE  PROVIDER_ID IS NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PROCEDURE_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PROVIDER_ID) AS AVE FROM PROCEDURE_OCCURRENCE WHERE  PROVIDER_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PROVIDER_ID) AS MIN_VL FROM PROCEDURE_OCCURRENCE WHERE  PROVIDER_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N1_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE PROVIDER_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N2_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE PROVIDER_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N3_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE PROVIDER_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PROVIDER_ID) AS N4_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE  PROVIDER_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PROVIDER_ID AS MODE_VL, COUNT(PROVIDER_ID) AS MODE_CNT FROM PROCEDURE_OCCURRENCE WHERE  PROVIDER_ID IS NOT NULL  AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PROVIDER_ID ORDER BY COUNT(PROVIDER_ID) DESC LIMIT 1 ) A ) K ;*/
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98070' AS TBL_ID, '9807010' AS COL_ID,  10 AS COL_SEQ FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PROCEDURE_OCCURRENCE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM PROCEDURE_OCCURRENCE WHERE  VISIT_OCCURRENCE_ID IS NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PROCEDURE_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_OCCURRENCE_ID) AS AVE FROM PROCEDURE_OCCURRENCE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_OCCURRENCE_ID) AS MIN_VL FROM PROCEDURE_OCCURRENCE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N1_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N2_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N3_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_OCCURRENCE_ID) AS N4_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_OCCURRENCE_ID AS MODE_VL, COUNT(VISIT_OCCURRENCE_ID) AS MODE_CNT FROM PROCEDURE_OCCURRENCE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL  AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_OCCURRENCE_ID ORDER BY COUNT(VISIT_OCCURRENCE_ID) DESC LIMIT 1 ) A ) K ;*/
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98070' AS TBL_ID, '9807011' AS COL_ID,  11 AS COL_SEQ FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PROCEDURE_OCCURRENCE WHERE  VISIT_DETAIL_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM PROCEDURE_OCCURRENCE WHERE  VISIT_DETAIL_ID IS NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PROCEDURE_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_DETAIL_ID) AS AVE FROM PROCEDURE_OCCURRENCE WHERE  VISIT_DETAIL_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_DETAIL_ID) AS MIN_VL FROM PROCEDURE_OCCURRENCE WHERE  VISIT_DETAIL_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N1_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE VISIT_DETAIL_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N2_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE VISIT_DETAIL_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N3_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE VISIT_DETAIL_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_DETAIL_ID) AS N4_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE  VISIT_DETAIL_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_DETAIL_ID AS MODE_VL, COUNT(VISIT_DETAIL_ID) AS MODE_CNT FROM PROCEDURE_OCCURRENCE WHERE  VISIT_DETAIL_ID IS NOT NULL  AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_DETAIL_ID ORDER BY COUNT(VISIT_DETAIL_ID) DESC LIMIT 1 ) A ) K ;*/
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98070' AS TBL_ID, '9807013' AS COL_ID,  13 AS COL_SEQ FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_SOURCE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_SOURCE_CONCEPT_ID IS NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PROCEDURE_OCCURRENCE WHERE PERSON_ID  IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PROCEDURE_SOURCE_CONCEPT_ID) AS AVE FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_SOURCE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PROCEDURE_SOURCE_CONCEPT_ID) AS MIN_VL FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_SOURCE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PROCEDURE_SOURCE_CONCEPT_ID) AS N1_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_SOURCE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PROCEDURE_SOURCE_CONCEPT_ID) AS N2_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_SOURCE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PROCEDURE_SOURCE_CONCEPT_ID) AS N3_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_SOURCE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PROCEDURE_SOURCE_CONCEPT_ID) AS N4_QRTL_CNT FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_SOURCE_CONCEPT_ID IS NOT NULL AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PROCEDURE_SOURCE_CONCEPT_ID AS MODE_VL, COUNT(PROCEDURE_SOURCE_CONCEPT_ID) AS MODE_CNT FROM PROCEDURE_OCCURRENCE WHERE  PROCEDURE_SOURCE_CONCEPT_ID IS NOT NULL  AND PROCEDURE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PROCEDURE_SOURCE_CONCEPT_ID ORDER BY COUNT(PROCEDURE_SOURCE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98080' AS TBL_ID, '9808001' AS COL_ID,  1 AS COL_SEQ FROM DEVICE_EXPOSURE WHERE DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DEVICE_EXPOSURE WHERE  DEVICE_EXPOSURE_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DEVICE_EXPOSURE WHERE  DEVICE_EXPOSURE_ID IS NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DEVICE_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(DEVICE_EXPOSURE_ID) AS AVE FROM DEVICE_EXPOSURE WHERE  DEVICE_EXPOSURE_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(DEVICE_EXPOSURE_ID) AS MIN_VL FROM DEVICE_EXPOSURE WHERE  DEVICE_EXPOSURE_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY DEVICE_EXPOSURE_ID) AS N1_QRTL_CNT FROM DEVICE_EXPOSURE WHERE DEVICE_EXPOSURE_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY DEVICE_EXPOSURE_ID) AS N2_QRTL_CNT FROM DEVICE_EXPOSURE WHERE DEVICE_EXPOSURE_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY DEVICE_EXPOSURE_ID) AS N3_QRTL_CNT FROM DEVICE_EXPOSURE WHERE DEVICE_EXPOSURE_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(DEVICE_EXPOSURE_ID) AS N4_QRTL_CNT FROM DEVICE_EXPOSURE WHERE  DEVICE_EXPOSURE_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT DEVICE_EXPOSURE_ID AS MODE_VL, COUNT(DEVICE_EXPOSURE_ID) AS MODE_CNT FROM DEVICE_EXPOSURE WHERE  DEVICE_EXPOSURE_ID IS NOT NULL  AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY DEVICE_EXPOSURE_ID ORDER BY COUNT(DEVICE_EXPOSURE_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98080' AS TBL_ID, '9808002' AS COL_ID,  2 AS COL_SEQ FROM DEVICE_EXPOSURE WHERE DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DEVICE_EXPOSURE WHERE  PERSON_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DEVICE_EXPOSURE WHERE  PERSON_ID IS NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DEVICE_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PERSON_ID) AS AVE FROM DEVICE_EXPOSURE WHERE  PERSON_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PERSON_ID) AS MIN_VL FROM DEVICE_EXPOSURE WHERE  PERSON_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PERSON_ID) AS N1_QRTL_CNT FROM DEVICE_EXPOSURE WHERE PERSON_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PERSON_ID) AS N2_QRTL_CNT FROM DEVICE_EXPOSURE WHERE PERSON_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PERSON_ID) AS N3_QRTL_CNT FROM DEVICE_EXPOSURE WHERE PERSON_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PERSON_ID) AS N4_QRTL_CNT FROM DEVICE_EXPOSURE WHERE  PERSON_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PERSON_ID AS MODE_VL, COUNT(PERSON_ID) AS MODE_CNT FROM DEVICE_EXPOSURE WHERE  PERSON_ID IS NOT NULL  AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PERSON_ID ORDER BY COUNT(PERSON_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98080' AS TBL_ID, '9808003' AS COL_ID,  3 AS COL_SEQ FROM DEVICE_EXPOSURE WHERE DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DEVICE_EXPOSURE WHERE  DEVICE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DEVICE_EXPOSURE WHERE  DEVICE_CONCEPT_ID IS NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DEVICE_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(DEVICE_CONCEPT_ID) AS AVE FROM DEVICE_EXPOSURE WHERE  DEVICE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(DEVICE_CONCEPT_ID) AS MIN_VL FROM DEVICE_EXPOSURE WHERE  DEVICE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY DEVICE_CONCEPT_ID) AS N1_QRTL_CNT FROM DEVICE_EXPOSURE WHERE DEVICE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY DEVICE_CONCEPT_ID) AS N2_QRTL_CNT FROM DEVICE_EXPOSURE WHERE DEVICE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY DEVICE_CONCEPT_ID) AS N3_QRTL_CNT FROM DEVICE_EXPOSURE WHERE DEVICE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(DEVICE_CONCEPT_ID) AS N4_QRTL_CNT FROM DEVICE_EXPOSURE WHERE  DEVICE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT DEVICE_CONCEPT_ID AS MODE_VL, COUNT(DEVICE_CONCEPT_ID) AS MODE_CNT FROM DEVICE_EXPOSURE WHERE  DEVICE_CONCEPT_ID IS NOT NULL  AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY DEVICE_CONCEPT_ID ORDER BY COUNT(DEVICE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98080' AS TBL_ID, '9808008' AS COL_ID,  8 AS COL_SEQ FROM DEVICE_EXPOSURE WHERE DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DEVICE_EXPOSURE WHERE  DEVICE_TYPE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DEVICE_EXPOSURE WHERE  DEVICE_TYPE_CONCEPT_ID IS NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DEVICE_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(DEVICE_TYPE_CONCEPT_ID) AS AVE FROM DEVICE_EXPOSURE WHERE  DEVICE_TYPE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(DEVICE_TYPE_CONCEPT_ID) AS MIN_VL FROM DEVICE_EXPOSURE WHERE  DEVICE_TYPE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY DEVICE_TYPE_CONCEPT_ID) AS N1_QRTL_CNT FROM DEVICE_EXPOSURE WHERE DEVICE_TYPE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY DEVICE_TYPE_CONCEPT_ID) AS N2_QRTL_CNT FROM DEVICE_EXPOSURE WHERE DEVICE_TYPE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY DEVICE_TYPE_CONCEPT_ID) AS N3_QRTL_CNT FROM DEVICE_EXPOSURE WHERE DEVICE_TYPE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(DEVICE_TYPE_CONCEPT_ID) AS N4_QRTL_CNT FROM DEVICE_EXPOSURE WHERE  DEVICE_TYPE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT DEVICE_TYPE_CONCEPT_ID AS MODE_VL, COUNT(DEVICE_TYPE_CONCEPT_ID) AS MODE_CNT FROM DEVICE_EXPOSURE WHERE  DEVICE_TYPE_CONCEPT_ID IS NOT NULL  AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY DEVICE_TYPE_CONCEPT_ID ORDER BY COUNT(DEVICE_TYPE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98080' AS TBL_ID, '9808011' AS COL_ID,  11 AS COL_SEQ FROM DEVICE_EXPOSURE WHERE DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DEVICE_EXPOSURE WHERE  QUANTITY IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DEVICE_EXPOSURE WHERE  QUANTITY IS NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DEVICE_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(QUANTITY) AS AVE FROM DEVICE_EXPOSURE WHERE  QUANTITY IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(QUANTITY) AS MIN_VL FROM DEVICE_EXPOSURE WHERE  QUANTITY IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY QUANTITY) AS N1_QRTL_CNT FROM DEVICE_EXPOSURE WHERE QUANTITY IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY QUANTITY) AS N2_QRTL_CNT FROM DEVICE_EXPOSURE WHERE QUANTITY IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY QUANTITY) AS N3_QRTL_CNT FROM DEVICE_EXPOSURE WHERE QUANTITY IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(QUANTITY) AS N4_QRTL_CNT FROM DEVICE_EXPOSURE WHERE  QUANTITY IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT QUANTITY AS MODE_VL, COUNT(QUANTITY) AS MODE_CNT FROM DEVICE_EXPOSURE WHERE  QUANTITY IS NOT NULL  AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY QUANTITY ORDER BY COUNT(QUANTITY) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98080' AS TBL_ID, '9808012' AS COL_ID,  12 AS COL_SEQ FROM DEVICE_EXPOSURE WHERE DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DEVICE_EXPOSURE WHERE  PROVIDER_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DEVICE_EXPOSURE WHERE  PROVIDER_ID IS NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DEVICE_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PROVIDER_ID) AS AVE FROM DEVICE_EXPOSURE WHERE  PROVIDER_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PROVIDER_ID) AS MIN_VL FROM DEVICE_EXPOSURE WHERE  PROVIDER_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N1_QRTL_CNT FROM DEVICE_EXPOSURE WHERE PROVIDER_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N2_QRTL_CNT FROM DEVICE_EXPOSURE WHERE PROVIDER_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N3_QRTL_CNT FROM DEVICE_EXPOSURE WHERE PROVIDER_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PROVIDER_ID) AS N4_QRTL_CNT FROM DEVICE_EXPOSURE WHERE  PROVIDER_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PROVIDER_ID AS MODE_VL, COUNT(PROVIDER_ID) AS MODE_CNT FROM DEVICE_EXPOSURE WHERE  PROVIDER_ID IS NOT NULL  AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PROVIDER_ID ORDER BY COUNT(PROVIDER_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98080' AS TBL_ID, '9808013' AS COL_ID,  13 AS COL_SEQ FROM DEVICE_EXPOSURE WHERE DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DEVICE_EXPOSURE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DEVICE_EXPOSURE WHERE  VISIT_OCCURRENCE_ID IS NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DEVICE_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_OCCURRENCE_ID) AS AVE FROM DEVICE_EXPOSURE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_OCCURRENCE_ID) AS MIN_VL FROM DEVICE_EXPOSURE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N1_QRTL_CNT FROM DEVICE_EXPOSURE WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N2_QRTL_CNT FROM DEVICE_EXPOSURE WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N3_QRTL_CNT FROM DEVICE_EXPOSURE WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_OCCURRENCE_ID) AS N4_QRTL_CNT FROM DEVICE_EXPOSURE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_OCCURRENCE_ID AS MODE_VL, COUNT(VISIT_OCCURRENCE_ID) AS MODE_CNT FROM DEVICE_EXPOSURE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL  AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_OCCURRENCE_ID ORDER BY COUNT(VISIT_OCCURRENCE_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98080' AS TBL_ID, '9808014' AS COL_ID,  14 AS COL_SEQ FROM DEVICE_EXPOSURE WHERE DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DEVICE_EXPOSURE WHERE  VISIT_DETAIL_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DEVICE_EXPOSURE WHERE  VISIT_DETAIL_ID IS NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DEVICE_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_DETAIL_ID) AS AVE FROM DEVICE_EXPOSURE WHERE  VISIT_DETAIL_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_DETAIL_ID) AS MIN_VL FROM DEVICE_EXPOSURE WHERE  VISIT_DETAIL_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N1_QRTL_CNT FROM DEVICE_EXPOSURE WHERE VISIT_DETAIL_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N2_QRTL_CNT FROM DEVICE_EXPOSURE WHERE VISIT_DETAIL_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N3_QRTL_CNT FROM DEVICE_EXPOSURE WHERE VISIT_DETAIL_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_DETAIL_ID) AS N4_QRTL_CNT FROM DEVICE_EXPOSURE WHERE  VISIT_DETAIL_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_DETAIL_ID AS MODE_VL, COUNT(VISIT_DETAIL_ID) AS MODE_CNT FROM DEVICE_EXPOSURE WHERE  VISIT_DETAIL_ID IS NOT NULL  AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_DETAIL_ID ORDER BY COUNT(VISIT_DETAIL_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98080' AS TBL_ID, '9808016' AS COL_ID,  16 AS COL_SEQ FROM DEVICE_EXPOSURE WHERE DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DEVICE_EXPOSURE WHERE  DEVICE_SOURCE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DEVICE_EXPOSURE WHERE  DEVICE_SOURCE_CONCEPT_ID IS NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DEVICE_EXPOSURE WHERE PERSON_ID  IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(DEVICE_SOURCE_CONCEPT_ID) AS AVE FROM DEVICE_EXPOSURE WHERE  DEVICE_SOURCE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(DEVICE_SOURCE_CONCEPT_ID) AS MIN_VL FROM DEVICE_EXPOSURE WHERE  DEVICE_SOURCE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY DEVICE_SOURCE_CONCEPT_ID) AS N1_QRTL_CNT FROM DEVICE_EXPOSURE WHERE DEVICE_SOURCE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY DEVICE_SOURCE_CONCEPT_ID) AS N2_QRTL_CNT FROM DEVICE_EXPOSURE WHERE DEVICE_SOURCE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY DEVICE_SOURCE_CONCEPT_ID) AS N3_QRTL_CNT FROM DEVICE_EXPOSURE WHERE DEVICE_SOURCE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(DEVICE_SOURCE_CONCEPT_ID) AS N4_QRTL_CNT FROM DEVICE_EXPOSURE WHERE  DEVICE_SOURCE_CONCEPT_ID IS NOT NULL AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT DEVICE_SOURCE_CONCEPT_ID AS MODE_VL, COUNT(DEVICE_SOURCE_CONCEPT_ID) AS MODE_CNT FROM DEVICE_EXPOSURE WHERE  DEVICE_SOURCE_CONCEPT_ID IS NOT NULL  AND DEVICE_EXPOSURE_START_DATE BETWEEN  '20100101' AND '20211231' GROUP BY DEVICE_SOURCE_CONCEPT_ID ORDER BY COUNT(DEVICE_SOURCE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98090' AS TBL_ID, '9809001' AS COL_ID,  1 AS COL_SEQ FROM MEASUREMENT WHERE MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM MEASUREMENT WHERE  MEASUREMENT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM MEASUREMENT WHERE  MEASUREMENT_ID IS NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM MEASUREMENT WHERE PERSON_ID  IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(MEASUREMENT_ID) AS AVE FROM MEASUREMENT WHERE  MEASUREMENT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(MEASUREMENT_ID) AS MIN_VL FROM MEASUREMENT WHERE  MEASUREMENT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY MEASUREMENT_ID) AS N1_QRTL_CNT FROM MEASUREMENT WHERE MEASUREMENT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY MEASUREMENT_ID) AS N2_QRTL_CNT FROM MEASUREMENT WHERE MEASUREMENT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY MEASUREMENT_ID) AS N3_QRTL_CNT FROM MEASUREMENT WHERE MEASUREMENT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(MEASUREMENT_ID) AS N4_QRTL_CNT FROM MEASUREMENT WHERE  MEASUREMENT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT MEASUREMENT_ID AS MODE_VL, COUNT(MEASUREMENT_ID) AS MODE_CNT FROM MEASUREMENT WHERE  MEASUREMENT_ID IS NOT NULL  AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' GROUP BY MEASUREMENT_ID ORDER BY COUNT(MEASUREMENT_ID) DESC LIMIT 1 ) A ) K ;*/
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98090' AS TBL_ID, '9809002' AS COL_ID,  2 AS COL_SEQ FROM MEASUREMENT WHERE MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM MEASUREMENT WHERE  PERSON_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM MEASUREMENT WHERE  PERSON_ID IS NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM MEASUREMENT WHERE PERSON_ID  IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PERSON_ID) AS AVE FROM MEASUREMENT WHERE  PERSON_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PERSON_ID) AS MIN_VL FROM MEASUREMENT WHERE  PERSON_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PERSON_ID) AS N1_QRTL_CNT FROM MEASUREMENT WHERE PERSON_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PERSON_ID) AS N2_QRTL_CNT FROM MEASUREMENT WHERE PERSON_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PERSON_ID) AS N3_QRTL_CNT FROM MEASUREMENT WHERE PERSON_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PERSON_ID) AS N4_QRTL_CNT FROM MEASUREMENT WHERE  PERSON_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PERSON_ID AS MODE_VL, COUNT(PERSON_ID) AS MODE_CNT FROM MEASUREMENT WHERE  PERSON_ID IS NOT NULL  AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PERSON_ID ORDER BY COUNT(PERSON_ID) DESC LIMIT 1 ) A ) K ;*/
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98090' AS TBL_ID, '9809003' AS COL_ID,  3 AS COL_SEQ FROM MEASUREMENT WHERE MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM MEASUREMENT WHERE  MEASUREMENT_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM MEASUREMENT WHERE  MEASUREMENT_CONCEPT_ID IS NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM MEASUREMENT WHERE PERSON_ID  IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(MEASUREMENT_CONCEPT_ID) AS AVE FROM MEASUREMENT WHERE  MEASUREMENT_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(MEASUREMENT_CONCEPT_ID) AS MIN_VL FROM MEASUREMENT WHERE  MEASUREMENT_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY MEASUREMENT_CONCEPT_ID) AS N1_QRTL_CNT FROM MEASUREMENT WHERE MEASUREMENT_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY MEASUREMENT_CONCEPT_ID) AS N2_QRTL_CNT FROM MEASUREMENT WHERE MEASUREMENT_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY MEASUREMENT_CONCEPT_ID) AS N3_QRTL_CNT FROM MEASUREMENT WHERE MEASUREMENT_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(MEASUREMENT_CONCEPT_ID) AS N4_QRTL_CNT FROM MEASUREMENT WHERE  MEASUREMENT_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT MEASUREMENT_CONCEPT_ID AS MODE_VL, COUNT(MEASUREMENT_CONCEPT_ID) AS MODE_CNT FROM MEASUREMENT WHERE  MEASUREMENT_CONCEPT_ID IS NOT NULL  AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' GROUP BY MEASUREMENT_CONCEPT_ID ORDER BY COUNT(MEASUREMENT_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98090' AS TBL_ID, '9809007' AS COL_ID,  7 AS COL_SEQ FROM MEASUREMENT WHERE MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM MEASUREMENT WHERE  MEASUREMENT_TYPE_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM MEASUREMENT WHERE  MEASUREMENT_TYPE_CONCEPT_ID IS NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM MEASUREMENT WHERE PERSON_ID  IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(MEASUREMENT_TYPE_CONCEPT_ID) AS AVE FROM MEASUREMENT WHERE  MEASUREMENT_TYPE_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(MEASUREMENT_TYPE_CONCEPT_ID) AS MIN_VL FROM MEASUREMENT WHERE  MEASUREMENT_TYPE_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY MEASUREMENT_TYPE_CONCEPT_ID) AS N1_QRTL_CNT FROM MEASUREMENT WHERE MEASUREMENT_TYPE_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY MEASUREMENT_TYPE_CONCEPT_ID) AS N2_QRTL_CNT FROM MEASUREMENT WHERE MEASUREMENT_TYPE_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY MEASUREMENT_TYPE_CONCEPT_ID) AS N3_QRTL_CNT FROM MEASUREMENT WHERE MEASUREMENT_TYPE_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(MEASUREMENT_TYPE_CONCEPT_ID) AS N4_QRTL_CNT FROM MEASUREMENT WHERE  MEASUREMENT_TYPE_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT MEASUREMENT_TYPE_CONCEPT_ID AS MODE_VL, COUNT(MEASUREMENT_TYPE_CONCEPT_ID) AS MODE_CNT FROM MEASUREMENT WHERE  MEASUREMENT_TYPE_CONCEPT_ID IS NOT NULL  AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' GROUP BY MEASUREMENT_TYPE_CONCEPT_ID ORDER BY COUNT(MEASUREMENT_TYPE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98090' AS TBL_ID, '9809008' AS COL_ID,  8 AS COL_SEQ FROM MEASUREMENT WHERE MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM MEASUREMENT WHERE  OPERATOR_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM MEASUREMENT WHERE  OPERATOR_CONCEPT_ID IS NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM MEASUREMENT WHERE PERSON_ID  IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(OPERATOR_CONCEPT_ID) AS AVE FROM MEASUREMENT WHERE  OPERATOR_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(OPERATOR_CONCEPT_ID) AS MIN_VL FROM MEASUREMENT WHERE  OPERATOR_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY OPERATOR_CONCEPT_ID) AS N1_QRTL_CNT FROM MEASUREMENT WHERE OPERATOR_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY OPERATOR_CONCEPT_ID) AS N2_QRTL_CNT FROM MEASUREMENT WHERE OPERATOR_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY OPERATOR_CONCEPT_ID) AS N3_QRTL_CNT FROM MEASUREMENT WHERE OPERATOR_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(OPERATOR_CONCEPT_ID) AS N4_QRTL_CNT FROM MEASUREMENT WHERE  OPERATOR_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT OPERATOR_CONCEPT_ID AS MODE_VL, COUNT(OPERATOR_CONCEPT_ID) AS MODE_CNT FROM MEASUREMENT WHERE  OPERATOR_CONCEPT_ID IS NOT NULL  AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' GROUP BY OPERATOR_CONCEPT_ID ORDER BY COUNT(OPERATOR_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98090' AS TBL_ID, '9809009' AS COL_ID,  9 AS COL_SEQ FROM MEASUREMENT WHERE MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM MEASUREMENT WHERE  VALUE_AS_NUMBER IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM MEASUREMENT WHERE  VALUE_AS_NUMBER IS NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM MEASUREMENT WHERE PERSON_ID  IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VALUE_AS_NUMBER) AS AVE FROM MEASUREMENT WHERE  VALUE_AS_NUMBER IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VALUE_AS_NUMBER) AS MIN_VL FROM MEASUREMENT WHERE  VALUE_AS_NUMBER IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VALUE_AS_NUMBER) AS N1_QRTL_CNT FROM MEASUREMENT WHERE VALUE_AS_NUMBER IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VALUE_AS_NUMBER) AS N2_QRTL_CNT FROM MEASUREMENT WHERE VALUE_AS_NUMBER IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VALUE_AS_NUMBER) AS N3_QRTL_CNT FROM MEASUREMENT WHERE VALUE_AS_NUMBER IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VALUE_AS_NUMBER) AS N4_QRTL_CNT FROM MEASUREMENT WHERE  VALUE_AS_NUMBER IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VALUE_AS_NUMBER AS MODE_VL, COUNT(VALUE_AS_NUMBER) AS MODE_CNT FROM MEASUREMENT WHERE  VALUE_AS_NUMBER IS NOT NULL  AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VALUE_AS_NUMBER ORDER BY COUNT(VALUE_AS_NUMBER) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98090' AS TBL_ID, '9809010' AS COL_ID,  10 AS COL_SEQ FROM MEASUREMENT WHERE MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM MEASUREMENT WHERE  VALUE_AS_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM MEASUREMENT WHERE  VALUE_AS_CONCEPT_ID IS NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM MEASUREMENT WHERE PERSON_ID  IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VALUE_AS_CONCEPT_ID) AS AVE FROM MEASUREMENT WHERE  VALUE_AS_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VALUE_AS_CONCEPT_ID) AS MIN_VL FROM MEASUREMENT WHERE  VALUE_AS_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VALUE_AS_CONCEPT_ID) AS N1_QRTL_CNT FROM MEASUREMENT WHERE VALUE_AS_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VALUE_AS_CONCEPT_ID) AS N2_QRTL_CNT FROM MEASUREMENT WHERE VALUE_AS_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VALUE_AS_CONCEPT_ID) AS N3_QRTL_CNT FROM MEASUREMENT WHERE VALUE_AS_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VALUE_AS_CONCEPT_ID) AS N4_QRTL_CNT FROM MEASUREMENT WHERE  VALUE_AS_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VALUE_AS_CONCEPT_ID AS MODE_VL, COUNT(VALUE_AS_CONCEPT_ID) AS MODE_CNT FROM MEASUREMENT WHERE  VALUE_AS_CONCEPT_ID IS NOT NULL  AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VALUE_AS_CONCEPT_ID ORDER BY COUNT(VALUE_AS_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98090' AS TBL_ID, '9809011' AS COL_ID,  11 AS COL_SEQ FROM MEASUREMENT WHERE MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM MEASUREMENT WHERE  UNIT_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM MEASUREMENT WHERE  UNIT_CONCEPT_ID IS NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM MEASUREMENT WHERE PERSON_ID  IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(UNIT_CONCEPT_ID) AS AVE FROM MEASUREMENT WHERE  UNIT_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(UNIT_CONCEPT_ID) AS MIN_VL FROM MEASUREMENT WHERE  UNIT_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY UNIT_CONCEPT_ID) AS N1_QRTL_CNT FROM MEASUREMENT WHERE UNIT_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY UNIT_CONCEPT_ID) AS N2_QRTL_CNT FROM MEASUREMENT WHERE UNIT_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY UNIT_CONCEPT_ID) AS N3_QRTL_CNT FROM MEASUREMENT WHERE UNIT_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(UNIT_CONCEPT_ID) AS N4_QRTL_CNT FROM MEASUREMENT WHERE  UNIT_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT UNIT_CONCEPT_ID AS MODE_VL, COUNT(UNIT_CONCEPT_ID) AS MODE_CNT FROM MEASUREMENT WHERE  UNIT_CONCEPT_ID IS NOT NULL  AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' GROUP BY UNIT_CONCEPT_ID ORDER BY COUNT(UNIT_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98090' AS TBL_ID, '9809012' AS COL_ID,  12 AS COL_SEQ FROM MEASUREMENT WHERE MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM MEASUREMENT WHERE  RANGE_LOW IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM MEASUREMENT WHERE  RANGE_LOW IS NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM MEASUREMENT WHERE PERSON_ID  IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(RANGE_LOW) AS AVE FROM MEASUREMENT WHERE  RANGE_LOW IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(RANGE_LOW) AS MIN_VL FROM MEASUREMENT WHERE  RANGE_LOW IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY RANGE_LOW) AS N1_QRTL_CNT FROM MEASUREMENT WHERE RANGE_LOW IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY RANGE_LOW) AS N2_QRTL_CNT FROM MEASUREMENT WHERE RANGE_LOW IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY RANGE_LOW) AS N3_QRTL_CNT FROM MEASUREMENT WHERE RANGE_LOW IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(RANGE_LOW) AS N4_QRTL_CNT FROM MEASUREMENT WHERE  RANGE_LOW IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT RANGE_LOW AS MODE_VL, COUNT(RANGE_LOW) AS MODE_CNT FROM MEASUREMENT WHERE  RANGE_LOW IS NOT NULL  AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' GROUP BY RANGE_LOW ORDER BY COUNT(RANGE_LOW) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98090' AS TBL_ID, '9809013' AS COL_ID,  13 AS COL_SEQ FROM MEASUREMENT WHERE MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM MEASUREMENT WHERE  RANGE_HIGH IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM MEASUREMENT WHERE  RANGE_HIGH IS NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM MEASUREMENT WHERE PERSON_ID  IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(RANGE_HIGH) AS AVE FROM MEASUREMENT WHERE  RANGE_HIGH IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(RANGE_HIGH) AS MIN_VL FROM MEASUREMENT WHERE  RANGE_HIGH IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY RANGE_HIGH) AS N1_QRTL_CNT FROM MEASUREMENT WHERE RANGE_HIGH IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY RANGE_HIGH) AS N2_QRTL_CNT FROM MEASUREMENT WHERE RANGE_HIGH IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY RANGE_HIGH) AS N3_QRTL_CNT FROM MEASUREMENT WHERE RANGE_HIGH IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(RANGE_HIGH) AS N4_QRTL_CNT FROM MEASUREMENT WHERE  RANGE_HIGH IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT RANGE_HIGH AS MODE_VL, COUNT(RANGE_HIGH) AS MODE_CNT FROM MEASUREMENT WHERE  RANGE_HIGH IS NOT NULL  AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' GROUP BY RANGE_HIGH ORDER BY COUNT(RANGE_HIGH) DESC LIMIT 1 ) A ) K ;
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98090' AS TBL_ID, '9809014' AS COL_ID,  14 AS COL_SEQ FROM MEASUREMENT WHERE MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM MEASUREMENT WHERE  PROVIDER_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM MEASUREMENT WHERE  PROVIDER_ID IS NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM MEASUREMENT WHERE PERSON_ID  IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PROVIDER_ID) AS AVE FROM MEASUREMENT WHERE  PROVIDER_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PROVIDER_ID) AS MIN_VL FROM MEASUREMENT WHERE  PROVIDER_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N1_QRTL_CNT FROM MEASUREMENT WHERE PROVIDER_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N2_QRTL_CNT FROM MEASUREMENT WHERE PROVIDER_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N3_QRTL_CNT FROM MEASUREMENT WHERE PROVIDER_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PROVIDER_ID) AS N4_QRTL_CNT FROM MEASUREMENT WHERE  PROVIDER_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PROVIDER_ID AS MODE_VL, COUNT(PROVIDER_ID) AS MODE_CNT FROM MEASUREMENT WHERE  PROVIDER_ID IS NOT NULL  AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PROVIDER_ID ORDER BY COUNT(PROVIDER_ID) DESC LIMIT 1 ) A ) K ;*/
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98090' AS TBL_ID, '9809015' AS COL_ID,  15 AS COL_SEQ FROM MEASUREMENT WHERE MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM MEASUREMENT WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM MEASUREMENT WHERE  VISIT_OCCURRENCE_ID IS NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM MEASUREMENT WHERE PERSON_ID  IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_OCCURRENCE_ID) AS AVE FROM MEASUREMENT WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_OCCURRENCE_ID) AS MIN_VL FROM MEASUREMENT WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N1_QRTL_CNT FROM MEASUREMENT WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N2_QRTL_CNT FROM MEASUREMENT WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N3_QRTL_CNT FROM MEASUREMENT WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_OCCURRENCE_ID) AS N4_QRTL_CNT FROM MEASUREMENT WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_OCCURRENCE_ID AS MODE_VL, COUNT(VISIT_OCCURRENCE_ID) AS MODE_CNT FROM MEASUREMENT WHERE  VISIT_OCCURRENCE_ID IS NOT NULL  AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_OCCURRENCE_ID ORDER BY COUNT(VISIT_OCCURRENCE_ID) DESC LIMIT 1 ) A ) K ;*/
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98090' AS TBL_ID, '9809016' AS COL_ID,  16 AS COL_SEQ FROM MEASUREMENT WHERE MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM MEASUREMENT WHERE  VISIT_DETAIL_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM MEASUREMENT WHERE  VISIT_DETAIL_ID IS NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM MEASUREMENT WHERE PERSON_ID  IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_DETAIL_ID) AS AVE FROM MEASUREMENT WHERE  VISIT_DETAIL_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_DETAIL_ID) AS MIN_VL FROM MEASUREMENT WHERE  VISIT_DETAIL_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N1_QRTL_CNT FROM MEASUREMENT WHERE VISIT_DETAIL_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N2_QRTL_CNT FROM MEASUREMENT WHERE VISIT_DETAIL_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N3_QRTL_CNT FROM MEASUREMENT WHERE VISIT_DETAIL_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_DETAIL_ID) AS N4_QRTL_CNT FROM MEASUREMENT WHERE  VISIT_DETAIL_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_DETAIL_ID AS MODE_VL, COUNT(VISIT_DETAIL_ID) AS MODE_CNT FROM MEASUREMENT WHERE  VISIT_DETAIL_ID IS NOT NULL  AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_DETAIL_ID ORDER BY COUNT(VISIT_DETAIL_ID) DESC LIMIT 1 ) A ) K ;*/
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98090' AS TBL_ID, '9809018' AS COL_ID,  18 AS COL_SEQ FROM MEASUREMENT WHERE MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM MEASUREMENT WHERE  MEASUREMENT_SOURCE_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM MEASUREMENT WHERE  MEASUREMENT_SOURCE_CONCEPT_ID IS NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM MEASUREMENT WHERE PERSON_ID  IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(MEASUREMENT_SOURCE_CONCEPT_ID) AS AVE FROM MEASUREMENT WHERE  MEASUREMENT_SOURCE_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(MEASUREMENT_SOURCE_CONCEPT_ID) AS MIN_VL FROM MEASUREMENT WHERE  MEASUREMENT_SOURCE_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY MEASUREMENT_SOURCE_CONCEPT_ID) AS N1_QRTL_CNT FROM MEASUREMENT WHERE MEASUREMENT_SOURCE_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY MEASUREMENT_SOURCE_CONCEPT_ID) AS N2_QRTL_CNT FROM MEASUREMENT WHERE MEASUREMENT_SOURCE_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY MEASUREMENT_SOURCE_CONCEPT_ID) AS N3_QRTL_CNT FROM MEASUREMENT WHERE MEASUREMENT_SOURCE_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(MEASUREMENT_SOURCE_CONCEPT_ID) AS N4_QRTL_CNT FROM MEASUREMENT WHERE  MEASUREMENT_SOURCE_CONCEPT_ID IS NOT NULL AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT MEASUREMENT_SOURCE_CONCEPT_ID AS MODE_VL, COUNT(MEASUREMENT_SOURCE_CONCEPT_ID) AS MODE_CNT FROM MEASUREMENT WHERE  MEASUREMENT_SOURCE_CONCEPT_ID IS NOT NULL  AND MEASUREMENT_DATE BETWEEN  '20100101' AND '20211231' GROUP BY MEASUREMENT_SOURCE_CONCEPT_ID ORDER BY COUNT(MEASUREMENT_SOURCE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98100' AS TBL_ID, '9810001' AS COL_ID,  1 AS COL_SEQ FROM OBSERVATION WHERE OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM OBSERVATION WHERE  OBSERVATION_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM OBSERVATION WHERE  OBSERVATION_ID IS NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM OBSERVATION WHERE PERSON_ID  IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(OBSERVATION_ID) AS AVE FROM OBSERVATION WHERE  OBSERVATION_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(OBSERVATION_ID) AS MIN_VL FROM OBSERVATION WHERE  OBSERVATION_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY OBSERVATION_ID) AS N1_QRTL_CNT FROM OBSERVATION WHERE OBSERVATION_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY OBSERVATION_ID) AS N2_QRTL_CNT FROM OBSERVATION WHERE OBSERVATION_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY OBSERVATION_ID) AS N3_QRTL_CNT FROM OBSERVATION WHERE OBSERVATION_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(OBSERVATION_ID) AS N4_QRTL_CNT FROM OBSERVATION WHERE  OBSERVATION_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT OBSERVATION_ID AS MODE_VL, COUNT(OBSERVATION_ID) AS MODE_CNT FROM OBSERVATION WHERE  OBSERVATION_ID IS NOT NULL  AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' GROUP BY OBSERVATION_ID ORDER BY COUNT(OBSERVATION_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98100' AS TBL_ID, '9810002' AS COL_ID,  2 AS COL_SEQ FROM OBSERVATION WHERE OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM OBSERVATION WHERE  PERSON_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM OBSERVATION WHERE  PERSON_ID IS NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM OBSERVATION WHERE PERSON_ID  IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PERSON_ID) AS AVE FROM OBSERVATION WHERE  PERSON_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PERSON_ID) AS MIN_VL FROM OBSERVATION WHERE  PERSON_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PERSON_ID) AS N1_QRTL_CNT FROM OBSERVATION WHERE PERSON_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PERSON_ID) AS N2_QRTL_CNT FROM OBSERVATION WHERE PERSON_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PERSON_ID) AS N3_QRTL_CNT FROM OBSERVATION WHERE PERSON_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PERSON_ID) AS N4_QRTL_CNT FROM OBSERVATION WHERE  PERSON_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PERSON_ID AS MODE_VL, COUNT(PERSON_ID) AS MODE_CNT FROM OBSERVATION WHERE  PERSON_ID IS NOT NULL  AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PERSON_ID ORDER BY COUNT(PERSON_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98100' AS TBL_ID, '9810003' AS COL_ID,  3 AS COL_SEQ FROM OBSERVATION WHERE OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM OBSERVATION WHERE  OBSERVATION_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM OBSERVATION WHERE  OBSERVATION_CONCEPT_ID IS NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM OBSERVATION WHERE PERSON_ID  IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(OBSERVATION_CONCEPT_ID) AS AVE FROM OBSERVATION WHERE  OBSERVATION_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(OBSERVATION_CONCEPT_ID) AS MIN_VL FROM OBSERVATION WHERE  OBSERVATION_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY OBSERVATION_CONCEPT_ID) AS N1_QRTL_CNT FROM OBSERVATION WHERE OBSERVATION_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY OBSERVATION_CONCEPT_ID) AS N2_QRTL_CNT FROM OBSERVATION WHERE OBSERVATION_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY OBSERVATION_CONCEPT_ID) AS N3_QRTL_CNT FROM OBSERVATION WHERE OBSERVATION_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(OBSERVATION_CONCEPT_ID) AS N4_QRTL_CNT FROM OBSERVATION WHERE  OBSERVATION_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT OBSERVATION_CONCEPT_ID AS MODE_VL, COUNT(OBSERVATION_CONCEPT_ID) AS MODE_CNT FROM OBSERVATION WHERE  OBSERVATION_CONCEPT_ID IS NOT NULL  AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' GROUP BY OBSERVATION_CONCEPT_ID ORDER BY COUNT(OBSERVATION_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98100' AS TBL_ID, '9810006' AS COL_ID,  6 AS COL_SEQ FROM OBSERVATION WHERE OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM OBSERVATION WHERE  OBSERVATION_TYPE_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM OBSERVATION WHERE  OBSERVATION_TYPE_CONCEPT_ID IS NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM OBSERVATION WHERE PERSON_ID  IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(OBSERVATION_TYPE_CONCEPT_ID) AS AVE FROM OBSERVATION WHERE  OBSERVATION_TYPE_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(OBSERVATION_TYPE_CONCEPT_ID) AS MIN_VL FROM OBSERVATION WHERE  OBSERVATION_TYPE_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY OBSERVATION_TYPE_CONCEPT_ID) AS N1_QRTL_CNT FROM OBSERVATION WHERE OBSERVATION_TYPE_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY OBSERVATION_TYPE_CONCEPT_ID) AS N2_QRTL_CNT FROM OBSERVATION WHERE OBSERVATION_TYPE_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY OBSERVATION_TYPE_CONCEPT_ID) AS N3_QRTL_CNT FROM OBSERVATION WHERE OBSERVATION_TYPE_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(OBSERVATION_TYPE_CONCEPT_ID) AS N4_QRTL_CNT FROM OBSERVATION WHERE  OBSERVATION_TYPE_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT OBSERVATION_TYPE_CONCEPT_ID AS MODE_VL, COUNT(OBSERVATION_TYPE_CONCEPT_ID) AS MODE_CNT FROM OBSERVATION WHERE  OBSERVATION_TYPE_CONCEPT_ID IS NOT NULL  AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' GROUP BY OBSERVATION_TYPE_CONCEPT_ID ORDER BY COUNT(OBSERVATION_TYPE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98100' AS TBL_ID, '9810007' AS COL_ID,  7 AS COL_SEQ FROM OBSERVATION WHERE OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM OBSERVATION WHERE  VALUE_AS_NUMBER IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM OBSERVATION WHERE  VALUE_AS_NUMBER IS NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM OBSERVATION WHERE PERSON_ID  IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VALUE_AS_NUMBER) AS AVE FROM OBSERVATION WHERE  VALUE_AS_NUMBER IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VALUE_AS_NUMBER) AS MIN_VL FROM OBSERVATION WHERE  VALUE_AS_NUMBER IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VALUE_AS_NUMBER) AS N1_QRTL_CNT FROM OBSERVATION WHERE VALUE_AS_NUMBER IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VALUE_AS_NUMBER) AS N2_QRTL_CNT FROM OBSERVATION WHERE VALUE_AS_NUMBER IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VALUE_AS_NUMBER) AS N3_QRTL_CNT FROM OBSERVATION WHERE VALUE_AS_NUMBER IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VALUE_AS_NUMBER) AS N4_QRTL_CNT FROM OBSERVATION WHERE  VALUE_AS_NUMBER IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VALUE_AS_NUMBER AS MODE_VL, COUNT(VALUE_AS_NUMBER) AS MODE_CNT FROM OBSERVATION WHERE  VALUE_AS_NUMBER IS NOT NULL  AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VALUE_AS_NUMBER ORDER BY COUNT(VALUE_AS_NUMBER) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98100' AS TBL_ID, '9810009' AS COL_ID,  9 AS COL_SEQ FROM OBSERVATION WHERE OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM OBSERVATION WHERE  VALUE_AS_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM OBSERVATION WHERE  VALUE_AS_CONCEPT_ID IS NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM OBSERVATION WHERE PERSON_ID  IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VALUE_AS_CONCEPT_ID) AS AVE FROM OBSERVATION WHERE  VALUE_AS_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VALUE_AS_CONCEPT_ID) AS MIN_VL FROM OBSERVATION WHERE  VALUE_AS_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VALUE_AS_CONCEPT_ID) AS N1_QRTL_CNT FROM OBSERVATION WHERE VALUE_AS_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VALUE_AS_CONCEPT_ID) AS N2_QRTL_CNT FROM OBSERVATION WHERE VALUE_AS_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VALUE_AS_CONCEPT_ID) AS N3_QRTL_CNT FROM OBSERVATION WHERE VALUE_AS_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VALUE_AS_CONCEPT_ID) AS N4_QRTL_CNT FROM OBSERVATION WHERE  VALUE_AS_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VALUE_AS_CONCEPT_ID AS MODE_VL, COUNT(VALUE_AS_CONCEPT_ID) AS MODE_CNT FROM OBSERVATION WHERE  VALUE_AS_CONCEPT_ID IS NOT NULL  AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VALUE_AS_CONCEPT_ID ORDER BY COUNT(VALUE_AS_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98100' AS TBL_ID, '9810010' AS COL_ID,  10 AS COL_SEQ FROM OBSERVATION WHERE OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM OBSERVATION WHERE  QUALIFIER_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM OBSERVATION WHERE  QUALIFIER_CONCEPT_ID IS NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM OBSERVATION WHERE PERSON_ID  IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(QUALIFIER_CONCEPT_ID) AS AVE FROM OBSERVATION WHERE  QUALIFIER_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(QUALIFIER_CONCEPT_ID) AS MIN_VL FROM OBSERVATION WHERE  QUALIFIER_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY QUALIFIER_CONCEPT_ID) AS N1_QRTL_CNT FROM OBSERVATION WHERE QUALIFIER_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY QUALIFIER_CONCEPT_ID) AS N2_QRTL_CNT FROM OBSERVATION WHERE QUALIFIER_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY QUALIFIER_CONCEPT_ID) AS N3_QRTL_CNT FROM OBSERVATION WHERE QUALIFIER_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(QUALIFIER_CONCEPT_ID) AS N4_QRTL_CNT FROM OBSERVATION WHERE  QUALIFIER_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT QUALIFIER_CONCEPT_ID AS MODE_VL, COUNT(QUALIFIER_CONCEPT_ID) AS MODE_CNT FROM OBSERVATION WHERE  QUALIFIER_CONCEPT_ID IS NOT NULL  AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' GROUP BY QUALIFIER_CONCEPT_ID ORDER BY COUNT(QUALIFIER_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;*/
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98100' AS TBL_ID, '9810011' AS COL_ID,  11 AS COL_SEQ FROM OBSERVATION WHERE OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM OBSERVATION WHERE  UNIT_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM OBSERVATION WHERE  UNIT_CONCEPT_ID IS NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM OBSERVATION WHERE PERSON_ID  IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(UNIT_CONCEPT_ID) AS AVE FROM OBSERVATION WHERE  UNIT_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(UNIT_CONCEPT_ID) AS MIN_VL FROM OBSERVATION WHERE  UNIT_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY UNIT_CONCEPT_ID) AS N1_QRTL_CNT FROM OBSERVATION WHERE UNIT_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY UNIT_CONCEPT_ID) AS N2_QRTL_CNT FROM OBSERVATION WHERE UNIT_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY UNIT_CONCEPT_ID) AS N3_QRTL_CNT FROM OBSERVATION WHERE UNIT_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(UNIT_CONCEPT_ID) AS N4_QRTL_CNT FROM OBSERVATION WHERE  UNIT_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT UNIT_CONCEPT_ID AS MODE_VL, COUNT(UNIT_CONCEPT_ID) AS MODE_CNT FROM OBSERVATION WHERE  UNIT_CONCEPT_ID IS NOT NULL  AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' GROUP BY UNIT_CONCEPT_ID ORDER BY COUNT(UNIT_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98100' AS TBL_ID, '9810012' AS COL_ID,  12 AS COL_SEQ FROM OBSERVATION WHERE OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM OBSERVATION WHERE  PROVIDER_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM OBSERVATION WHERE  PROVIDER_ID IS NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM OBSERVATION WHERE PERSON_ID  IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PROVIDER_ID) AS AVE FROM OBSERVATION WHERE  PROVIDER_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PROVIDER_ID) AS MIN_VL FROM OBSERVATION WHERE  PROVIDER_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N1_QRTL_CNT FROM OBSERVATION WHERE PROVIDER_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N2_QRTL_CNT FROM OBSERVATION WHERE PROVIDER_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N3_QRTL_CNT FROM OBSERVATION WHERE PROVIDER_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PROVIDER_ID) AS N4_QRTL_CNT FROM OBSERVATION WHERE  PROVIDER_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PROVIDER_ID AS MODE_VL, COUNT(PROVIDER_ID) AS MODE_CNT FROM OBSERVATION WHERE  PROVIDER_ID IS NOT NULL  AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PROVIDER_ID ORDER BY COUNT(PROVIDER_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98100' AS TBL_ID, '9810013' AS COL_ID,  13 AS COL_SEQ FROM OBSERVATION WHERE OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM OBSERVATION WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM OBSERVATION WHERE  VISIT_OCCURRENCE_ID IS NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM OBSERVATION WHERE PERSON_ID  IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_OCCURRENCE_ID) AS AVE FROM OBSERVATION WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_OCCURRENCE_ID) AS MIN_VL FROM OBSERVATION WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N1_QRTL_CNT FROM OBSERVATION WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N2_QRTL_CNT FROM OBSERVATION WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N3_QRTL_CNT FROM OBSERVATION WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_OCCURRENCE_ID) AS N4_QRTL_CNT FROM OBSERVATION WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_OCCURRENCE_ID AS MODE_VL, COUNT(VISIT_OCCURRENCE_ID) AS MODE_CNT FROM OBSERVATION WHERE  VISIT_OCCURRENCE_ID IS NOT NULL  AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_OCCURRENCE_ID ORDER BY COUNT(VISIT_OCCURRENCE_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98100' AS TBL_ID, '9810014' AS COL_ID,  14 AS COL_SEQ FROM OBSERVATION WHERE OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM OBSERVATION WHERE  VISIT_DETAIL_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM OBSERVATION WHERE  VISIT_DETAIL_ID IS NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM OBSERVATION WHERE PERSON_ID  IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_DETAIL_ID) AS AVE FROM OBSERVATION WHERE  VISIT_DETAIL_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_DETAIL_ID) AS MIN_VL FROM OBSERVATION WHERE  VISIT_DETAIL_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N1_QRTL_CNT FROM OBSERVATION WHERE VISIT_DETAIL_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N2_QRTL_CNT FROM OBSERVATION WHERE VISIT_DETAIL_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N3_QRTL_CNT FROM OBSERVATION WHERE VISIT_DETAIL_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_DETAIL_ID) AS N4_QRTL_CNT FROM OBSERVATION WHERE  VISIT_DETAIL_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_DETAIL_ID AS MODE_VL, COUNT(VISIT_DETAIL_ID) AS MODE_CNT FROM OBSERVATION WHERE  VISIT_DETAIL_ID IS NOT NULL  AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_DETAIL_ID ORDER BY COUNT(VISIT_DETAIL_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98100' AS TBL_ID, '9810016' AS COL_ID,  16 AS COL_SEQ FROM OBSERVATION WHERE OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM OBSERVATION WHERE  OBSERVATION_SOURCE_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM OBSERVATION WHERE  OBSERVATION_SOURCE_CONCEPT_ID IS NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM OBSERVATION WHERE PERSON_ID  IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(OBSERVATION_SOURCE_CONCEPT_ID) AS AVE FROM OBSERVATION WHERE  OBSERVATION_SOURCE_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(OBSERVATION_SOURCE_CONCEPT_ID) AS MIN_VL FROM OBSERVATION WHERE  OBSERVATION_SOURCE_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY OBSERVATION_SOURCE_CONCEPT_ID) AS N1_QRTL_CNT FROM OBSERVATION WHERE OBSERVATION_SOURCE_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY OBSERVATION_SOURCE_CONCEPT_ID) AS N2_QRTL_CNT FROM OBSERVATION WHERE OBSERVATION_SOURCE_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY OBSERVATION_SOURCE_CONCEPT_ID) AS N3_QRTL_CNT FROM OBSERVATION WHERE OBSERVATION_SOURCE_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(OBSERVATION_SOURCE_CONCEPT_ID) AS N4_QRTL_CNT FROM OBSERVATION WHERE  OBSERVATION_SOURCE_CONCEPT_ID IS NOT NULL AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT OBSERVATION_SOURCE_CONCEPT_ID AS MODE_VL, COUNT(OBSERVATION_SOURCE_CONCEPT_ID) AS MODE_CNT FROM OBSERVATION WHERE  OBSERVATION_SOURCE_CONCEPT_ID IS NOT NULL  AND OBSERVATION_DATE BETWEEN  '20100101' AND '20211231' GROUP BY OBSERVATION_SOURCE_CONCEPT_ID ORDER BY COUNT(OBSERVATION_SOURCE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98110' AS TBL_ID, '9811001' AS COL_ID,  1 AS COL_SEQ FROM DEATH WHERE DEATH_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DEATH WHERE  PERSON_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DEATH WHERE  PERSON_ID IS NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DEATH WHERE PERSON_ID  IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PERSON_ID) AS AVE FROM DEATH WHERE  PERSON_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PERSON_ID) AS MIN_VL FROM DEATH WHERE  PERSON_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PERSON_ID) AS N1_QRTL_CNT FROM DEATH WHERE PERSON_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PERSON_ID) AS N2_QRTL_CNT FROM DEATH WHERE PERSON_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PERSON_ID) AS N3_QRTL_CNT FROM DEATH WHERE PERSON_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PERSON_ID) AS N4_QRTL_CNT FROM DEATH WHERE  PERSON_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PERSON_ID AS MODE_VL, COUNT(PERSON_ID) AS MODE_CNT FROM DEATH WHERE  PERSON_ID IS NOT NULL  AND DEATH_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PERSON_ID ORDER BY COUNT(PERSON_ID) DESC LIMIT 1 ) A ) K ;*/
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98110' AS TBL_ID, '9811004' AS COL_ID,  4 AS COL_SEQ FROM DEATH WHERE DEATH_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DEATH WHERE  DEATH_TYPE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DEATH WHERE  DEATH_TYPE_CONCEPT_ID IS NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DEATH WHERE PERSON_ID  IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(DEATH_TYPE_CONCEPT_ID) AS AVE FROM DEATH WHERE  DEATH_TYPE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(DEATH_TYPE_CONCEPT_ID) AS MIN_VL FROM DEATH WHERE  DEATH_TYPE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY DEATH_TYPE_CONCEPT_ID) AS N1_QRTL_CNT FROM DEATH WHERE DEATH_TYPE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY DEATH_TYPE_CONCEPT_ID) AS N2_QRTL_CNT FROM DEATH WHERE DEATH_TYPE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY DEATH_TYPE_CONCEPT_ID) AS N3_QRTL_CNT FROM DEATH WHERE DEATH_TYPE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(DEATH_TYPE_CONCEPT_ID) AS N4_QRTL_CNT FROM DEATH WHERE  DEATH_TYPE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT DEATH_TYPE_CONCEPT_ID AS MODE_VL, COUNT(DEATH_TYPE_CONCEPT_ID) AS MODE_CNT FROM DEATH WHERE  DEATH_TYPE_CONCEPT_ID IS NOT NULL  AND DEATH_DATE BETWEEN  '20100101' AND '20211231' GROUP BY DEATH_TYPE_CONCEPT_ID ORDER BY COUNT(DEATH_TYPE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98110' AS TBL_ID, '9811005' AS COL_ID,  5 AS COL_SEQ FROM DEATH WHERE DEATH_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DEATH WHERE  CAUSE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DEATH WHERE  CAUSE_CONCEPT_ID IS NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DEATH WHERE PERSON_ID  IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(CAUSE_CONCEPT_ID) AS AVE FROM DEATH WHERE  CAUSE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(CAUSE_CONCEPT_ID) AS MIN_VL FROM DEATH WHERE  CAUSE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY CAUSE_CONCEPT_ID) AS N1_QRTL_CNT FROM DEATH WHERE CAUSE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY CAUSE_CONCEPT_ID) AS N2_QRTL_CNT FROM DEATH WHERE CAUSE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY CAUSE_CONCEPT_ID) AS N3_QRTL_CNT FROM DEATH WHERE CAUSE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(CAUSE_CONCEPT_ID) AS N4_QRTL_CNT FROM DEATH WHERE  CAUSE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT CAUSE_CONCEPT_ID AS MODE_VL, COUNT(CAUSE_CONCEPT_ID) AS MODE_CNT FROM DEATH WHERE  CAUSE_CONCEPT_ID IS NOT NULL  AND DEATH_DATE BETWEEN  '20100101' AND '20211231' GROUP BY CAUSE_CONCEPT_ID ORDER BY COUNT(CAUSE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98110' AS TBL_ID, '9811007' AS COL_ID,  7 AS COL_SEQ FROM DEATH WHERE DEATH_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM DEATH WHERE  CAUSE_SOURCE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM DEATH WHERE  CAUSE_SOURCE_CONCEPT_ID IS NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM DEATH WHERE PERSON_ID  IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(CAUSE_SOURCE_CONCEPT_ID) AS AVE FROM DEATH WHERE  CAUSE_SOURCE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(CAUSE_SOURCE_CONCEPT_ID) AS MIN_VL FROM DEATH WHERE  CAUSE_SOURCE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY CAUSE_SOURCE_CONCEPT_ID) AS N1_QRTL_CNT FROM DEATH WHERE CAUSE_SOURCE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY CAUSE_SOURCE_CONCEPT_ID) AS N2_QRTL_CNT FROM DEATH WHERE CAUSE_SOURCE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY CAUSE_SOURCE_CONCEPT_ID) AS N3_QRTL_CNT FROM DEATH WHERE CAUSE_SOURCE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(CAUSE_SOURCE_CONCEPT_ID) AS N4_QRTL_CNT FROM DEATH WHERE  CAUSE_SOURCE_CONCEPT_ID IS NOT NULL AND DEATH_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT CAUSE_SOURCE_CONCEPT_ID AS MODE_VL, COUNT(CAUSE_SOURCE_CONCEPT_ID) AS MODE_CNT FROM DEATH WHERE  CAUSE_SOURCE_CONCEPT_ID IS NOT NULL  AND DEATH_DATE BETWEEN  '20100101' AND '20211231' GROUP BY CAUSE_SOURCE_CONCEPT_ID ORDER BY COUNT(CAUSE_SOURCE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98120' AS TBL_ID, '9812001' AS COL_ID,  1 AS COL_SEQ FROM NOTE WHERE NOTE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM NOTE WHERE  NOTE_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM NOTE WHERE  NOTE_ID IS NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM NOTE WHERE PERSON_ID  IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(NOTE_ID) AS AVE FROM NOTE WHERE  NOTE_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(NOTE_ID) AS MIN_VL FROM NOTE WHERE  NOTE_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY NOTE_ID) AS N1_QRTL_CNT FROM NOTE WHERE NOTE_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY NOTE_ID) AS N2_QRTL_CNT FROM NOTE WHERE NOTE_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY NOTE_ID) AS N3_QRTL_CNT FROM NOTE WHERE NOTE_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(NOTE_ID) AS N4_QRTL_CNT FROM NOTE WHERE  NOTE_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT NOTE_ID AS MODE_VL, COUNT(NOTE_ID) AS MODE_CNT FROM NOTE WHERE  NOTE_ID IS NOT NULL  AND NOTE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY NOTE_ID ORDER BY COUNT(NOTE_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98120' AS TBL_ID, '9812002' AS COL_ID,  2 AS COL_SEQ FROM NOTE WHERE NOTE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM NOTE WHERE  PERSON_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM NOTE WHERE  PERSON_ID IS NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM NOTE WHERE PERSON_ID  IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PERSON_ID) AS AVE FROM NOTE WHERE  PERSON_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PERSON_ID) AS MIN_VL FROM NOTE WHERE  PERSON_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PERSON_ID) AS N1_QRTL_CNT FROM NOTE WHERE PERSON_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PERSON_ID) AS N2_QRTL_CNT FROM NOTE WHERE PERSON_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PERSON_ID) AS N3_QRTL_CNT FROM NOTE WHERE PERSON_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PERSON_ID) AS N4_QRTL_CNT FROM NOTE WHERE  PERSON_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PERSON_ID AS MODE_VL, COUNT(PERSON_ID) AS MODE_CNT FROM NOTE WHERE  PERSON_ID IS NOT NULL  AND NOTE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PERSON_ID ORDER BY COUNT(PERSON_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98120' AS TBL_ID, '9812005' AS COL_ID,  5 AS COL_SEQ FROM NOTE WHERE NOTE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM NOTE WHERE  NOTE_TYPE_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM NOTE WHERE  NOTE_TYPE_CONCEPT_ID IS NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM NOTE WHERE PERSON_ID  IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(NOTE_TYPE_CONCEPT_ID) AS AVE FROM NOTE WHERE  NOTE_TYPE_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(NOTE_TYPE_CONCEPT_ID) AS MIN_VL FROM NOTE WHERE  NOTE_TYPE_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY NOTE_TYPE_CONCEPT_ID) AS N1_QRTL_CNT FROM NOTE WHERE NOTE_TYPE_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY NOTE_TYPE_CONCEPT_ID) AS N2_QRTL_CNT FROM NOTE WHERE NOTE_TYPE_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY NOTE_TYPE_CONCEPT_ID) AS N3_QRTL_CNT FROM NOTE WHERE NOTE_TYPE_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(NOTE_TYPE_CONCEPT_ID) AS N4_QRTL_CNT FROM NOTE WHERE  NOTE_TYPE_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT NOTE_TYPE_CONCEPT_ID AS MODE_VL, COUNT(NOTE_TYPE_CONCEPT_ID) AS MODE_CNT FROM NOTE WHERE  NOTE_TYPE_CONCEPT_ID IS NOT NULL  AND NOTE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY NOTE_TYPE_CONCEPT_ID ORDER BY COUNT(NOTE_TYPE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98120' AS TBL_ID, '9812006' AS COL_ID,  6 AS COL_SEQ FROM NOTE WHERE NOTE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM NOTE WHERE  NOTE_CLASS_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM NOTE WHERE  NOTE_CLASS_CONCEPT_ID IS NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM NOTE WHERE PERSON_ID  IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(NOTE_CLASS_CONCEPT_ID) AS AVE FROM NOTE WHERE  NOTE_CLASS_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(NOTE_CLASS_CONCEPT_ID) AS MIN_VL FROM NOTE WHERE  NOTE_CLASS_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY NOTE_CLASS_CONCEPT_ID) AS N1_QRTL_CNT FROM NOTE WHERE NOTE_CLASS_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY NOTE_CLASS_CONCEPT_ID) AS N2_QRTL_CNT FROM NOTE WHERE NOTE_CLASS_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY NOTE_CLASS_CONCEPT_ID) AS N3_QRTL_CNT FROM NOTE WHERE NOTE_CLASS_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(NOTE_CLASS_CONCEPT_ID) AS N4_QRTL_CNT FROM NOTE WHERE  NOTE_CLASS_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT NOTE_CLASS_CONCEPT_ID AS MODE_VL, COUNT(NOTE_CLASS_CONCEPT_ID) AS MODE_CNT FROM NOTE WHERE  NOTE_CLASS_CONCEPT_ID IS NOT NULL  AND NOTE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY NOTE_CLASS_CONCEPT_ID ORDER BY COUNT(NOTE_CLASS_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98120' AS TBL_ID, '9812009' AS COL_ID,  9 AS COL_SEQ FROM NOTE WHERE NOTE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM NOTE WHERE  ENCODING_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM NOTE WHERE  ENCODING_CONCEPT_ID IS NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM NOTE WHERE PERSON_ID  IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(ENCODING_CONCEPT_ID) AS AVE FROM NOTE WHERE  ENCODING_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(ENCODING_CONCEPT_ID) AS MIN_VL FROM NOTE WHERE  ENCODING_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY ENCODING_CONCEPT_ID) AS N1_QRTL_CNT FROM NOTE WHERE ENCODING_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY ENCODING_CONCEPT_ID) AS N2_QRTL_CNT FROM NOTE WHERE ENCODING_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY ENCODING_CONCEPT_ID) AS N3_QRTL_CNT FROM NOTE WHERE ENCODING_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(ENCODING_CONCEPT_ID) AS N4_QRTL_CNT FROM NOTE WHERE  ENCODING_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT ENCODING_CONCEPT_ID AS MODE_VL, COUNT(ENCODING_CONCEPT_ID) AS MODE_CNT FROM NOTE WHERE  ENCODING_CONCEPT_ID IS NOT NULL  AND NOTE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY ENCODING_CONCEPT_ID ORDER BY COUNT(ENCODING_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98120' AS TBL_ID, '9812010' AS COL_ID,  10 AS COL_SEQ FROM NOTE WHERE NOTE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM NOTE WHERE  LANGUAGE_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM NOTE WHERE  LANGUAGE_CONCEPT_ID IS NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM NOTE WHERE PERSON_ID  IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(LANGUAGE_CONCEPT_ID) AS AVE FROM NOTE WHERE  LANGUAGE_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(LANGUAGE_CONCEPT_ID) AS MIN_VL FROM NOTE WHERE  LANGUAGE_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY LANGUAGE_CONCEPT_ID) AS N1_QRTL_CNT FROM NOTE WHERE LANGUAGE_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY LANGUAGE_CONCEPT_ID) AS N2_QRTL_CNT FROM NOTE WHERE LANGUAGE_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY LANGUAGE_CONCEPT_ID) AS N3_QRTL_CNT FROM NOTE WHERE LANGUAGE_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(LANGUAGE_CONCEPT_ID) AS N4_QRTL_CNT FROM NOTE WHERE  LANGUAGE_CONCEPT_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT LANGUAGE_CONCEPT_ID AS MODE_VL, COUNT(LANGUAGE_CONCEPT_ID) AS MODE_CNT FROM NOTE WHERE  LANGUAGE_CONCEPT_ID IS NOT NULL  AND NOTE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY LANGUAGE_CONCEPT_ID ORDER BY COUNT(LANGUAGE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98120' AS TBL_ID, '9812011' AS COL_ID,  11 AS COL_SEQ FROM NOTE WHERE NOTE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM NOTE WHERE  PROVIDER_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM NOTE WHERE  PROVIDER_ID IS NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM NOTE WHERE PERSON_ID  IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PROVIDER_ID) AS AVE FROM NOTE WHERE  PROVIDER_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PROVIDER_ID) AS MIN_VL FROM NOTE WHERE  PROVIDER_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N1_QRTL_CNT FROM NOTE WHERE PROVIDER_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N2_QRTL_CNT FROM NOTE WHERE PROVIDER_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N3_QRTL_CNT FROM NOTE WHERE PROVIDER_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PROVIDER_ID) AS N4_QRTL_CNT FROM NOTE WHERE  PROVIDER_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PROVIDER_ID AS MODE_VL, COUNT(PROVIDER_ID) AS MODE_CNT FROM NOTE WHERE  PROVIDER_ID IS NOT NULL  AND NOTE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PROVIDER_ID ORDER BY COUNT(PROVIDER_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98120' AS TBL_ID, '9812012' AS COL_ID,  12 AS COL_SEQ FROM NOTE WHERE NOTE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM NOTE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM NOTE WHERE  VISIT_OCCURRENCE_ID IS NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM NOTE WHERE PERSON_ID  IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_OCCURRENCE_ID) AS AVE FROM NOTE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_OCCURRENCE_ID) AS MIN_VL FROM NOTE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N1_QRTL_CNT FROM NOTE WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N2_QRTL_CNT FROM NOTE WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_OCCURRENCE_ID) AS N3_QRTL_CNT FROM NOTE WHERE VISIT_OCCURRENCE_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_OCCURRENCE_ID) AS N4_QRTL_CNT FROM NOTE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_OCCURRENCE_ID AS MODE_VL, COUNT(VISIT_OCCURRENCE_ID) AS MODE_CNT FROM NOTE WHERE  VISIT_OCCURRENCE_ID IS NOT NULL  AND NOTE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_OCCURRENCE_ID ORDER BY COUNT(VISIT_OCCURRENCE_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98120' AS TBL_ID, '9812013' AS COL_ID,  13 AS COL_SEQ FROM NOTE WHERE NOTE_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM NOTE WHERE  VISIT_DETAIL_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM NOTE WHERE  VISIT_DETAIL_ID IS NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM NOTE WHERE PERSON_ID  IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(VISIT_DETAIL_ID) AS AVE FROM NOTE WHERE  VISIT_DETAIL_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(VISIT_DETAIL_ID) AS MIN_VL FROM NOTE WHERE  VISIT_DETAIL_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N1_QRTL_CNT FROM NOTE WHERE VISIT_DETAIL_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N2_QRTL_CNT FROM NOTE WHERE VISIT_DETAIL_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY VISIT_DETAIL_ID) AS N3_QRTL_CNT FROM NOTE WHERE VISIT_DETAIL_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(VISIT_DETAIL_ID) AS N4_QRTL_CNT FROM NOTE WHERE  VISIT_DETAIL_ID IS NOT NULL AND NOTE_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT VISIT_DETAIL_ID AS MODE_VL, COUNT(VISIT_DETAIL_ID) AS MODE_CNT FROM NOTE WHERE  VISIT_DETAIL_ID IS NOT NULL  AND NOTE_DATE BETWEEN  '20100101' AND '20211231' GROUP BY VISIT_DETAIL_ID ORDER BY COUNT(VISIT_DETAIL_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98140' AS TBL_ID, '9814001' AS COL_ID,  1 AS COL_SEQ FROM SPECIMEN WHERE SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM SPECIMEN WHERE  SPECIMEN_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM SPECIMEN WHERE  SPECIMEN_ID IS NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM SPECIMEN WHERE PERSON_ID  IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(SPECIMEN_ID) AS AVE FROM SPECIMEN WHERE  SPECIMEN_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(SPECIMEN_ID) AS MIN_VL FROM SPECIMEN WHERE  SPECIMEN_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY SPECIMEN_ID) AS N1_QRTL_CNT FROM SPECIMEN WHERE SPECIMEN_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY SPECIMEN_ID) AS N2_QRTL_CNT FROM SPECIMEN WHERE SPECIMEN_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY SPECIMEN_ID) AS N3_QRTL_CNT FROM SPECIMEN WHERE SPECIMEN_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(SPECIMEN_ID) AS N4_QRTL_CNT FROM SPECIMEN WHERE  SPECIMEN_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT SPECIMEN_ID AS MODE_VL, COUNT(SPECIMEN_ID) AS MODE_CNT FROM SPECIMEN WHERE  SPECIMEN_ID IS NOT NULL  AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' GROUP BY SPECIMEN_ID ORDER BY COUNT(SPECIMEN_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98140' AS TBL_ID, '9814002' AS COL_ID,  2 AS COL_SEQ FROM SPECIMEN WHERE SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM SPECIMEN WHERE  PERSON_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM SPECIMEN WHERE  PERSON_ID IS NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM SPECIMEN WHERE PERSON_ID  IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(PERSON_ID) AS AVE FROM SPECIMEN WHERE  PERSON_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(PERSON_ID) AS MIN_VL FROM SPECIMEN WHERE  PERSON_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PERSON_ID) AS N1_QRTL_CNT FROM SPECIMEN WHERE PERSON_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PERSON_ID) AS N2_QRTL_CNT FROM SPECIMEN WHERE PERSON_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PERSON_ID) AS N3_QRTL_CNT FROM SPECIMEN WHERE PERSON_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(PERSON_ID) AS N4_QRTL_CNT FROM SPECIMEN WHERE  PERSON_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PERSON_ID AS MODE_VL, COUNT(PERSON_ID) AS MODE_CNT FROM SPECIMEN WHERE  PERSON_ID IS NOT NULL  AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' GROUP BY PERSON_ID ORDER BY COUNT(PERSON_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98140' AS TBL_ID, '9814003' AS COL_ID,  3 AS COL_SEQ FROM SPECIMEN WHERE SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM SPECIMEN WHERE  SPECIMEN_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM SPECIMEN WHERE  SPECIMEN_CONCEPT_ID IS NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM SPECIMEN WHERE PERSON_ID  IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(SPECIMEN_CONCEPT_ID) AS AVE FROM SPECIMEN WHERE  SPECIMEN_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(SPECIMEN_CONCEPT_ID) AS MIN_VL FROM SPECIMEN WHERE  SPECIMEN_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY SPECIMEN_CONCEPT_ID) AS N1_QRTL_CNT FROM SPECIMEN WHERE SPECIMEN_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY SPECIMEN_CONCEPT_ID) AS N2_QRTL_CNT FROM SPECIMEN WHERE SPECIMEN_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY SPECIMEN_CONCEPT_ID) AS N3_QRTL_CNT FROM SPECIMEN WHERE SPECIMEN_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(SPECIMEN_CONCEPT_ID) AS N4_QRTL_CNT FROM SPECIMEN WHERE  SPECIMEN_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT SPECIMEN_CONCEPT_ID AS MODE_VL, COUNT(SPECIMEN_CONCEPT_ID) AS MODE_CNT FROM SPECIMEN WHERE  SPECIMEN_CONCEPT_ID IS NOT NULL  AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' GROUP BY SPECIMEN_CONCEPT_ID ORDER BY COUNT(SPECIMEN_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98140' AS TBL_ID, '9814004' AS COL_ID,  4 AS COL_SEQ FROM SPECIMEN WHERE SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM SPECIMEN WHERE  SPECIMEN_TYPE_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM SPECIMEN WHERE  SPECIMEN_TYPE_CONCEPT_ID IS NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM SPECIMEN WHERE PERSON_ID  IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(SPECIMEN_TYPE_CONCEPT_ID) AS AVE FROM SPECIMEN WHERE  SPECIMEN_TYPE_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(SPECIMEN_TYPE_CONCEPT_ID) AS MIN_VL FROM SPECIMEN WHERE  SPECIMEN_TYPE_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY SPECIMEN_TYPE_CONCEPT_ID) AS N1_QRTL_CNT FROM SPECIMEN WHERE SPECIMEN_TYPE_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY SPECIMEN_TYPE_CONCEPT_ID) AS N2_QRTL_CNT FROM SPECIMEN WHERE SPECIMEN_TYPE_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY SPECIMEN_TYPE_CONCEPT_ID) AS N3_QRTL_CNT FROM SPECIMEN WHERE SPECIMEN_TYPE_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(SPECIMEN_TYPE_CONCEPT_ID) AS N4_QRTL_CNT FROM SPECIMEN WHERE  SPECIMEN_TYPE_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT SPECIMEN_TYPE_CONCEPT_ID AS MODE_VL, COUNT(SPECIMEN_TYPE_CONCEPT_ID) AS MODE_CNT FROM SPECIMEN WHERE  SPECIMEN_TYPE_CONCEPT_ID IS NOT NULL  AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' GROUP BY SPECIMEN_TYPE_CONCEPT_ID ORDER BY COUNT(SPECIMEN_TYPE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98140' AS TBL_ID, '9814007' AS COL_ID,  7 AS COL_SEQ FROM SPECIMEN WHERE SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM SPECIMEN WHERE  QUANTITY IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM SPECIMEN WHERE  QUANTITY IS NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM SPECIMEN WHERE PERSON_ID  IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(QUANTITY) AS AVE FROM SPECIMEN WHERE  QUANTITY IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(QUANTITY) AS MIN_VL FROM SPECIMEN WHERE  QUANTITY IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY QUANTITY) AS N1_QRTL_CNT FROM SPECIMEN WHERE QUANTITY IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY QUANTITY) AS N2_QRTL_CNT FROM SPECIMEN WHERE QUANTITY IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY QUANTITY) AS N3_QRTL_CNT FROM SPECIMEN WHERE QUANTITY IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(QUANTITY) AS N4_QRTL_CNT FROM SPECIMEN WHERE  QUANTITY IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT QUANTITY AS MODE_VL, COUNT(QUANTITY) AS MODE_CNT FROM SPECIMEN WHERE  QUANTITY IS NOT NULL  AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' GROUP BY QUANTITY ORDER BY COUNT(QUANTITY) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98140' AS TBL_ID, '9814008' AS COL_ID,  8 AS COL_SEQ FROM SPECIMEN WHERE SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM SPECIMEN WHERE  UNIT_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM SPECIMEN WHERE  UNIT_CONCEPT_ID IS NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM SPECIMEN WHERE PERSON_ID  IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(UNIT_CONCEPT_ID) AS AVE FROM SPECIMEN WHERE  UNIT_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(UNIT_CONCEPT_ID) AS MIN_VL FROM SPECIMEN WHERE  UNIT_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY UNIT_CONCEPT_ID) AS N1_QRTL_CNT FROM SPECIMEN WHERE UNIT_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY UNIT_CONCEPT_ID) AS N2_QRTL_CNT FROM SPECIMEN WHERE UNIT_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY UNIT_CONCEPT_ID) AS N3_QRTL_CNT FROM SPECIMEN WHERE UNIT_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(UNIT_CONCEPT_ID) AS N4_QRTL_CNT FROM SPECIMEN WHERE  UNIT_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT UNIT_CONCEPT_ID AS MODE_VL, COUNT(UNIT_CONCEPT_ID) AS MODE_CNT FROM SPECIMEN WHERE  UNIT_CONCEPT_ID IS NOT NULL  AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' GROUP BY UNIT_CONCEPT_ID ORDER BY COUNT(UNIT_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98140' AS TBL_ID, '9814009' AS COL_ID,  9 AS COL_SEQ FROM SPECIMEN WHERE SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM SPECIMEN WHERE  ANATOMIC_SITE_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM SPECIMEN WHERE  ANATOMIC_SITE_CONCEPT_ID IS NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM SPECIMEN WHERE PERSON_ID  IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(ANATOMIC_SITE_CONCEPT_ID) AS AVE FROM SPECIMEN WHERE  ANATOMIC_SITE_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(ANATOMIC_SITE_CONCEPT_ID) AS MIN_VL FROM SPECIMEN WHERE  ANATOMIC_SITE_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY ANATOMIC_SITE_CONCEPT_ID) AS N1_QRTL_CNT FROM SPECIMEN WHERE ANATOMIC_SITE_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY ANATOMIC_SITE_CONCEPT_ID) AS N2_QRTL_CNT FROM SPECIMEN WHERE ANATOMIC_SITE_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY ANATOMIC_SITE_CONCEPT_ID) AS N3_QRTL_CNT FROM SPECIMEN WHERE ANATOMIC_SITE_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(ANATOMIC_SITE_CONCEPT_ID) AS N4_QRTL_CNT FROM SPECIMEN WHERE  ANATOMIC_SITE_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT ANATOMIC_SITE_CONCEPT_ID AS MODE_VL, COUNT(ANATOMIC_SITE_CONCEPT_ID) AS MODE_CNT FROM SPECIMEN WHERE  ANATOMIC_SITE_CONCEPT_ID IS NOT NULL  AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' GROUP BY ANATOMIC_SITE_CONCEPT_ID ORDER BY COUNT(ANATOMIC_SITE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT ,TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98140' AS TBL_ID, '9814010' AS COL_ID,  10 AS COL_SEQ FROM SPECIMEN WHERE SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM SPECIMEN WHERE  DISEASE_STATUS_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM SPECIMEN WHERE  DISEASE_STATUS_CONCEPT_ID IS NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM SPECIMEN WHERE PERSON_ID  IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' ) D  ,(SELECT SUM(DISEASE_STATUS_CONCEPT_ID) AS AVE FROM SPECIMEN WHERE  DISEASE_STATUS_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(DISEASE_STATUS_CONCEPT_ID) AS MIN_VL FROM SPECIMEN WHERE  DISEASE_STATUS_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY DISEASE_STATUS_CONCEPT_ID) AS N1_QRTL_CNT FROM SPECIMEN WHERE DISEASE_STATUS_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY DISEASE_STATUS_CONCEPT_ID) AS N2_QRTL_CNT FROM SPECIMEN WHERE DISEASE_STATUS_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY DISEASE_STATUS_CONCEPT_ID) AS N3_QRTL_CNT FROM SPECIMEN WHERE DISEASE_STATUS_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(DISEASE_STATUS_CONCEPT_ID) AS N4_QRTL_CNT FROM SPECIMEN WHERE  DISEASE_STATUS_CONCEPT_ID IS NOT NULL AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT DISEASE_STATUS_CONCEPT_ID AS MODE_VL, COUNT(DISEASE_STATUS_CONCEPT_ID) AS MODE_CNT FROM SPECIMEN WHERE  DISEASE_STATUS_CONCEPT_ID IS NOT NULL  AND SPECIMEN_DATE BETWEEN  '20100101' AND '20211231' GROUP BY DISEASE_STATUS_CONCEPT_ID ORDER BY COUNT(DISEASE_STATUS_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,NULL,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT , TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98130' AS TBL_ID, '9813001' AS COL_ID,  1 AS COL_SEQ FROM NOTE_NLP WHERE NLP_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM NOTE_NLP WHERE  NOTE_NLP_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM NOTE_NLP WHERE  NOTE_NLP_ID IS NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') C   ,(SELECT SUM(NOTE_NLP_ID) AS AVE FROM NOTE_NLP WHERE  NOTE_NLP_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(NOTE_NLP_ID) AS MIN_VL FROM NOTE_NLP WHERE  NOTE_NLP_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY NOTE_NLP_ID) AS N1_QRTL_CNT FROM NOTE_NLP WHERE NOTE_NLP_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY NOTE_NLP_ID) AS N2_QRTL_CNT FROM NOTE_NLP WHERE NOTE_NLP_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY NOTE_NLP_ID) AS N3_QRTL_CNT FROM NOTE_NLP WHERE NOTE_NLP_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(NOTE_NLP_ID) AS N4_QRTL_CNT FROM NOTE_NLP WHERE  NOTE_NLP_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT NOTE_NLP_ID AS MODE_VL, COUNT(NOTE_NLP_ID) AS MODE_CNT FROM NOTE_NLP WHERE  NOTE_NLP_ID IS NOT NULL  AND NLP_DATE BETWEEN  '20100101' AND '20211231' GROUP BY NOTE_NLP_ID ORDER BY COUNT(NOTE_NLP_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,NULL,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT , TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98130' AS TBL_ID, '9813002' AS COL_ID,  2 AS COL_SEQ FROM NOTE_NLP WHERE NLP_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM NOTE_NLP WHERE  NOTE_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM NOTE_NLP WHERE  NOTE_ID IS NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') C   ,(SELECT SUM(NOTE_ID) AS AVE FROM NOTE_NLP WHERE  NOTE_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(NOTE_ID) AS MIN_VL FROM NOTE_NLP WHERE  NOTE_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY NOTE_ID) AS N1_QRTL_CNT FROM NOTE_NLP WHERE NOTE_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY NOTE_ID) AS N2_QRTL_CNT FROM NOTE_NLP WHERE NOTE_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY NOTE_ID) AS N3_QRTL_CNT FROM NOTE_NLP WHERE NOTE_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(NOTE_ID) AS N4_QRTL_CNT FROM NOTE_NLP WHERE  NOTE_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT NOTE_ID AS MODE_VL, COUNT(NOTE_ID) AS MODE_CNT FROM NOTE_NLP WHERE  NOTE_ID IS NOT NULL  AND NLP_DATE BETWEEN  '20100101' AND '20211231' GROUP BY NOTE_ID ORDER BY COUNT(NOTE_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,NULL,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT , TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98130' AS TBL_ID, '9813003' AS COL_ID,  3 AS COL_SEQ FROM NOTE_NLP WHERE NLP_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM NOTE_NLP WHERE  SECTION_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM NOTE_NLP WHERE  SECTION_CONCEPT_ID IS NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') C   ,(SELECT SUM(SECTION_CONCEPT_ID) AS AVE FROM NOTE_NLP WHERE  SECTION_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(SECTION_CONCEPT_ID) AS MIN_VL FROM NOTE_NLP WHERE  SECTION_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY SECTION_CONCEPT_ID) AS N1_QRTL_CNT FROM NOTE_NLP WHERE SECTION_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY SECTION_CONCEPT_ID) AS N2_QRTL_CNT FROM NOTE_NLP WHERE SECTION_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY SECTION_CONCEPT_ID) AS N3_QRTL_CNT FROM NOTE_NLP WHERE SECTION_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(SECTION_CONCEPT_ID) AS N4_QRTL_CNT FROM NOTE_NLP WHERE  SECTION_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT SECTION_CONCEPT_ID AS MODE_VL, COUNT(SECTION_CONCEPT_ID) AS MODE_CNT FROM NOTE_NLP WHERE  SECTION_CONCEPT_ID IS NOT NULL  AND NLP_DATE BETWEEN  '20100101' AND '20211231' GROUP BY SECTION_CONCEPT_ID ORDER BY COUNT(SECTION_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,NULL,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT , TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98130' AS TBL_ID, '9813007' AS COL_ID,  7 AS COL_SEQ FROM NOTE_NLP WHERE NLP_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM NOTE_NLP WHERE  NOTE_NLP_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM NOTE_NLP WHERE  NOTE_NLP_CONCEPT_ID IS NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') C   ,(SELECT SUM(NOTE_NLP_CONCEPT_ID) AS AVE FROM NOTE_NLP WHERE  NOTE_NLP_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(NOTE_NLP_CONCEPT_ID) AS MIN_VL FROM NOTE_NLP WHERE  NOTE_NLP_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY NOTE_NLP_CONCEPT_ID) AS N1_QRTL_CNT FROM NOTE_NLP WHERE NOTE_NLP_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY NOTE_NLP_CONCEPT_ID) AS N2_QRTL_CNT FROM NOTE_NLP WHERE NOTE_NLP_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY NOTE_NLP_CONCEPT_ID) AS N3_QRTL_CNT FROM NOTE_NLP WHERE NOTE_NLP_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(NOTE_NLP_CONCEPT_ID) AS N4_QRTL_CNT FROM NOTE_NLP WHERE  NOTE_NLP_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT NOTE_NLP_CONCEPT_ID AS MODE_VL, COUNT(NOTE_NLP_CONCEPT_ID) AS MODE_CNT FROM NOTE_NLP WHERE  NOTE_NLP_CONCEPT_ID IS NOT NULL  AND NLP_DATE BETWEEN  '20100101' AND '20211231' GROUP BY NOTE_NLP_CONCEPT_ID ORDER BY COUNT(NOTE_NLP_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,NULL,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT , TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'20100101' AS COLL_STRT_YMD,'20211231'  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98130' AS TBL_ID, '9813008' AS COL_ID,  8 AS COL_SEQ FROM NOTE_NLP WHERE NLP_DATE BETWEEN  '20100101' AND '20211231' )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM NOTE_NLP WHERE  NOTE_NLP_SOURCE_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') B  ,(SELECT COUNT(*) AS NULL_NCS FROM NOTE_NLP WHERE  NOTE_NLP_SOURCE_CONCEPT_ID IS NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') C   ,(SELECT SUM(NOTE_NLP_SOURCE_CONCEPT_ID) AS AVE FROM NOTE_NLP WHERE  NOTE_NLP_SOURCE_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') E   ,(SELECT MIN(NOTE_NLP_SOURCE_CONCEPT_ID) AS MIN_VL FROM NOTE_NLP WHERE  NOTE_NLP_SOURCE_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY NOTE_NLP_SOURCE_CONCEPT_ID) AS N1_QRTL_CNT FROM NOTE_NLP WHERE NOTE_NLP_SOURCE_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY NOTE_NLP_SOURCE_CONCEPT_ID) AS N2_QRTL_CNT FROM NOTE_NLP WHERE NOTE_NLP_SOURCE_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY NOTE_NLP_SOURCE_CONCEPT_ID) AS N3_QRTL_CNT FROM NOTE_NLP WHERE NOTE_NLP_SOURCE_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') A ) I  ,(SELECT MAX(NOTE_NLP_SOURCE_CONCEPT_ID) AS N4_QRTL_CNT FROM NOTE_NLP WHERE  NOTE_NLP_SOURCE_CONCEPT_ID IS NOT NULL AND NLP_DATE BETWEEN  '20100101' AND '20211231') J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT NOTE_NLP_SOURCE_CONCEPT_ID AS MODE_VL, COUNT(NOTE_NLP_SOURCE_CONCEPT_ID) AS MODE_CNT FROM NOTE_NLP WHERE  NOTE_NLP_SOURCE_CONCEPT_ID IS NOT NULL  AND NLP_DATE BETWEEN  '20100101' AND '20211231' GROUP BY NOTE_NLP_SOURCE_CONCEPT_ID ORDER BY COUNT(NOTE_NLP_SOURCE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT , TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'' AS COLL_STRT_YMD,''  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98010' AS TBL_ID, '9801001' AS COL_ID,  1 AS COL_SEQ FROM PERSON )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PERSON WHERE  PERSON_ID IS NOT NULL ) B  ,(SELECT COUNT(*) AS NULL_NCS FROM PERSON WHERE  PERSON_ID IS NULL ) C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PERSON WHERE PERSON_ID  IS NOT NULL  ) D  ,(SELECT SUM(PERSON_ID) AS AVE FROM PERSON WHERE  PERSON_ID IS NOT NULL ) E   ,(SELECT MIN(PERSON_ID) AS MIN_VL FROM PERSON WHERE  PERSON_ID IS NOT NULL ) F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PERSON_ID) AS N1_QRTL_CNT FROM PERSON WHERE PERSON_ID IS NOT NULL ) A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PERSON_ID) AS N2_QRTL_CNT FROM PERSON WHERE PERSON_ID IS NOT NULL ) A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PERSON_ID) AS N3_QRTL_CNT FROM PERSON WHERE PERSON_ID IS NOT NULL ) A ) I  ,(SELECT MAX(PERSON_ID) AS N4_QRTL_CNT FROM PERSON WHERE  PERSON_ID IS NOT NULL ) J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PERSON_ID AS MODE_VL, COUNT(PERSON_ID) AS MODE_CNT FROM PERSON WHERE  PERSON_ID IS NOT NULL  GROUP BY PERSON_ID ORDER BY COUNT(PERSON_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT , TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'' AS COLL_STRT_YMD,''  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98010' AS TBL_ID, '9801002' AS COL_ID,  2 AS COL_SEQ FROM PERSON )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PERSON WHERE  GENDER_CONCEPT_ID IS NOT NULL ) B  ,(SELECT COUNT(*) AS NULL_NCS FROM PERSON WHERE  GENDER_CONCEPT_ID IS NULL ) C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PERSON WHERE PERSON_ID  IS NOT NULL  ) D  ,(SELECT SUM(GENDER_CONCEPT_ID) AS AVE FROM PERSON WHERE  GENDER_CONCEPT_ID IS NOT NULL ) E   ,(SELECT MIN(GENDER_CONCEPT_ID) AS MIN_VL FROM PERSON WHERE  GENDER_CONCEPT_ID IS NOT NULL ) F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY GENDER_CONCEPT_ID) AS N1_QRTL_CNT FROM PERSON WHERE GENDER_CONCEPT_ID IS NOT NULL ) A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY GENDER_CONCEPT_ID) AS N2_QRTL_CNT FROM PERSON WHERE GENDER_CONCEPT_ID IS NOT NULL ) A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY GENDER_CONCEPT_ID) AS N3_QRTL_CNT FROM PERSON WHERE GENDER_CONCEPT_ID IS NOT NULL ) A ) I  ,(SELECT MAX(GENDER_CONCEPT_ID) AS N4_QRTL_CNT FROM PERSON WHERE  GENDER_CONCEPT_ID IS NOT NULL ) J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT GENDER_CONCEPT_ID AS MODE_VL, COUNT(GENDER_CONCEPT_ID) AS MODE_CNT FROM PERSON WHERE  GENDER_CONCEPT_ID IS NOT NULL  GROUP BY GENDER_CONCEPT_ID ORDER BY COUNT(GENDER_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT , TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'' AS COLL_STRT_YMD,''  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98010' AS TBL_ID, '9801003' AS COL_ID,  3 AS COL_SEQ FROM PERSON )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PERSON WHERE  YEAR_OF_BIRTH IS NOT NULL ) B  ,(SELECT COUNT(*) AS NULL_NCS FROM PERSON WHERE  YEAR_OF_BIRTH IS NULL ) C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PERSON WHERE PERSON_ID  IS NOT NULL  ) D  ,(SELECT SUM(YEAR_OF_BIRTH) AS AVE FROM PERSON WHERE  YEAR_OF_BIRTH IS NOT NULL ) E   ,(SELECT MIN(YEAR_OF_BIRTH) AS MIN_VL FROM PERSON WHERE  YEAR_OF_BIRTH IS NOT NULL ) F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY YEAR_OF_BIRTH) AS N1_QRTL_CNT FROM PERSON WHERE YEAR_OF_BIRTH IS NOT NULL ) A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY YEAR_OF_BIRTH) AS N2_QRTL_CNT FROM PERSON WHERE YEAR_OF_BIRTH IS NOT NULL ) A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY YEAR_OF_BIRTH) AS N3_QRTL_CNT FROM PERSON WHERE YEAR_OF_BIRTH IS NOT NULL ) A ) I  ,(SELECT MAX(YEAR_OF_BIRTH) AS N4_QRTL_CNT FROM PERSON WHERE  YEAR_OF_BIRTH IS NOT NULL ) J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT YEAR_OF_BIRTH AS MODE_VL, COUNT(YEAR_OF_BIRTH) AS MODE_CNT FROM PERSON WHERE  YEAR_OF_BIRTH IS NOT NULL  GROUP BY YEAR_OF_BIRTH ORDER BY COUNT(YEAR_OF_BIRTH) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT , TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'' AS COLL_STRT_YMD,''  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98010' AS TBL_ID, '9801004' AS COL_ID,  4 AS COL_SEQ FROM PERSON )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PERSON WHERE  MONTH_OF_BIRTH IS NOT NULL ) B  ,(SELECT COUNT(*) AS NULL_NCS FROM PERSON WHERE  MONTH_OF_BIRTH IS NULL ) C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PERSON WHERE PERSON_ID  IS NOT NULL  ) D  ,(SELECT SUM(MONTH_OF_BIRTH) AS AVE FROM PERSON WHERE  MONTH_OF_BIRTH IS NOT NULL ) E   ,(SELECT MIN(MONTH_OF_BIRTH) AS MIN_VL FROM PERSON WHERE  MONTH_OF_BIRTH IS NOT NULL ) F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY MONTH_OF_BIRTH) AS N1_QRTL_CNT FROM PERSON WHERE MONTH_OF_BIRTH IS NOT NULL ) A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY MONTH_OF_BIRTH) AS N2_QRTL_CNT FROM PERSON WHERE MONTH_OF_BIRTH IS NOT NULL ) A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY MONTH_OF_BIRTH) AS N3_QRTL_CNT FROM PERSON WHERE MONTH_OF_BIRTH IS NOT NULL ) A ) I  ,(SELECT MAX(MONTH_OF_BIRTH) AS N4_QRTL_CNT FROM PERSON WHERE  MONTH_OF_BIRTH IS NOT NULL ) J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT MONTH_OF_BIRTH AS MODE_VL, COUNT(MONTH_OF_BIRTH) AS MODE_CNT FROM PERSON WHERE  MONTH_OF_BIRTH IS NOT NULL  GROUP BY MONTH_OF_BIRTH ORDER BY COUNT(MONTH_OF_BIRTH) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT , TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'' AS COLL_STRT_YMD,''  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98010' AS TBL_ID, '9801005' AS COL_ID,  5 AS COL_SEQ FROM PERSON )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PERSON WHERE  DAY_OF_BIRTH IS NOT NULL ) B  ,(SELECT COUNT(*) AS NULL_NCS FROM PERSON WHERE  DAY_OF_BIRTH IS NULL ) C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PERSON WHERE PERSON_ID  IS NOT NULL  ) D  ,(SELECT SUM(DAY_OF_BIRTH) AS AVE FROM PERSON WHERE  DAY_OF_BIRTH IS NOT NULL ) E   ,(SELECT MIN(DAY_OF_BIRTH) AS MIN_VL FROM PERSON WHERE  DAY_OF_BIRTH IS NOT NULL ) F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY DAY_OF_BIRTH) AS N1_QRTL_CNT FROM PERSON WHERE DAY_OF_BIRTH IS NOT NULL ) A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY DAY_OF_BIRTH) AS N2_QRTL_CNT FROM PERSON WHERE DAY_OF_BIRTH IS NOT NULL ) A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY DAY_OF_BIRTH) AS N3_QRTL_CNT FROM PERSON WHERE DAY_OF_BIRTH IS NOT NULL ) A ) I  ,(SELECT MAX(DAY_OF_BIRTH) AS N4_QRTL_CNT FROM PERSON WHERE  DAY_OF_BIRTH IS NOT NULL ) J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT DAY_OF_BIRTH AS MODE_VL, COUNT(DAY_OF_BIRTH) AS MODE_CNT FROM PERSON WHERE  DAY_OF_BIRTH IS NOT NULL  GROUP BY DAY_OF_BIRTH ORDER BY COUNT(DAY_OF_BIRTH) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT , TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'' AS COLL_STRT_YMD,''  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98010' AS TBL_ID, '9801007' AS COL_ID,  7 AS COL_SEQ FROM PERSON )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PERSON WHERE  RACE_CONCEPT_ID IS NOT NULL ) B  ,(SELECT COUNT(*) AS NULL_NCS FROM PERSON WHERE  RACE_CONCEPT_ID IS NULL ) C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PERSON WHERE PERSON_ID  IS NOT NULL  ) D  ,(SELECT SUM(RACE_CONCEPT_ID) AS AVE FROM PERSON WHERE  RACE_CONCEPT_ID IS NOT NULL ) E   ,(SELECT MIN(RACE_CONCEPT_ID) AS MIN_VL FROM PERSON WHERE  RACE_CONCEPT_ID IS NOT NULL ) F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY RACE_CONCEPT_ID) AS N1_QRTL_CNT FROM PERSON WHERE RACE_CONCEPT_ID IS NOT NULL ) A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY RACE_CONCEPT_ID) AS N2_QRTL_CNT FROM PERSON WHERE RACE_CONCEPT_ID IS NOT NULL ) A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY RACE_CONCEPT_ID) AS N3_QRTL_CNT FROM PERSON WHERE RACE_CONCEPT_ID IS NOT NULL ) A ) I  ,(SELECT MAX(RACE_CONCEPT_ID) AS N4_QRTL_CNT FROM PERSON WHERE  RACE_CONCEPT_ID IS NOT NULL ) J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT RACE_CONCEPT_ID AS MODE_VL, COUNT(RACE_CONCEPT_ID) AS MODE_CNT FROM PERSON WHERE  RACE_CONCEPT_ID IS NOT NULL  GROUP BY RACE_CONCEPT_ID ORDER BY COUNT(RACE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT , TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'' AS COLL_STRT_YMD,''  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98010' AS TBL_ID, '9801008' AS COL_ID,  8 AS COL_SEQ FROM PERSON )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PERSON WHERE  ETHNICITY_CONCEPT_ID IS NOT NULL ) B  ,(SELECT COUNT(*) AS NULL_NCS FROM PERSON WHERE  ETHNICITY_CONCEPT_ID IS NULL ) C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PERSON WHERE PERSON_ID  IS NOT NULL  ) D  ,(SELECT SUM(ETHNICITY_CONCEPT_ID) AS AVE FROM PERSON WHERE  ETHNICITY_CONCEPT_ID IS NOT NULL ) E   ,(SELECT MIN(ETHNICITY_CONCEPT_ID) AS MIN_VL FROM PERSON WHERE  ETHNICITY_CONCEPT_ID IS NOT NULL ) F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY ETHNICITY_CONCEPT_ID) AS N1_QRTL_CNT FROM PERSON WHERE ETHNICITY_CONCEPT_ID IS NOT NULL ) A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY ETHNICITY_CONCEPT_ID) AS N2_QRTL_CNT FROM PERSON WHERE ETHNICITY_CONCEPT_ID IS NOT NULL ) A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY ETHNICITY_CONCEPT_ID) AS N3_QRTL_CNT FROM PERSON WHERE ETHNICITY_CONCEPT_ID IS NOT NULL ) A ) I  ,(SELECT MAX(ETHNICITY_CONCEPT_ID) AS N4_QRTL_CNT FROM PERSON WHERE  ETHNICITY_CONCEPT_ID IS NOT NULL ) J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT ETHNICITY_CONCEPT_ID AS MODE_VL, COUNT(ETHNICITY_CONCEPT_ID) AS MODE_CNT FROM PERSON WHERE  ETHNICITY_CONCEPT_ID IS NOT NULL  GROUP BY ETHNICITY_CONCEPT_ID ORDER BY COUNT(ETHNICITY_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT , TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'' AS COLL_STRT_YMD,''  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98010' AS TBL_ID, '9801009' AS COL_ID,  9 AS COL_SEQ FROM PERSON )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PERSON WHERE  LOCATION_ID IS NOT NULL ) B  ,(SELECT COUNT(*) AS NULL_NCS FROM PERSON WHERE  LOCATION_ID IS NULL ) C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PERSON WHERE PERSON_ID  IS NOT NULL  ) D  ,(SELECT SUM(LOCATION_ID) AS AVE FROM PERSON WHERE  LOCATION_ID IS NOT NULL ) E   ,(SELECT MIN(LOCATION_ID) AS MIN_VL FROM PERSON WHERE  LOCATION_ID IS NOT NULL ) F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY LOCATION_ID) AS N1_QRTL_CNT FROM PERSON WHERE LOCATION_ID IS NOT NULL ) A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY LOCATION_ID) AS N2_QRTL_CNT FROM PERSON WHERE LOCATION_ID IS NOT NULL ) A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY LOCATION_ID) AS N3_QRTL_CNT FROM PERSON WHERE LOCATION_ID IS NOT NULL ) A ) I  ,(SELECT MAX(LOCATION_ID) AS N4_QRTL_CNT FROM PERSON WHERE  LOCATION_ID IS NOT NULL ) J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT LOCATION_ID AS MODE_VL, COUNT(LOCATION_ID) AS MODE_CNT FROM PERSON WHERE  LOCATION_ID IS NOT NULL  GROUP BY LOCATION_ID ORDER BY COUNT(LOCATION_ID) DESC LIMIT 1 ) A ) K ;
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT , TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'' AS COLL_STRT_YMD,''  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98010' AS TBL_ID, '9801010' AS COL_ID,  10 AS COL_SEQ FROM PERSON )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PERSON WHERE  PROVIDER_ID IS NOT NULL ) B  ,(SELECT COUNT(*) AS NULL_NCS FROM PERSON WHERE  PROVIDER_ID IS NULL ) C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PERSON WHERE PERSON_ID  IS NOT NULL  ) D  ,(SELECT SUM(PROVIDER_ID) AS AVE FROM PERSON WHERE  PROVIDER_ID IS NOT NULL ) E   ,(SELECT MIN(PROVIDER_ID) AS MIN_VL FROM PERSON WHERE  PROVIDER_ID IS NOT NULL ) F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N1_QRTL_CNT FROM PERSON WHERE PROVIDER_ID IS NOT NULL ) A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N2_QRTL_CNT FROM PERSON WHERE PROVIDER_ID IS NOT NULL ) A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY PROVIDER_ID) AS N3_QRTL_CNT FROM PERSON WHERE PROVIDER_ID IS NOT NULL ) A ) I  ,(SELECT MAX(PROVIDER_ID) AS N4_QRTL_CNT FROM PERSON WHERE  PROVIDER_ID IS NOT NULL ) J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT PROVIDER_ID AS MODE_VL, COUNT(PROVIDER_ID) AS MODE_CNT FROM PERSON WHERE  PROVIDER_ID IS NOT NULL  GROUP BY PROVIDER_ID ORDER BY COUNT(PROVIDER_ID) DESC LIMIT 1 ) A ) K ;*/
/*INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT , TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'' AS COLL_STRT_YMD,''  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98010' AS TBL_ID, '9801011' AS COL_ID,  11 AS COL_SEQ FROM PERSON )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PERSON WHERE  CARE_SITE_ID IS NOT NULL ) B  ,(SELECT COUNT(*) AS NULL_NCS FROM PERSON WHERE  CARE_SITE_ID IS NULL ) C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PERSON WHERE PERSON_ID  IS NOT NULL  ) D  ,(SELECT SUM(CARE_SITE_ID) AS AVE FROM PERSON WHERE  CARE_SITE_ID IS NOT NULL ) E   ,(SELECT MIN(CARE_SITE_ID) AS MIN_VL FROM PERSON WHERE  CARE_SITE_ID IS NOT NULL ) F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY CARE_SITE_ID) AS N1_QRTL_CNT FROM PERSON WHERE CARE_SITE_ID IS NOT NULL ) A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY CARE_SITE_ID) AS N2_QRTL_CNT FROM PERSON WHERE CARE_SITE_ID IS NOT NULL ) A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY CARE_SITE_ID) AS N3_QRTL_CNT FROM PERSON WHERE CARE_SITE_ID IS NOT NULL ) A ) I  ,(SELECT MAX(CARE_SITE_ID) AS N4_QRTL_CNT FROM PERSON WHERE  CARE_SITE_ID IS NOT NULL ) J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT CARE_SITE_ID AS MODE_VL, COUNT(CARE_SITE_ID) AS MODE_CNT FROM PERSON WHERE  CARE_SITE_ID IS NOT NULL  GROUP BY CARE_SITE_ID ORDER BY COUNT(CARE_SITE_ID) DESC LIMIT 1 ) A ) K ;*/
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT , TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'' AS COLL_STRT_YMD,''  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98010' AS TBL_ID, '9801014' AS COL_ID,  14 AS COL_SEQ FROM PERSON )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PERSON WHERE  GENDER_SOURCE_CONCEPT_ID IS NOT NULL ) B  ,(SELECT COUNT(*) AS NULL_NCS FROM PERSON WHERE  GENDER_SOURCE_CONCEPT_ID IS NULL ) C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PERSON WHERE PERSON_ID  IS NOT NULL  ) D  ,(SELECT SUM(GENDER_SOURCE_CONCEPT_ID) AS AVE FROM PERSON WHERE  GENDER_SOURCE_CONCEPT_ID IS NOT NULL ) E   ,(SELECT MIN(GENDER_SOURCE_CONCEPT_ID) AS MIN_VL FROM PERSON WHERE  GENDER_SOURCE_CONCEPT_ID IS NOT NULL ) F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY GENDER_SOURCE_CONCEPT_ID) AS N1_QRTL_CNT FROM PERSON WHERE GENDER_SOURCE_CONCEPT_ID IS NOT NULL ) A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY GENDER_SOURCE_CONCEPT_ID) AS N2_QRTL_CNT FROM PERSON WHERE GENDER_SOURCE_CONCEPT_ID IS NOT NULL ) A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY GENDER_SOURCE_CONCEPT_ID) AS N3_QRTL_CNT FROM PERSON WHERE GENDER_SOURCE_CONCEPT_ID IS NOT NULL ) A ) I  ,(SELECT MAX(GENDER_SOURCE_CONCEPT_ID) AS N4_QRTL_CNT FROM PERSON WHERE  GENDER_SOURCE_CONCEPT_ID IS NOT NULL ) J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT GENDER_SOURCE_CONCEPT_ID AS MODE_VL, COUNT(GENDER_SOURCE_CONCEPT_ID) AS MODE_CNT FROM PERSON WHERE  GENDER_SOURCE_CONCEPT_ID IS NOT NULL  GROUP BY GENDER_SOURCE_CONCEPT_ID ORDER BY COUNT(GENDER_SOURCE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT , TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'' AS COLL_STRT_YMD,''  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98010' AS TBL_ID, '9801016' AS COL_ID,  16 AS COL_SEQ FROM PERSON )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PERSON WHERE  RACE_SOURCE_CONCEPT_ID IS NOT NULL ) B  ,(SELECT COUNT(*) AS NULL_NCS FROM PERSON WHERE  RACE_SOURCE_CONCEPT_ID IS NULL ) C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PERSON WHERE PERSON_ID  IS NOT NULL  ) D  ,(SELECT SUM(RACE_SOURCE_CONCEPT_ID) AS AVE FROM PERSON WHERE  RACE_SOURCE_CONCEPT_ID IS NOT NULL ) E   ,(SELECT MIN(RACE_SOURCE_CONCEPT_ID) AS MIN_VL FROM PERSON WHERE  RACE_SOURCE_CONCEPT_ID IS NOT NULL ) F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY RACE_SOURCE_CONCEPT_ID) AS N1_QRTL_CNT FROM PERSON WHERE RACE_SOURCE_CONCEPT_ID IS NOT NULL ) A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY RACE_SOURCE_CONCEPT_ID) AS N2_QRTL_CNT FROM PERSON WHERE RACE_SOURCE_CONCEPT_ID IS NOT NULL ) A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY RACE_SOURCE_CONCEPT_ID) AS N3_QRTL_CNT FROM PERSON WHERE RACE_SOURCE_CONCEPT_ID IS NOT NULL ) A ) I  ,(SELECT MAX(RACE_SOURCE_CONCEPT_ID) AS N4_QRTL_CNT FROM PERSON WHERE  RACE_SOURCE_CONCEPT_ID IS NOT NULL ) J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT RACE_SOURCE_CONCEPT_ID AS MODE_VL, COUNT(RACE_SOURCE_CONCEPT_ID) AS MODE_CNT FROM PERSON WHERE  RACE_SOURCE_CONCEPT_ID IS NOT NULL  GROUP BY RACE_SOURCE_CONCEPT_ID ORDER BY COUNT(RACE_SOURCE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
INSERT INTO CNCR_TBL_COL_DTRN_STATS (HOSP_CD ,TBL_ID ,COL_ID ,COL_SEQ ,ROW_CNT ,NULL_NCS ,PT_CNT ,AVE_VL,MIN_VL ,N1_QRTL_CNT ,N2_QRTL_CNT ,N3_QRTL_CNT ,N4_QRTL_CNT ,MODE_VL ,STATS_WORK_YMD ,COLL_STRT_YMD ,COLL_END_YMD,CRTN_DT ) SELECT A.HOSP_CD ,A.TBL_ID ,A.COL_ID ,A.COL_SEQ ,B.ROW_CNT ,C.NULL_NCS ,D.PT_CNT,E.AVE / ROW_CNT ,F.MIN_VL   ,G.N1_QRTL_CNT ,H.N2_QRTL_CNT ,I.N3_QRTL_CNT ,J.N4_QRTL_CNT,K.MODE_CNT , TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS STATS_WORK_YMD  ,'' AS COLL_STRT_YMD,''  AS COLL_END_YMD ,CURRENT_TIMESTAMP AS CRTN_DT  FROM (SELECT DISTINCT '9999' AS HOSP_CD,'98010' AS TBL_ID, '9801018' AS COL_ID,  18 AS COL_SEQ FROM PERSON )  A  ,(SELECT COUNT(*) AS ROW_CNT FROM PERSON WHERE  ETHNICITY_SOURCE_CONCEPT_ID IS NOT NULL ) B  ,(SELECT COUNT(*) AS NULL_NCS FROM PERSON WHERE  ETHNICITY_SOURCE_CONCEPT_ID IS NULL ) C  ,(SELECT COUNT(DISTINCT PERSON_ID) AS PT_CNT FROM PERSON WHERE PERSON_ID  IS NOT NULL  ) D  ,(SELECT SUM(ETHNICITY_SOURCE_CONCEPT_ID) AS AVE FROM PERSON WHERE  ETHNICITY_SOURCE_CONCEPT_ID IS NOT NULL ) E   ,(SELECT MIN(ETHNICITY_SOURCE_CONCEPT_ID) AS MIN_VL FROM PERSON WHERE  ETHNICITY_SOURCE_CONCEPT_ID IS NOT NULL ) F   ,(SELECT SUM(A.N1_QRTL_CNT) AS N1_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.25) WITHIN GROUP (ORDER BY ETHNICITY_SOURCE_CONCEPT_ID) AS N1_QRTL_CNT FROM PERSON WHERE ETHNICITY_SOURCE_CONCEPT_ID IS NOT NULL ) A ) G  ,(SELECT SUM(A.N2_QRTL_CNT) AS N2_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.50) WITHIN GROUP (ORDER BY ETHNICITY_SOURCE_CONCEPT_ID) AS N2_QRTL_CNT FROM PERSON WHERE ETHNICITY_SOURCE_CONCEPT_ID IS NOT NULL ) A ) H  ,(SELECT SUM(A.N3_QRTL_CNT) AS N3_QRTL_CNT  FROM (SELECT PERCENTILE_DISC(0.75) WITHIN GROUP (ORDER BY ETHNICITY_SOURCE_CONCEPT_ID) AS N3_QRTL_CNT FROM PERSON WHERE ETHNICITY_SOURCE_CONCEPT_ID IS NOT NULL ) A ) I  ,(SELECT MAX(ETHNICITY_SOURCE_CONCEPT_ID) AS N4_QRTL_CNT FROM PERSON WHERE  ETHNICITY_SOURCE_CONCEPT_ID IS NOT NULL ) J   ,(SELECT A.MODE_CNT AS MODE_CNT FROM (SELECT ETHNICITY_SOURCE_CONCEPT_ID AS MODE_VL, COUNT(ETHNICITY_SOURCE_CONCEPT_ID) AS MODE_CNT FROM PERSON WHERE  ETHNICITY_SOURCE_CONCEPT_ID IS NOT NULL  GROUP BY ETHNICITY_SOURCE_CONCEPT_ID ORDER BY COUNT(ETHNICITY_SOURCE_CONCEPT_ID) DESC LIMIT 1 ) A ) K ;
