SET SESSION group_concat_max_len = 1000000;

insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11010' as tbl_id, '1101004' as col_id,  4 as col_seq from brcn_pt_hlinf where adm_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_pt_hlinf where  hlinf_seq is not null and adm_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_pt_hlinf where  hlinf_seq is null and adm_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_pt_hlinf where pt_sbst_no  is not null and adm_ymd between  '20100101' and '20211231' ) d; 							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11020' as tbl_id, '1102004' as col_id,  4 as col_seq from brcn_pt_fmht where fmht_rcrd_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_pt_fmht where  fmht_rcrd_seq is not null and fmht_rcrd_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_pt_fmht where  fmht_rcrd_seq is null and fmht_rcrd_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_pt_fmht where pt_sbst_no  is not null and fmht_rcrd_ymd between  '20100101' and '20211231' ) d; 							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11030' as tbl_id, '1103004' as col_id,  4 as col_seq from brcn_pt_obinf where obtr_rcrd_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_pt_obinf where  obtr_rcrd_seq is not null and obtr_rcrd_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_pt_obinf where  obtr_rcrd_seq is null and obtr_rcrd_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_pt_obinf where pt_sbst_no  is not null and obtr_rcrd_ymd between  '20100101' and '20211231' ) d; 							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11030' as tbl_id, '1103011' as col_id,  11 as col_seq from brcn_pt_obinf where obtr_rcrd_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_pt_obinf where  hrt_impl_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_pt_obinf where  hrt_impl_mcnt is null and obtr_rcrd_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_pt_obinf where pt_sbst_no  is not null and obtr_rcrd_ymd between  '20100101' and '20211231' ) d 	,(select sum(hrt_impl_mcnt) as ave from brcn_pt_obinf where  hrt_impl_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') e  	,(select min(hrt_impl_mcnt) as min_vl from brcn_pt_obinf where  hrt_impl_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(hrt_impl_mcnt order by hrt_impl_mcnt separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_pt_obinf where hrt_impl_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(hrt_impl_mcnt order by hrt_impl_mcnt separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_pt_obinf where hrt_impl_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(hrt_impl_mcnt order by hrt_impl_mcnt separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_pt_obinf where hrt_impl_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) i 	,(select max(hrt_impl_mcnt) as n4_qrtl_cnt from brcn_pt_obinf where  hrt_impl_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select hrt_impl_mcnt as mode_vl, count(hrt_impl_mcnt) as mode_cnt from brcn_pt_obinf where  hrt_impl_mcnt is not null  and obtr_rcrd_ymd between  '20100101' and '20211231' group by hrt_impl_mcnt ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11030' as tbl_id, '1103012' as col_id,  12 as col_seq from brcn_pt_obinf where obtr_rcrd_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_pt_obinf where  mena_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_pt_obinf where  mena_age_vl is null and obtr_rcrd_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_pt_obinf where pt_sbst_no  is not null and obtr_rcrd_ymd between  '20100101' and '20211231' ) d 	,(select sum(mena_age_vl) as ave from brcn_pt_obinf where  mena_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') e  	,(select min(mena_age_vl) as min_vl from brcn_pt_obinf where  mena_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(mena_age_vl order by mena_age_vl separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_pt_obinf where mena_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(mena_age_vl order by mena_age_vl separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_pt_obinf where mena_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(mena_age_vl order by mena_age_vl separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_pt_obinf where mena_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) i 	,(select max(mena_age_vl) as n4_qrtl_cnt from brcn_pt_obinf where  mena_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select mena_age_vl as mode_vl, count(mena_age_vl) as mode_cnt from brcn_pt_obinf where  mena_age_vl is not null  and obtr_rcrd_ymd between  '20100101' and '20211231' group by mena_age_vl ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11030' as tbl_id, '1103013' as col_id,  13 as col_seq from brcn_pt_obinf where obtr_rcrd_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_pt_obinf where  delv_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_pt_obinf where  delv_age_vl is null and obtr_rcrd_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_pt_obinf where pt_sbst_no  is not null and obtr_rcrd_ymd between  '20100101' and '20211231' ) d 	,(select sum(delv_age_vl) as ave from brcn_pt_obinf where  delv_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') e  	,(select min(delv_age_vl) as min_vl from brcn_pt_obinf where  delv_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(delv_age_vl order by delv_age_vl separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_pt_obinf where delv_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(delv_age_vl order by delv_age_vl separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_pt_obinf where delv_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(delv_age_vl order by delv_age_vl separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_pt_obinf where delv_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) i 	,(select max(delv_age_vl) as n4_qrtl_cnt from brcn_pt_obinf where  delv_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select delv_age_vl as mode_vl, count(delv_age_vl) as mode_cnt from brcn_pt_obinf where  delv_age_vl is not null  and obtr_rcrd_ymd between  '20100101' and '20211231' group by delv_age_vl ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11030' as tbl_id, '1103014' as col_id,  14 as col_seq from brcn_pt_obinf where obtr_rcrd_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_pt_obinf where  delv_chld_cnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_pt_obinf where  delv_chld_cnt is null and obtr_rcrd_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_pt_obinf where pt_sbst_no  is not null and obtr_rcrd_ymd between  '20100101' and '20211231' ) d 	,(select sum(delv_chld_cnt) as ave from brcn_pt_obinf where  delv_chld_cnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') e  	,(select min(delv_chld_cnt) as min_vl from brcn_pt_obinf where  delv_chld_cnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(delv_chld_cnt order by delv_chld_cnt separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_pt_obinf where delv_chld_cnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(delv_chld_cnt order by delv_chld_cnt separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_pt_obinf where delv_chld_cnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(delv_chld_cnt order by delv_chld_cnt separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_pt_obinf where delv_chld_cnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) i 	,(select max(delv_chld_cnt) as n4_qrtl_cnt from brcn_pt_obinf where  delv_chld_cnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select delv_chld_cnt as mode_vl, count(delv_chld_cnt) as mode_cnt from brcn_pt_obinf where  delv_chld_cnt is not null  and obtr_rcrd_ymd between  '20100101' and '20211231' group by delv_chld_cnt ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11030' as tbl_id, '1103017' as col_id,  17 as col_seq from brcn_pt_obinf where obtr_rcrd_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_pt_obinf where  brfd_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_pt_obinf where  brfd_mcnt is null and obtr_rcrd_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_pt_obinf where pt_sbst_no  is not null and obtr_rcrd_ymd between  '20100101' and '20211231' ) d 	,(select sum(brfd_mcnt) as ave from brcn_pt_obinf where  brfd_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') e  	,(select min(brfd_mcnt) as min_vl from brcn_pt_obinf where  brfd_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(brfd_mcnt order by brfd_mcnt separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_pt_obinf where brfd_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(brfd_mcnt order by brfd_mcnt separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_pt_obinf where brfd_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(brfd_mcnt order by brfd_mcnt separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_pt_obinf where brfd_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) i 	,(select max(brfd_mcnt) as n4_qrtl_cnt from brcn_pt_obinf where  brfd_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select brfd_mcnt as mode_vl, count(brfd_mcnt) as mode_cnt from brcn_pt_obinf where  brfd_mcnt is not null  and obtr_rcrd_ymd between  '20100101' and '20211231' group by brfd_mcnt ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11030' as tbl_id, '1103020' as col_id,  20 as col_seq from brcn_pt_obinf where obtr_rcrd_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_pt_obinf where  oc_use_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_pt_obinf where  oc_use_mcnt is null and obtr_rcrd_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_pt_obinf where pt_sbst_no  is not null and obtr_rcrd_ymd between  '20100101' and '20211231' ) d 	,(select sum(oc_use_mcnt) as ave from brcn_pt_obinf where  oc_use_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') e  	,(select min(oc_use_mcnt) as min_vl from brcn_pt_obinf where  oc_use_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(oc_use_mcnt order by oc_use_mcnt separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_pt_obinf where oc_use_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(oc_use_mcnt order by oc_use_mcnt separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_pt_obinf where oc_use_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(oc_use_mcnt order by oc_use_mcnt separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_pt_obinf where oc_use_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) i 	,(select max(oc_use_mcnt) as n4_qrtl_cnt from brcn_pt_obinf where  oc_use_mcnt is not null and obtr_rcrd_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select oc_use_mcnt as mode_vl, count(oc_use_mcnt) as mode_cnt from brcn_pt_obinf where  oc_use_mcnt is not null  and obtr_rcrd_ymd between  '20100101' and '20211231' group by oc_use_mcnt ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11030' as tbl_id, '1103023' as col_id,  23 as col_seq from brcn_pt_obinf where obtr_rcrd_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_pt_obinf where  meno_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_pt_obinf where  meno_age_vl is null and obtr_rcrd_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_pt_obinf where pt_sbst_no  is not null and obtr_rcrd_ymd between  '20100101' and '20211231' ) d 	,(select sum(meno_age_vl) as ave from brcn_pt_obinf where  meno_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') e  	,(select min(meno_age_vl) as min_vl from brcn_pt_obinf where  meno_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(meno_age_vl order by meno_age_vl separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_pt_obinf where meno_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(meno_age_vl order by meno_age_vl separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_pt_obinf where meno_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(meno_age_vl order by meno_age_vl separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_pt_obinf where meno_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') a) i 	,(select max(meno_age_vl) as n4_qrtl_cnt from brcn_pt_obinf where  meno_age_vl is not null and obtr_rcrd_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select meno_age_vl as mode_vl, count(meno_age_vl) as mode_cnt from brcn_pt_obinf where  meno_age_vl is not null  and obtr_rcrd_ymd between  '20100101' and '20211231' group by meno_age_vl ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11040' as tbl_id, '1104004' as col_id,  4 as col_seq from brcn_diag_aninf where anth_rcrd_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_diag_aninf where  anth_rcrd_seq is not null and anth_rcrd_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_diag_aninf where  anth_rcrd_seq is null and anth_rcrd_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_diag_aninf where pt_sbst_no  is not null and anth_rcrd_ymd between  '20100101' and '20211231' ) d; 							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11040' as tbl_id, '1104005' as col_id,  5 as col_seq from brcn_diag_aninf where anth_rcrd_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_diag_aninf where  ht_msrm_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_diag_aninf where  ht_msrm_vl is null and anth_rcrd_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_diag_aninf where pt_sbst_no  is not null and anth_rcrd_ymd between  '20100101' and '20211231' ) d 	,(select sum(ht_msrm_vl) as ave from brcn_diag_aninf where  ht_msrm_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') e  	,(select min(ht_msrm_vl) as min_vl from brcn_diag_aninf where  ht_msrm_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(ht_msrm_vl order by ht_msrm_vl separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_diag_aninf where ht_msrm_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(ht_msrm_vl order by ht_msrm_vl separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_diag_aninf where ht_msrm_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(ht_msrm_vl order by ht_msrm_vl separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_diag_aninf where ht_msrm_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') a) i 	,(select max(ht_msrm_vl) as n4_qrtl_cnt from brcn_diag_aninf where  ht_msrm_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select ht_msrm_vl as mode_vl, count(ht_msrm_vl) as mode_cnt from brcn_diag_aninf where  ht_msrm_vl is not null  and anth_rcrd_ymd between  '20100101' and '20211231' group by ht_msrm_vl ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11040' as tbl_id, '1104006' as col_id,  6 as col_seq from brcn_diag_aninf where anth_rcrd_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_diag_aninf where  wt_msrm_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_diag_aninf where  wt_msrm_vl is null and anth_rcrd_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_diag_aninf where pt_sbst_no  is not null and anth_rcrd_ymd between  '20100101' and '20211231' ) d 	,(select sum(wt_msrm_vl) as ave from brcn_diag_aninf where  wt_msrm_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') e  	,(select min(wt_msrm_vl) as min_vl from brcn_diag_aninf where  wt_msrm_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(wt_msrm_vl order by wt_msrm_vl separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_diag_aninf where wt_msrm_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(wt_msrm_vl order by wt_msrm_vl separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_diag_aninf where wt_msrm_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(wt_msrm_vl order by wt_msrm_vl separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_diag_aninf where wt_msrm_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') a) i 	,(select max(wt_msrm_vl) as n4_qrtl_cnt from brcn_diag_aninf where  wt_msrm_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select wt_msrm_vl as mode_vl, count(wt_msrm_vl) as mode_cnt from brcn_diag_aninf where  wt_msrm_vl is not null  and anth_rcrd_ymd between  '20100101' and '20211231' group by wt_msrm_vl ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11040' as tbl_id, '1104007' as col_id,  7 as col_seq from brcn_diag_aninf where anth_rcrd_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_diag_aninf where  bmi_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_diag_aninf where  bmi_vl is null and anth_rcrd_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_diag_aninf where pt_sbst_no  is not null and anth_rcrd_ymd between  '20100101' and '20211231' ) d 	,(select sum(bmi_vl) as ave from brcn_diag_aninf where  bmi_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') e  	,(select min(bmi_vl) as min_vl from brcn_diag_aninf where  bmi_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(bmi_vl order by bmi_vl separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_diag_aninf where bmi_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(bmi_vl order by bmi_vl separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_diag_aninf where bmi_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(bmi_vl order by bmi_vl separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_diag_aninf where bmi_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') a) i 	,(select max(bmi_vl) as n4_qrtl_cnt from brcn_diag_aninf where  bmi_vl is not null and anth_rcrd_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select bmi_vl as mode_vl, count(bmi_vl) as mode_cnt from brcn_diag_aninf where  bmi_vl is not null  and anth_rcrd_ymd between  '20100101' and '20211231' group by bmi_vl ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt 	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11050' as tbl_id, '1105004' as col_id,  4 as col_seq from brcn_diag_inf where diag_rgst_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_diag_inf where  diag_rgst_seq is not null and diag_rgst_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_diag_inf where  diag_rgst_seq is null and diag_rgst_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_diag_inf where pt_sbst_no  is not null and diag_rgst_ymd between  '20100101' and '20211231' ) d ;							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt 	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11060' as tbl_id, '1106004' as col_id,  4 as col_seq from brcn_diag_mtst where mtdg_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_diag_mtst where  mtdg_seq is not null and mtdg_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_diag_mtst where  mtdg_seq is null and mtdg_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_diag_mtst where pt_sbst_no  is not null and mtdg_ymd between  '20100101' and '20211231' ) d 	,(select sum(mtdg_seq) as ave from brcn_diag_mtst where  mtdg_seq is not null and mtdg_ymd between  '20100101' and '20211231') e  	,(select min(mtdg_seq) as min_vl from brcn_diag_mtst where  mtdg_seq is not null and mtdg_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(mtdg_seq order by mtdg_seq separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_diag_mtst where mtdg_seq is not null and mtdg_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(mtdg_seq order by mtdg_seq separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_diag_mtst where mtdg_seq is not null and mtdg_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(mtdg_seq order by mtdg_seq separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_diag_mtst where mtdg_seq is not null and mtdg_ymd between  '20100101' and '20211231') a) i 	,(select max(mtdg_seq) as n4_qrtl_cnt from brcn_diag_mtst where  mtdg_seq is not null and mtdg_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select mtdg_seq as mode_vl, count(mtdg_seq) as mode_cnt from brcn_diag_mtst where  mtdg_seq is not null  and mtdg_ymd between  '20100101' and '20211231' group by mtdg_seq ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt 	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11070' as tbl_id, '1107004' as col_id,  4 as col_seq from brcn_diag_stag where diag_stag_rcrd_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_diag_stag where  diag_stag_rcrd_seq is not null and diag_stag_rcrd_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_diag_stag where  diag_stag_rcrd_seq is null and diag_stag_rcrd_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_diag_stag where pt_sbst_no  is not null and diag_stag_rcrd_ymd between  '20100101' and '20211231' ) d; 							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt 	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11080' as tbl_id, '1108004' as col_id,  4 as col_seq from brcn_exam_diag where cexm_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_diag where  cexm_seq is not null and cexm_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_diag where  cexm_seq is null and cexm_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_diag where pt_sbst_no  is not null and cexm_ymd between  '20100101' and '20211231' ) d ;							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt 	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11090' as tbl_id, '1109004' as col_id,  4 as col_seq from brcn_exam_imag where imex_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_imag where  imex_seq is not null and imex_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_imag where  imex_seq is null and imex_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_imag where pt_sbst_no  is not null and imex_ymd between  '20100101' and '20211231' ) d ;							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt 	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11100' as tbl_id, '1110004' as col_id,  4 as col_seq from brcn_exam_byps where bpsy_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_byps where  bpsy_seq is not null and bpsy_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_byps where  bpsy_seq is null and bpsy_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_byps where pt_sbst_no  is not null and bpsy_ymd between  '20100101' and '20211231' ) d ;							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt 	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11110' as tbl_id, '1111004' as col_id,  4 as col_seq from brcn_exam_impt where imem_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_impt where  imem_seq is not null and imem_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_impt where  imem_seq is null and imem_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_impt where pt_sbst_no  is not null and imem_ymd between  '20100101' and '20211231' ) d ;							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt 	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11120' as tbl_id, '1112004' as col_id,  4 as col_seq from brcn_exam_mlpt where mlem_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_mlpt where  mlem_seq is not null and mlem_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_mlpt where  mlem_seq is null and mlem_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_mlpt where pt_sbst_no  is not null and mlem_ymd between  '20100101' and '20211231' ) d ;							

insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt 	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11130' as tbl_id, '1113004' as col_id,  4 as col_seq from brcn_exam_gmvx where gmvx_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_gmvx where  gmvx_seq is not null and gmvx_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_gmvx where  gmvx_seq is null and gmvx_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_gmvx where pt_sbst_no  is not null and gmvx_ymd between  '20100101' and '20211231' ) d ;							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11130' as tbl_id, '1113023' as col_id,  23 as col_seq from brcn_exam_gmvx where gmvx_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_gmvx where  amsn_vainf_b_vl is not null and gmvx_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_gmvx where  amsn_vainf_b_vl is null and gmvx_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_gmvx where pt_sbst_no  is not null and gmvx_ymd between  '20100101' and '20211231' ) d 	,(select sum(amsn_vainf_b_vl) as ave from brcn_exam_gmvx where  amsn_vainf_b_vl is not null and gmvx_ymd between  '20100101' and '20211231') e  	,(select min(amsn_vainf_b_vl) as min_vl from brcn_exam_gmvx where  amsn_vainf_b_vl is not null and gmvx_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(amsn_vainf_b_vl order by amsn_vainf_b_vl separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_exam_gmvx where amsn_vainf_b_vl is not null and gmvx_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(amsn_vainf_b_vl order by amsn_vainf_b_vl separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_exam_gmvx where amsn_vainf_b_vl is not null and gmvx_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(amsn_vainf_b_vl order by amsn_vainf_b_vl separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_exam_gmvx where amsn_vainf_b_vl is not null and gmvx_ymd between  '20100101' and '20211231') a) i 	,(select max(amsn_vainf_b_vl) as n4_qrtl_cnt from brcn_exam_gmvx where  amsn_vainf_b_vl is not null and gmvx_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select amsn_vainf_b_vl as mode_vl, count(amsn_vainf_b_vl) as mode_cnt from brcn_exam_gmvx where  amsn_vainf_b_vl is not null  and gmvx_ymd between  '20100101' and '20211231' group by amsn_vainf_b_vl ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt 	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11140' as tbl_id, '1114004' as col_id,  4 as col_seq from brcn_exam_gnrx where gnrx_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_gnrx where  gnrx_seq is not null and gnrx_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_gnrx where  gnrx_seq is null and gnrx_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_gnrx where pt_sbst_no  is not null and gnrx_ymd between  '20100101' and '20211231' ) d ;							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt 	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11150' as tbl_id, '1115004' as col_id,  4 as col_seq from brcn_trtm_oprt where oprt_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_trtm_oprt where  oprt_seq is not null and oprt_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_trtm_oprt where  oprt_seq is null and oprt_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_trtm_oprt where pt_sbst_no  is not null and oprt_ymd between  '20100101' and '20211231' ) d ;							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11150' as tbl_id, '1115017' as col_id,  17 as col_seq from brcn_trtm_oprt where oprt_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_trtm_oprt where  ebl_qty is not null and oprt_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_trtm_oprt where  ebl_qty is null and oprt_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_trtm_oprt where pt_sbst_no  is not null and oprt_ymd between  '20100101' and '20211231' ) d 	,(select sum(ebl_qty) as ave from brcn_trtm_oprt where  ebl_qty is not null and oprt_ymd between  '20100101' and '20211231') e  	,(select min(ebl_qty) as min_vl from brcn_trtm_oprt where  ebl_qty is not null and oprt_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(ebl_qty order by ebl_qty separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_trtm_oprt where ebl_qty is not null and oprt_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(ebl_qty order by ebl_qty separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_trtm_oprt where ebl_qty is not null and oprt_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(ebl_qty order by ebl_qty separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_trtm_oprt where ebl_qty is not null and oprt_ymd between  '20100101' and '20211231') a) i 	,(select max(ebl_qty) as n4_qrtl_cnt from brcn_trtm_oprt where  ebl_qty is not null and oprt_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select ebl_qty as mode_vl, count(ebl_qty) as mode_cnt from brcn_trtm_oprt where  ebl_qty is not null  and oprt_ymd between  '20100101' and '20211231' group by ebl_qty ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt 	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11160' as tbl_id, '1116004' as col_id,  4 as col_seq from brcn_trtm_bltr where bltr_prsc_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_trtm_bltr where  bltr_prsc_seq is not null and bltr_prsc_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_trtm_bltr where  bltr_prsc_seq is null and bltr_prsc_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_trtm_bltr where pt_sbst_no  is not null and bltr_prsc_ymd between  '20100101' and '20211231' ) d ;							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11160' as tbl_id, '1116009' as col_id,  9 as col_seq from brcn_trtm_bltr where bltr_prsc_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_trtm_bltr where  blpt_capa is not null and bltr_prsc_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_trtm_bltr where  blpt_capa is null and bltr_prsc_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_trtm_bltr where pt_sbst_no  is not null and bltr_prsc_ymd between  '20100101' and '20211231' ) d 	,(select sum(blpt_capa) as ave from brcn_trtm_bltr where  blpt_capa is not null and bltr_prsc_ymd between  '20100101' and '20211231') e  	,(select min(blpt_capa) as min_vl from brcn_trtm_bltr where  blpt_capa is not null and bltr_prsc_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(blpt_capa order by blpt_capa separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_trtm_bltr where blpt_capa is not null and bltr_prsc_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(blpt_capa order by blpt_capa separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_trtm_bltr where blpt_capa is not null and bltr_prsc_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(blpt_capa order by blpt_capa separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_trtm_bltr where blpt_capa is not null and bltr_prsc_ymd between  '20100101' and '20211231') a) i 	,(select max(blpt_capa) as n4_qrtl_cnt from brcn_trtm_bltr where  blpt_capa is not null and bltr_prsc_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select blpt_capa as mode_vl, count(blpt_capa) as mode_cnt from brcn_trtm_bltr where  blpt_capa is not null  and bltr_prsc_ymd between  '20100101' and '20211231' group by blpt_capa ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11160' as tbl_id, '1116010' as col_id,  10 as col_seq from brcn_trtm_bltr where bltr_prsc_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_trtm_bltr where  bltr_pack_cnt is not null and bltr_prsc_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_trtm_bltr where  bltr_pack_cnt is null and bltr_prsc_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_trtm_bltr where pt_sbst_no  is not null and bltr_prsc_ymd between  '20100101' and '20211231' ) d 	,(select sum(bltr_pack_cnt) as ave from brcn_trtm_bltr where  bltr_pack_cnt is not null and bltr_prsc_ymd between  '20100101' and '20211231') e  	,(select min(bltr_pack_cnt) as min_vl from brcn_trtm_bltr where  bltr_pack_cnt is not null and bltr_prsc_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(bltr_pack_cnt order by bltr_pack_cnt separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_trtm_bltr where bltr_pack_cnt is not null and bltr_prsc_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(bltr_pack_cnt order by bltr_pack_cnt separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_trtm_bltr where bltr_pack_cnt is not null and bltr_prsc_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(bltr_pack_cnt order by bltr_pack_cnt separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_trtm_bltr where bltr_pack_cnt is not null and bltr_prsc_ymd between  '20100101' and '20211231') a) i 	,(select max(bltr_pack_cnt) as n4_qrtl_cnt from brcn_trtm_bltr where  bltr_pack_cnt is not null and bltr_prsc_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select bltr_pack_cnt as mode_vl, count(bltr_pack_cnt) as mode_cnt from brcn_trtm_bltr where  bltr_pack_cnt is not null  and bltr_prsc_ymd between  '20100101' and '20211231' group by bltr_pack_cnt ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11160' as tbl_id, '1116011' as col_id,  11 as col_seq from brcn_trtm_bltr where bltr_prsc_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_trtm_bltr where  bltr_totl_qty is not null and bltr_prsc_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_trtm_bltr where  bltr_totl_qty is null and bltr_prsc_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_trtm_bltr where pt_sbst_no  is not null and bltr_prsc_ymd between  '20100101' and '20211231' ) d 	,(select sum(bltr_totl_qty) as ave from brcn_trtm_bltr where  bltr_totl_qty is not null and bltr_prsc_ymd between  '20100101' and '20211231') e  	,(select min(bltr_totl_qty) as min_vl from brcn_trtm_bltr where  bltr_totl_qty is not null and bltr_prsc_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(bltr_totl_qty order by bltr_totl_qty separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_trtm_bltr where bltr_totl_qty is not null and bltr_prsc_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(bltr_totl_qty order by bltr_totl_qty separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_trtm_bltr where bltr_totl_qty is not null and bltr_prsc_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(bltr_totl_qty order by bltr_totl_qty separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_trtm_bltr where bltr_totl_qty is not null and bltr_prsc_ymd between  '20100101' and '20211231') a) i 	,(select max(bltr_totl_qty) as n4_qrtl_cnt from brcn_trtm_bltr where  bltr_totl_qty is not null and bltr_prsc_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select bltr_totl_qty as mode_vl, count(bltr_totl_qty) as mode_cnt from brcn_trtm_bltr where  bltr_totl_qty is not null  and bltr_prsc_ymd between  '20100101' and '20211231' group by bltr_totl_qty ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt 	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11170' as tbl_id, '1117004' as col_id,  4 as col_seq from brcn_exam_sgpt where srgc_ptem_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_sgpt where  srgc_ptem_seq is not null and srgc_ptem_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_sgpt where  srgc_ptem_seq is null and srgc_ptem_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_sgpt where pt_sbst_no  is not null and srgc_ptem_ymd between  '20100101' and '20211231' ) d ;							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11170' as tbl_id, '1117010' as col_id,  10 as col_seq from brcn_exam_sgpt where srgc_ptem_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_sgpt where  srgc_ptem_rslt_tumr_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_sgpt where  srgc_ptem_rslt_tumr_cnt is null and srgc_ptem_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_sgpt where pt_sbst_no  is not null and srgc_ptem_ymd between  '20100101' and '20211231' ) d 	,(select sum(srgc_ptem_rslt_tumr_cnt) as ave from brcn_exam_sgpt where  srgc_ptem_rslt_tumr_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') e  	,(select min(srgc_ptem_rslt_tumr_cnt) as min_vl from brcn_exam_sgpt where  srgc_ptem_rslt_tumr_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(srgc_ptem_rslt_tumr_cnt order by srgc_ptem_rslt_tumr_cnt separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_exam_sgpt where srgc_ptem_rslt_tumr_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(srgc_ptem_rslt_tumr_cnt order by srgc_ptem_rslt_tumr_cnt separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_exam_sgpt where srgc_ptem_rslt_tumr_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(srgc_ptem_rslt_tumr_cnt order by srgc_ptem_rslt_tumr_cnt separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_exam_sgpt where srgc_ptem_rslt_tumr_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) i 	,(select max(srgc_ptem_rslt_tumr_cnt) as n4_qrtl_cnt from brcn_exam_sgpt where  srgc_ptem_rslt_tumr_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select srgc_ptem_rslt_tumr_cnt as mode_vl, count(srgc_ptem_rslt_tumr_cnt) as mode_cnt from brcn_exam_sgpt where  srgc_ptem_rslt_tumr_cnt is not null  and srgc_ptem_ymd between  '20100101' and '20211231' group by srgc_ptem_rslt_tumr_cnt ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11170' as tbl_id, '1117011' as col_id,  11 as col_seq from brcn_exam_sgpt where srgc_ptem_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_sgpt where  tumr_wdth_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_sgpt where  tumr_wdth_lnth_vl is null and srgc_ptem_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_sgpt where pt_sbst_no  is not null and srgc_ptem_ymd between  '20100101' and '20211231' ) d 	,(select sum(tumr_wdth_lnth_vl) as ave from brcn_exam_sgpt where  tumr_wdth_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') e  	,(select min(tumr_wdth_lnth_vl) as min_vl from brcn_exam_sgpt where  tumr_wdth_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(tumr_wdth_lnth_vl order by tumr_wdth_lnth_vl separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_exam_sgpt where tumr_wdth_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(tumr_wdth_lnth_vl order by tumr_wdth_lnth_vl separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_exam_sgpt where tumr_wdth_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(tumr_wdth_lnth_vl order by tumr_wdth_lnth_vl separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_exam_sgpt where tumr_wdth_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) i 	,(select max(tumr_wdth_lnth_vl) as n4_qrtl_cnt from brcn_exam_sgpt where  tumr_wdth_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select tumr_wdth_lnth_vl as mode_vl, count(tumr_wdth_lnth_vl) as mode_cnt from brcn_exam_sgpt where  tumr_wdth_lnth_vl is not null  and srgc_ptem_ymd between  '20100101' and '20211231' group by tumr_wdth_lnth_vl ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11170' as tbl_id, '1117012' as col_id,  12 as col_seq from brcn_exam_sgpt where srgc_ptem_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_sgpt where  tumr_lgtd_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_sgpt where  tumr_lgtd_lnth_vl is null and srgc_ptem_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_sgpt where pt_sbst_no  is not null and srgc_ptem_ymd between  '20100101' and '20211231' ) d 	,(select sum(tumr_lgtd_lnth_vl) as ave from brcn_exam_sgpt where  tumr_lgtd_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') e  	,(select min(tumr_lgtd_lnth_vl) as min_vl from brcn_exam_sgpt where  tumr_lgtd_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(tumr_lgtd_lnth_vl order by tumr_lgtd_lnth_vl separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_exam_sgpt where tumr_lgtd_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(tumr_lgtd_lnth_vl order by tumr_lgtd_lnth_vl separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_exam_sgpt where tumr_lgtd_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(tumr_lgtd_lnth_vl order by tumr_lgtd_lnth_vl separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_exam_sgpt where tumr_lgtd_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) i 	,(select max(tumr_lgtd_lnth_vl) as n4_qrtl_cnt from brcn_exam_sgpt where  tumr_lgtd_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select tumr_lgtd_lnth_vl as mode_vl, count(tumr_lgtd_lnth_vl) as mode_cnt from brcn_exam_sgpt where  tumr_lgtd_lnth_vl is not null  and srgc_ptem_ymd between  '20100101' and '20211231' group by tumr_lgtd_lnth_vl ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11170' as tbl_id, '1117013' as col_id,  13 as col_seq from brcn_exam_sgpt where srgc_ptem_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_sgpt where  tumr_hght_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_sgpt where  tumr_hght_vl is null and srgc_ptem_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_sgpt where pt_sbst_no  is not null and srgc_ptem_ymd between  '20100101' and '20211231' ) d 	,(select sum(tumr_hght_vl) as ave from brcn_exam_sgpt where  tumr_hght_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') e  	,(select min(tumr_hght_vl) as min_vl from brcn_exam_sgpt where  tumr_hght_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(tumr_hght_vl order by tumr_hght_vl separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_exam_sgpt where tumr_hght_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(tumr_hght_vl order by tumr_hght_vl separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_exam_sgpt where tumr_hght_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(tumr_hght_vl order by tumr_hght_vl separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_exam_sgpt where tumr_hght_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) i 	,(select max(tumr_hght_vl) as n4_qrtl_cnt from brcn_exam_sgpt where  tumr_hght_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select tumr_hght_vl as mode_vl, count(tumr_hght_vl) as mode_cnt from brcn_exam_sgpt where  tumr_hght_vl is not null  and srgc_ptem_ymd between  '20100101' and '20211231' group by tumr_hght_vl ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11170' as tbl_id, '1117014' as col_id,  14 as col_seq from brcn_exam_sgpt where srgc_ptem_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_sgpt where  tumr_max_diam_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_sgpt where  tumr_max_diam_vl is null and srgc_ptem_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_sgpt where pt_sbst_no  is not null and srgc_ptem_ymd between  '20100101' and '20211231' ) d 	,(select sum(tumr_max_diam_vl) as ave from brcn_exam_sgpt where  tumr_max_diam_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') e  	,(select min(tumr_max_diam_vl) as min_vl from brcn_exam_sgpt where  tumr_max_diam_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(tumr_max_diam_vl order by tumr_max_diam_vl separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_exam_sgpt where tumr_max_diam_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(tumr_max_diam_vl order by tumr_max_diam_vl separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_exam_sgpt where tumr_max_diam_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(tumr_max_diam_vl order by tumr_max_diam_vl separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_exam_sgpt where tumr_max_diam_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) i 	,(select max(tumr_max_diam_vl) as n4_qrtl_cnt from brcn_exam_sgpt where  tumr_max_diam_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select tumr_max_diam_vl as mode_vl, count(tumr_max_diam_vl) as mode_cnt from brcn_exam_sgpt where  tumr_max_diam_vl is not null  and srgc_ptem_ymd between  '20100101' and '20211231' group by tumr_max_diam_vl ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11170' as tbl_id, '1117033' as col_id,  33 as col_seq from brcn_exam_sgpt where srgc_ptem_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_sgpt where  srmg_sfmg_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_sgpt where  srmg_sfmg_lnth_vl is null and srgc_ptem_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_sgpt where pt_sbst_no  is not null and srgc_ptem_ymd between  '20100101' and '20211231' ) d 	,(select sum(srmg_sfmg_lnth_vl) as ave from brcn_exam_sgpt where  srmg_sfmg_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') e  	,(select min(srmg_sfmg_lnth_vl) as min_vl from brcn_exam_sgpt where  srmg_sfmg_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(srmg_sfmg_lnth_vl order by srmg_sfmg_lnth_vl separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_exam_sgpt where srmg_sfmg_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(srmg_sfmg_lnth_vl order by srmg_sfmg_lnth_vl separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_exam_sgpt where srmg_sfmg_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(srmg_sfmg_lnth_vl order by srmg_sfmg_lnth_vl separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_exam_sgpt where srmg_sfmg_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) i 	,(select max(srmg_sfmg_lnth_vl) as n4_qrtl_cnt from brcn_exam_sgpt where  srmg_sfmg_lnth_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select srmg_sfmg_lnth_vl as mode_vl, count(srmg_sfmg_lnth_vl) as mode_cnt from brcn_exam_sgpt where  srmg_sfmg_lnth_vl is not null  and srgc_ptem_ymd between  '20100101' and '20211231' group by srmg_sfmg_lnth_vl ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11170' as tbl_id, '1117037' as col_id,  37 as col_seq from brcn_exam_sgpt where srgc_ptem_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_sgpt where  mtcr_size_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_sgpt where  mtcr_size_vl is null and srgc_ptem_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_sgpt where pt_sbst_no  is not null and srgc_ptem_ymd between  '20100101' and '20211231' ) d 	,(select sum(mtcr_size_vl) as ave from brcn_exam_sgpt where  mtcr_size_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') e  	,(select min(mtcr_size_vl) as min_vl from brcn_exam_sgpt where  mtcr_size_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(mtcr_size_vl order by mtcr_size_vl separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_exam_sgpt where mtcr_size_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(mtcr_size_vl order by mtcr_size_vl separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_exam_sgpt where mtcr_size_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(mtcr_size_vl order by mtcr_size_vl separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_exam_sgpt where mtcr_size_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) i 	,(select max(mtcr_size_vl) as n4_qrtl_cnt from brcn_exam_sgpt where  mtcr_size_vl is not null and srgc_ptem_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select mtcr_size_vl as mode_vl, count(mtcr_size_vl) as mode_cnt from brcn_exam_sgpt where  mtcr_size_vl is not null  and srgc_ptem_ymd between  '20100101' and '20211231' group by mtcr_size_vl ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11170' as tbl_id, '1117042' as col_id,  42 as col_seq from brcn_exam_sgpt where srgc_ptem_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_sgpt where  ln_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_sgpt where  ln_totl_cnt is null and srgc_ptem_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_sgpt where pt_sbst_no  is not null and srgc_ptem_ymd between  '20100101' and '20211231' ) d 	,(select sum(ln_totl_cnt) as ave from brcn_exam_sgpt where  ln_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') e  	,(select min(ln_totl_cnt) as min_vl from brcn_exam_sgpt where  ln_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(ln_totl_cnt order by ln_totl_cnt separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_exam_sgpt where ln_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(ln_totl_cnt order by ln_totl_cnt separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_exam_sgpt where ln_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(ln_totl_cnt order by ln_totl_cnt separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_exam_sgpt where ln_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) i 	,(select max(ln_totl_cnt) as n4_qrtl_cnt from brcn_exam_sgpt where  ln_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select ln_totl_cnt as mode_vl, count(ln_totl_cnt) as mode_cnt from brcn_exam_sgpt where  ln_totl_cnt is not null  and srgc_ptem_ymd between  '20100101' and '20211231' group by ln_totl_cnt ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11170' as tbl_id, '1117044' as col_id,  44 as col_seq from brcn_exam_sgpt where srgc_ptem_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_sgpt where  slnd_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_sgpt where  slnd_totl_cnt is null and srgc_ptem_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_sgpt where pt_sbst_no  is not null and srgc_ptem_ymd between  '20100101' and '20211231' ) d 	,(select sum(slnd_totl_cnt) as ave from brcn_exam_sgpt where  slnd_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') e  	,(select min(slnd_totl_cnt) as min_vl from brcn_exam_sgpt where  slnd_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(slnd_totl_cnt order by slnd_totl_cnt separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_exam_sgpt where slnd_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(slnd_totl_cnt order by slnd_totl_cnt separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_exam_sgpt where slnd_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(slnd_totl_cnt order by slnd_totl_cnt separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_exam_sgpt where slnd_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) i 	,(select max(slnd_totl_cnt) as n4_qrtl_cnt from brcn_exam_sgpt where  slnd_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select slnd_totl_cnt as mode_vl, count(slnd_totl_cnt) as mode_cnt from brcn_exam_sgpt where  slnd_totl_cnt is not null  and srgc_ptem_ymd between  '20100101' and '20211231' group by slnd_totl_cnt ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11170' as tbl_id, '1117045' as col_id,  45 as col_seq from brcn_exam_sgpt where srgc_ptem_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_sgpt where  pstv_slnd_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_sgpt where  pstv_slnd_cnt is null and srgc_ptem_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_sgpt where pt_sbst_no  is not null and srgc_ptem_ymd between  '20100101' and '20211231' ) d 	,(select sum(pstv_slnd_cnt) as ave from brcn_exam_sgpt where  pstv_slnd_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') e  	,(select min(pstv_slnd_cnt) as min_vl from brcn_exam_sgpt where  pstv_slnd_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(pstv_slnd_cnt order by pstv_slnd_cnt separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_exam_sgpt where pstv_slnd_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(pstv_slnd_cnt order by pstv_slnd_cnt separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_exam_sgpt where pstv_slnd_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(pstv_slnd_cnt order by pstv_slnd_cnt separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_exam_sgpt where pstv_slnd_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) i 	,(select max(pstv_slnd_cnt) as n4_qrtl_cnt from brcn_exam_sgpt where  pstv_slnd_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select pstv_slnd_cnt as mode_vl, count(pstv_slnd_cnt) as mode_cnt from brcn_exam_sgpt where  pstv_slnd_cnt is not null  and srgc_ptem_ymd between  '20100101' and '20211231' group by pstv_slnd_cnt ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11170' as tbl_id, '1117046' as col_id,  46 as col_seq from brcn_exam_sgpt where srgc_ptem_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_sgpt where  nsnd_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_sgpt where  nsnd_totl_cnt is null and srgc_ptem_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_sgpt where pt_sbst_no  is not null and srgc_ptem_ymd between  '20100101' and '20211231' ) d 	,(select sum(nsnd_totl_cnt) as ave from brcn_exam_sgpt where  nsnd_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') e  	,(select min(nsnd_totl_cnt) as min_vl from brcn_exam_sgpt where  nsnd_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(nsnd_totl_cnt order by nsnd_totl_cnt separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_exam_sgpt where nsnd_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(nsnd_totl_cnt order by nsnd_totl_cnt separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_exam_sgpt where nsnd_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(nsnd_totl_cnt order by nsnd_totl_cnt separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_exam_sgpt where nsnd_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) i 	,(select max(nsnd_totl_cnt) as n4_qrtl_cnt from brcn_exam_sgpt where  nsnd_totl_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select nsnd_totl_cnt as mode_vl, count(nsnd_totl_cnt) as mode_cnt from brcn_exam_sgpt where  nsnd_totl_cnt is not null  and srgc_ptem_ymd between  '20100101' and '20211231' group by nsnd_totl_cnt ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11170' as tbl_id, '1117047' as col_id,  47 as col_seq from brcn_exam_sgpt where srgc_ptem_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_exam_sgpt where  pstv_nsnd_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_exam_sgpt where  pstv_nsnd_cnt is null and srgc_ptem_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_exam_sgpt where pt_sbst_no  is not null and srgc_ptem_ymd between  '20100101' and '20211231' ) d 	,(select sum(pstv_nsnd_cnt) as ave from brcn_exam_sgpt where  pstv_nsnd_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') e  	,(select min(pstv_nsnd_cnt) as min_vl from brcn_exam_sgpt where  pstv_nsnd_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(pstv_nsnd_cnt order by pstv_nsnd_cnt separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_exam_sgpt where pstv_nsnd_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(pstv_nsnd_cnt order by pstv_nsnd_cnt separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_exam_sgpt where pstv_nsnd_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(pstv_nsnd_cnt order by pstv_nsnd_cnt separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_exam_sgpt where pstv_nsnd_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') a) i 	,(select max(pstv_nsnd_cnt) as n4_qrtl_cnt from brcn_exam_sgpt where  pstv_nsnd_cnt is not null and srgc_ptem_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select pstv_nsnd_cnt as mode_vl, count(pstv_nsnd_cnt) as mode_cnt from brcn_exam_sgpt where  pstv_nsnd_cnt is not null  and srgc_ptem_ymd between  '20100101' and '20211231' group by pstv_nsnd_cnt ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt 	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11180' as tbl_id, '1118004' as col_id,  4 as col_seq from brcn_diag_afoc where comp_ocrn_oprt_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_diag_afoc where  comp_ocrn_oprt_seq is not null and comp_ocrn_oprt_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_diag_afoc where  comp_ocrn_oprt_seq is null and comp_ocrn_oprt_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_diag_afoc where pt_sbst_no  is not null and comp_ocrn_oprt_ymd between  '20100101' and '20211231' ) d ; 							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt 	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11190' as tbl_id, '1119004' as col_id,  4 as col_seq from brcn_trtm_drin where drug_prsc_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_trtm_drin where  drug_prsc_seq is not null and drug_prsc_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_trtm_drin where  drug_prsc_seq is null and drug_prsc_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_trtm_drin where pt_sbst_no  is not null and drug_prsc_ymd between  '20100101' and '20211231' ) d ;							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11190' as tbl_id, '1119026' as col_id,  26 as col_seq from brcn_trtm_drin where drug_prsc_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_trtm_drin where  drug_prsc_dcnt is not null and drug_prsc_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_trtm_drin where  drug_prsc_dcnt is null and drug_prsc_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_trtm_drin where pt_sbst_no  is not null and drug_prsc_ymd between  '20100101' and '20211231' ) d 	,(select sum(drug_prsc_dcnt) as ave from brcn_trtm_drin where  drug_prsc_dcnt is not null and drug_prsc_ymd between  '20100101' and '20211231') e  	,(select min(drug_prsc_dcnt) as min_vl from brcn_trtm_drin where  drug_prsc_dcnt is not null and drug_prsc_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(drug_prsc_dcnt order by drug_prsc_dcnt separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_trtm_drin where drug_prsc_dcnt is not null and drug_prsc_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(drug_prsc_dcnt order by drug_prsc_dcnt separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_trtm_drin where drug_prsc_dcnt is not null and drug_prsc_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(drug_prsc_dcnt order by drug_prsc_dcnt separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_trtm_drin where drug_prsc_dcnt is not null and drug_prsc_ymd between  '20100101' and '20211231') a) i 	,(select max(drug_prsc_dcnt) as n4_qrtl_cnt from brcn_trtm_drin where  drug_prsc_dcnt is not null and drug_prsc_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select drug_prsc_dcnt as mode_vl, count(drug_prsc_dcnt) as mode_cnt from brcn_trtm_drin where  drug_prsc_dcnt is not null  and drug_prsc_ymd between  '20100101' and '20211231' group by drug_prsc_dcnt ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt 	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11200' as tbl_id, '1120004' as col_id,  4 as col_seq from brcn_trtm_antp where antp_strt_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_trtm_antp where  antp_seq is not null and antp_strt_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_trtm_antp where  antp_seq is null and antp_strt_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_trtm_antp where pt_sbst_no  is not null and antp_strt_ymd between  '20100101' and '20211231' ) d ;							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11200' as tbl_id, '1120007' as col_id,  7 as col_seq from brcn_trtm_antp where antp_strt_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_trtm_antp where  antp_cycl_cnt is not null and antp_strt_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_trtm_antp where  antp_cycl_cnt is null and antp_strt_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_trtm_antp where pt_sbst_no  is not null and antp_strt_ymd between  '20100101' and '20211231' ) d 	,(select sum(antp_cycl_cnt) as ave from brcn_trtm_antp where  antp_cycl_cnt is not null and antp_strt_ymd between  '20100101' and '20211231') e  	,(select min(antp_cycl_cnt) as min_vl from brcn_trtm_antp where  antp_cycl_cnt is not null and antp_strt_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(antp_cycl_cnt order by antp_cycl_cnt separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_trtm_antp where antp_cycl_cnt is not null and antp_strt_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(antp_cycl_cnt order by antp_cycl_cnt separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_trtm_antp where antp_cycl_cnt is not null and antp_strt_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(antp_cycl_cnt order by antp_cycl_cnt separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_trtm_antp where antp_cycl_cnt is not null and antp_strt_ymd between  '20100101' and '20211231') a) i 	,(select max(antp_cycl_cnt) as n4_qrtl_cnt from brcn_trtm_antp where  antp_cycl_cnt is not null and antp_strt_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select antp_cycl_cnt as mode_vl, count(antp_cycl_cnt) as mode_cnt from brcn_trtm_antp where  antp_cycl_cnt is not null  and antp_strt_ymd between  '20100101' and '20211231' group by antp_cycl_cnt ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11200' as tbl_id, '1120008' as col_id,  8 as col_seq from brcn_trtm_antp where antp_strt_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_trtm_antp where  antp_line_cnt is not null and antp_strt_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_trtm_antp where  antp_line_cnt is null and antp_strt_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_trtm_antp where pt_sbst_no  is not null and antp_strt_ymd between  '20100101' and '20211231' ) d 	,(select sum(antp_line_cnt) as ave from brcn_trtm_antp where  antp_line_cnt is not null and antp_strt_ymd between  '20100101' and '20211231') e  	,(select min(antp_line_cnt) as min_vl from brcn_trtm_antp where  antp_line_cnt is not null and antp_strt_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(antp_line_cnt order by antp_line_cnt separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_trtm_antp where antp_line_cnt is not null and antp_strt_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(antp_line_cnt order by antp_line_cnt separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_trtm_antp where antp_line_cnt is not null and antp_strt_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(antp_line_cnt order by antp_line_cnt separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_trtm_antp where antp_line_cnt is not null and antp_strt_ymd between  '20100101' and '20211231') a) i 	,(select max(antp_line_cnt) as n4_qrtl_cnt from brcn_trtm_antp where  antp_line_cnt is not null and antp_strt_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select antp_line_cnt as mode_vl, count(antp_line_cnt) as mode_cnt from brcn_trtm_antp where  antp_line_cnt is not null  and antp_strt_ymd between  '20100101' and '20211231' group by antp_line_cnt ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11210' as tbl_id, '1121004' as col_id,  4 as col_seq from brcn_trtm_rd where rdt_prsc_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_trtm_rd where  rdt_prsc_seq is not null and rdt_prsc_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_trtm_rd where  rdt_prsc_seq is null and rdt_prsc_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_trtm_rd where pt_sbst_no  is not null and rdt_prsc_ymd between  '20100101' and '20211231' ) d ;							
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11210' as tbl_id, '1121017' as col_id,  17 as col_seq from brcn_trtm_rd where rdt_prsc_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_trtm_rd where  rd_GY is not null and rdt_prsc_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_trtm_rd where  rd_GY is null and rdt_prsc_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_trtm_rd where pt_sbst_no  is not null and rdt_prsc_ymd between  '20100101' and '20211231' ) d 	,(select sum(rd_GY) as ave from brcn_trtm_rd where  rd_GY is not null and rdt_prsc_ymd between  '20100101' and '20211231') e  	,(select min(rd_GY) as min_vl from brcn_trtm_rd where  rd_GY is not null and rdt_prsc_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(rd_GY order by rd_GY separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_trtm_rd where rd_GY is not null and rdt_prsc_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(rd_GY order by rd_GY separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_trtm_rd where rd_GY is not null and rdt_prsc_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(rd_GY order by rd_GY separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_trtm_rd where rd_GY is not null and rdt_prsc_ymd between  '20100101' and '20211231') a) i 	,(select max(rd_GY) as n4_qrtl_cnt from brcn_trtm_rd where  rd_GY is not null and rdt_prsc_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select rd_GY as mode_vl, count(rd_GY) as mode_cnt from brcn_trtm_rd where  rd_GY is not null  and rdt_prsc_ymd between  '20100101' and '20211231' group by rd_GY ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11210' as tbl_id, '1121018' as col_id,  18 as col_seq from brcn_trtm_rd where rdt_prsc_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_trtm_rd where  rd_impl_nt is not null and rdt_prsc_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_trtm_rd where  rd_impl_nt is null and rdt_prsc_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_trtm_rd where pt_sbst_no  is not null and rdt_prsc_ymd between  '20100101' and '20211231' ) d 	,(select sum(rd_impl_nt) as ave from brcn_trtm_rd where  rd_impl_nt is not null and rdt_prsc_ymd between  '20100101' and '20211231') e  	,(select min(rd_impl_nt) as min_vl from brcn_trtm_rd where  rd_impl_nt is not null and rdt_prsc_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(rd_impl_nt order by rd_impl_nt separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_trtm_rd where rd_impl_nt is not null and rdt_prsc_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(rd_impl_nt order by rd_impl_nt separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_trtm_rd where rd_impl_nt is not null and rdt_prsc_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(rd_impl_nt order by rd_impl_nt separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_trtm_rd where rd_impl_nt is not null and rdt_prsc_ymd between  '20100101' and '20211231') a) i 	,(select max(rd_impl_nt) as n4_qrtl_cnt from brcn_trtm_rd where  rd_impl_nt is not null and rdt_prsc_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select rd_impl_nt as mode_vl, count(rd_impl_nt) as mode_cnt from brcn_trtm_rd where  rd_impl_nt is not null  and rdt_prsc_ymd between  '20100101' and '20211231' group by rd_impl_nt ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl 	 ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11210' as tbl_id, '1121019' as col_id,  19 as col_seq from brcn_trtm_rd where rdt_prsc_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_trtm_rd where  rd_totl_GY is not null and rdt_prsc_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_trtm_rd where  rd_totl_GY is null and rdt_prsc_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_trtm_rd where pt_sbst_no  is not null and rdt_prsc_ymd between  '20100101' and '20211231' ) d 	,(select sum(rd_totl_GY) as ave from brcn_trtm_rd where  rd_totl_GY is not null and rdt_prsc_ymd between  '20100101' and '20211231') e  	,(select min(rd_totl_GY) as min_vl from brcn_trtm_rd where  rd_totl_GY is not null and rdt_prsc_ymd between  '20100101' and '20211231') f  	, (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(rd_totl_GY order by rd_totl_GY separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from brcn_trtm_rd where rd_totl_GY is not null and rdt_prsc_ymd between  '20100101' and '20211231') a) g 	, (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(rd_totl_GY order by rd_totl_GY separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from brcn_trtm_rd where rd_totl_GY is not null and rdt_prsc_ymd between  '20100101' and '20211231') a) h 	, (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(rd_totl_GY order by rd_totl_GY separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from brcn_trtm_rd where rd_totl_GY is not null and rdt_prsc_ymd between  '20100101' and '20211231') a) i 	,(select max(rd_totl_GY) as n4_qrtl_cnt from brcn_trtm_rd where  rd_totl_GY is not null and rdt_prsc_ymd between  '20100101' and '20211231') j  	,(select  a.mode_vl, max(a.mode_cnt) from (select rd_totl_GY as mode_vl, count(rd_totl_GY) as mode_cnt from brcn_trtm_rd where  rd_totl_GY is not null  and rdt_prsc_ymd between  '20100101' and '20211231' group by rd_totl_GY ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt )	select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt 	 ,DATE_FORMAT(current_timestamp,'yyyymmdd') as stats_work_ymd 	,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt 	from (select hosp_cd as hosp_cd,'11220' as tbl_id, '1122004' as col_id,  4 as col_seq from brcn_fuor_rlps where rldg_ymd between  '20100101' and '20211231' )  a 	,(select count(*) as row_cnt from brcn_fuor_rlps where  rldg_seq is not null and rldg_ymd between  '20100101' and '20211231') b 	,(select count(*) as null_ncs from brcn_fuor_rlps where  rldg_seq is null and rldg_ymd between  '20100101' and '20211231') c 	,(select count(distinct pt_sbst_no) as pt_cnt from brcn_fuor_rlps where pt_sbst_no  is not null and rldg_ymd between  '20100101' and '20211231' ) d ;							
