insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt   ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211235'  as coll_end_ymd ,current_timestamp as crtn_dt from (select '9999' as hosp_cd,'98020' as tbl_id, '9802001' as col_id,  1 as col_seq from observation_period where observation_period_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from observation_period where  observation_period_id is not null and observation_period_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from observation_period where  observation_period_id is null and observation_period_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from observation_period where person_id  is not null and observation_period_start_date between  '20100101' and '20211231' ) d ;        
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98020' as tbl_id, '9802002' as col_id,  2 as col_seq from observation_period where observation_period_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from observation_period where  person_id is not null and observation_period_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from observation_period where  person_id is null and observation_period_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from observation_period where person_id  is not null and observation_period_start_date between  '20100101' and '20211231' ) d  ,(select sum(person_id) as ave from observation_period where  person_id is not null and observation_period_start_date between  '20100101' and '20211231') e   ,(select min(person_id) as min_vl from observation_period where  person_id is not null and observation_period_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from observation_period where person_id is not null and observation_period_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from observation_period where person_id is not null and observation_period_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from observation_period where person_id is not null and observation_period_start_date between  '20100101' and '20211231') a) i  ,(select max(person_id) as n4_qrtl_cnt from observation_period where  person_id is not null and observation_period_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select person_id as mode_vl, count(person_id) as mode_cnt from observation_period where  person_id is not null  and observation_period_start_date between  '20100101' and '20211231' group by person_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98020' as tbl_id, '9802005' as col_id,  5 as col_seq from observation_period where observation_period_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from observation_period where  period_type_concept_id is not null and observation_period_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from observation_period where  period_type_concept_id is null and observation_period_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from observation_period where person_id  is not null and observation_period_start_date between  '20100101' and '20211231' ) d  ,(select sum(period_type_concept_id) as ave from observation_period where  period_type_concept_id is not null and observation_period_start_date between  '20100101' and '20211231') e   ,(select min(period_type_concept_id) as min_vl from observation_period where  period_type_concept_id is not null and observation_period_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(period_type_concept_id order by period_type_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from observation_period where period_type_concept_id is not null and observation_period_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(period_type_concept_id order by period_type_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from observation_period where period_type_concept_id is not null and observation_period_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(period_type_concept_id order by period_type_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from observation_period where period_type_concept_id is not null and observation_period_start_date between  '20100101' and '20211231') a) i  ,(select max(period_type_concept_id) as n4_qrtl_cnt from observation_period where  period_type_concept_id is not null and observation_period_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select period_type_concept_id as mode_vl, count(period_type_concept_id) as mode_cnt from observation_period where  period_type_concept_id is not null  and observation_period_start_date between  '20100101' and '20211231' group by period_type_concept_id ) a group by a.mode_vl limit 1) k ;
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt   ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211235'  as coll_end_ymd ,current_timestamp as crtn_dt from (select '9999' as hosp_cd,'98030' as tbl_id, '9803001' as col_id,  1 as col_seq from visit_occurrence where visit_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_occurrence where  visit_occurrence_id is not null and visit_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_occurrence where  visit_occurrence_id is null and visit_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_occurrence where person_id  is not null and visit_start_date between  '20100101' and '20211231' ) d ;       */
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98030' as tbl_id, '9803002' as col_id,  2 as col_seq from visit_occurrence where visit_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_occurrence where  person_id is not null and visit_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_occurrence where  person_id is null and visit_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_occurrence where person_id  is not null and visit_start_date between  '20100101' and '20211231' ) d  ,(select sum(person_id) as ave from visit_occurrence where  person_id is not null and visit_start_date between  '20100101' and '20211231') e   ,(select min(person_id) as min_vl from visit_occurrence where  person_id is not null and visit_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_occurrence where person_id is not null and visit_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_occurrence where person_id is not null and visit_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_occurrence where person_id is not null and visit_start_date between  '20100101' and '20211231') a) i  ,(select max(person_id) as n4_qrtl_cnt from visit_occurrence where  person_id is not null and visit_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select person_id as mode_vl, count(person_id) as mode_cnt from visit_occurrence where  person_id is not null  and visit_start_date between  '20100101' and '20211231' group by person_id ) a group by a.mode_vl limit 1) k ;*/
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98030' as tbl_id, '9803003' as col_id,  3 as col_seq from visit_occurrence where visit_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_occurrence where  visit_concept_id is not null and visit_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_occurrence where  visit_concept_id is null and visit_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_occurrence where person_id  is not null and visit_start_date between  '20100101' and '20211231' ) d  ,(select sum(visit_concept_id) as ave from visit_occurrence where  visit_concept_id is not null and visit_start_date between  '20100101' and '20211231') e   ,(select min(visit_concept_id) as min_vl from visit_occurrence where  visit_concept_id is not null and visit_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_concept_id order by visit_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_occurrence where visit_concept_id is not null and visit_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_concept_id order by visit_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_occurrence where visit_concept_id is not null and visit_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_concept_id order by visit_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_occurrence where visit_concept_id is not null and visit_start_date between  '20100101' and '20211231') a) i  ,(select max(visit_concept_id) as n4_qrtl_cnt from visit_occurrence where  visit_concept_id is not null and visit_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_concept_id as mode_vl, count(visit_concept_id) as mode_cnt from visit_occurrence where  visit_concept_id is not null  and visit_start_date between  '20100101' and '20211231' group by visit_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98030' as tbl_id, '9803008' as col_id,  8 as col_seq from visit_occurrence where visit_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_occurrence where  visit_type_concept_id is not null and visit_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_occurrence where  visit_type_concept_id is null and visit_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_occurrence where person_id  is not null and visit_start_date between  '20100101' and '20211231' ) d  ,(select sum(visit_type_concept_id) as ave from visit_occurrence where  visit_type_concept_id is not null and visit_start_date between  '20100101' and '20211231') e   ,(select min(visit_type_concept_id) as min_vl from visit_occurrence where  visit_type_concept_id is not null and visit_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_type_concept_id order by visit_type_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_occurrence where visit_type_concept_id is not null and visit_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_type_concept_id order by visit_type_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_occurrence where visit_type_concept_id is not null and visit_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_type_concept_id order by visit_type_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_occurrence where visit_type_concept_id is not null and visit_start_date between  '20100101' and '20211231') a) i  ,(select max(visit_type_concept_id) as n4_qrtl_cnt from visit_occurrence where  visit_type_concept_id is not null and visit_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_type_concept_id as mode_vl, count(visit_type_concept_id) as mode_cnt from visit_occurrence where  visit_type_concept_id is not null  and visit_start_date between  '20100101' and '20211231' group by visit_type_concept_id ) a group by a.mode_vl limit 1) k ;
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98030' as tbl_id, '9803009' as col_id,  9 as col_seq from visit_occurrence where visit_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_occurrence where  provider_id is not null and visit_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_occurrence where  provider_id is null and visit_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_occurrence where person_id  is not null and visit_start_date between  '20100101' and '20211231' ) d  ,(select sum(provider_id) as ave from visit_occurrence where  provider_id is not null and visit_start_date between  '20100101' and '20211231') e   ,(select min(provider_id) as min_vl from visit_occurrence where  provider_id is not null and visit_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_occurrence where provider_id is not null and visit_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_occurrence where provider_id is not null and visit_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_occurrence where provider_id is not null and visit_start_date between  '20100101' and '20211231') a) i  ,(select max(provider_id) as n4_qrtl_cnt from visit_occurrence where  provider_id is not null and visit_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select provider_id as mode_vl, count(provider_id) as mode_cnt from visit_occurrence where  provider_id is not null  and visit_start_date between  '20100101' and '20211231' group by provider_id ) a group by a.mode_vl limit 1) k ;*/
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98030' as tbl_id, '9803010' as col_id,  10 as col_seq from visit_occurrence where visit_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_occurrence where  care_site_id is not null and visit_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_occurrence where  care_site_id is null and visit_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_occurrence where person_id  is not null and visit_start_date between  '20100101' and '20211231' ) d  ,(select sum(care_site_id) as ave from visit_occurrence where  care_site_id is not null and visit_start_date between  '20100101' and '20211231') e   ,(select min(care_site_id) as min_vl from visit_occurrence where  care_site_id is not null and visit_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(care_site_id order by care_site_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_occurrence where care_site_id is not null and visit_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(care_site_id order by care_site_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_occurrence where care_site_id is not null and visit_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(care_site_id order by care_site_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_occurrence where care_site_id is not null and visit_start_date between  '20100101' and '20211231') a) i  ,(select max(care_site_id) as n4_qrtl_cnt from visit_occurrence where  care_site_id is not null and visit_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select care_site_id as mode_vl, count(care_site_id) as mode_cnt from visit_occurrence where  care_site_id is not null  and visit_start_date between  '20100101' and '20211231' group by care_site_id ) a group by a.mode_vl limit 1) k ;*/
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98030' as tbl_id, '9803012' as col_id,  12 as col_seq from visit_occurrence where visit_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_occurrence where  visit_source_concept_id is not null and visit_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_occurrence where  visit_source_concept_id is null and visit_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_occurrence where person_id  is not null and visit_start_date between  '20100101' and '20211231' ) d  ,(select sum(visit_source_concept_id) as ave from visit_occurrence where  visit_source_concept_id is not null and visit_start_date between  '20100101' and '20211231') e   ,(select min(visit_source_concept_id) as min_vl from visit_occurrence where  visit_source_concept_id is not null and visit_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_source_concept_id order by visit_source_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_occurrence where visit_source_concept_id is not null and visit_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_source_concept_id order by visit_source_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_occurrence where visit_source_concept_id is not null and visit_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_source_concept_id order by visit_source_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_occurrence where visit_source_concept_id is not null and visit_start_date between  '20100101' and '20211231') a) i  ,(select max(visit_source_concept_id) as n4_qrtl_cnt from visit_occurrence where  visit_source_concept_id is not null and visit_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_source_concept_id as mode_vl, count(visit_source_concept_id) as mode_cnt from visit_occurrence where  visit_source_concept_id is not null  and visit_start_date between  '20100101' and '20211231' group by visit_source_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98030' as tbl_id, '9803013' as col_id,  13 as col_seq from visit_occurrence where visit_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_occurrence where  admitting_source_concept_id is not null and visit_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_occurrence where  admitting_source_concept_id is null and visit_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_occurrence where person_id  is not null and visit_start_date between  '20100101' and '20211231' ) d  ,(select sum(admitting_source_concept_id) as ave from visit_occurrence where  admitting_source_concept_id is not null and visit_start_date between  '20100101' and '20211231') e   ,(select min(admitting_source_concept_id) as min_vl from visit_occurrence where  admitting_source_concept_id is not null and visit_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(admitting_source_concept_id order by admitting_source_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_occurrence where admitting_source_concept_id is not null and visit_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(admitting_source_concept_id order by admitting_source_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_occurrence where admitting_source_concept_id is not null and visit_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(admitting_source_concept_id order by admitting_source_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_occurrence where admitting_source_concept_id is not null and visit_start_date between  '20100101' and '20211231') a) i  ,(select max(admitting_source_concept_id) as n4_qrtl_cnt from visit_occurrence where  admitting_source_concept_id is not null and visit_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select admitting_source_concept_id as mode_vl, count(admitting_source_concept_id) as mode_cnt from visit_occurrence where  admitting_source_concept_id is not null  and visit_start_date between  '20100101' and '20211231' group by admitting_source_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98030' as tbl_id, '9803015' as col_id,  15 as col_seq from visit_occurrence where visit_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_occurrence where  discharge_to_concept_id is not null and visit_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_occurrence where  discharge_to_concept_id is null and visit_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_occurrence where person_id  is not null and visit_start_date between  '20100101' and '20211231' ) d  ,(select sum(discharge_to_concept_id) as ave from visit_occurrence where  discharge_to_concept_id is not null and visit_start_date between  '20100101' and '20211231') e   ,(select min(discharge_to_concept_id) as min_vl from visit_occurrence where  discharge_to_concept_id is not null and visit_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(discharge_to_concept_id order by discharge_to_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_occurrence where discharge_to_concept_id is not null and visit_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(discharge_to_concept_id order by discharge_to_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_occurrence where discharge_to_concept_id is not null and visit_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(discharge_to_concept_id order by discharge_to_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_occurrence where discharge_to_concept_id is not null and visit_start_date between  '20100101' and '20211231') a) i  ,(select max(discharge_to_concept_id) as n4_qrtl_cnt from visit_occurrence where  discharge_to_concept_id is not null and visit_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select discharge_to_concept_id as mode_vl, count(discharge_to_concept_id) as mode_cnt from visit_occurrence where  discharge_to_concept_id is not null  and visit_start_date between  '20100101' and '20211231' group by discharge_to_concept_id ) a group by a.mode_vl limit 1) k ;
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98030' as tbl_id, '9803017' as col_id,  17 as col_seq from visit_occurrence where visit_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_occurrence where  preceding_visit_occurrence_id is not null and visit_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_occurrence where  preceding_visit_occurrence_id is null and visit_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_occurrence where person_id  is not null and visit_start_date between  '20100101' and '20211231' ) d  ,(select sum(preceding_visit_occurrence_id) as ave from visit_occurrence where  preceding_visit_occurrence_id is not null and visit_start_date between  '20100101' and '20211231') e   ,(select min(preceding_visit_occurrence_id) as min_vl from visit_occurrence where  preceding_visit_occurrence_id is not null and visit_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(preceding_visit_occurrence_id order by preceding_visit_occurrence_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_occurrence where preceding_visit_occurrence_id is not null and visit_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(preceding_visit_occurrence_id order by preceding_visit_occurrence_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_occurrence where preceding_visit_occurrence_id is not null and visit_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(preceding_visit_occurrence_id order by preceding_visit_occurrence_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_occurrence where preceding_visit_occurrence_id is not null and visit_start_date between  '20100101' and '20211231') a) i  ,(select max(preceding_visit_occurrence_id) as n4_qrtl_cnt from visit_occurrence where  preceding_visit_occurrence_id is not null and visit_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select preceding_visit_occurrence_id as mode_vl, count(preceding_visit_occurrence_id) as mode_cnt from visit_occurrence where  preceding_visit_occurrence_id is not null  and visit_start_date between  '20100101' and '20211231' group by preceding_visit_occurrence_id ) a group by a.mode_vl limit 1) k ;*/
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt   ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211235'  as coll_end_ymd ,current_timestamp as crtn_dt from (select '9999' as hosp_cd,'98040' as tbl_id, '9804001' as col_id,  1 as col_seq from visit_detail where visit_detail_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_detail where  visit_detail_id is not null and visit_detail_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_detail where  visit_detail_id is null and visit_detail_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_detail where person_id  is not null and visit_detail_start_date between  '20100101' and '20211231' ) d ;        
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98040' as tbl_id, '9804002' as col_id,  2 as col_seq from visit_detail where visit_detail_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_detail where  person_id is not null and visit_detail_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_detail where  person_id is null and visit_detail_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_detail where person_id  is not null and visit_detail_start_date between  '20100101' and '20211231' ) d  ,(select sum(person_id) as ave from visit_detail where  person_id is not null and visit_detail_start_date between  '20100101' and '20211231') e   ,(select min(person_id) as min_vl from visit_detail where  person_id is not null and visit_detail_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_detail where person_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_detail where person_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_detail where person_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) i  ,(select max(person_id) as n4_qrtl_cnt from visit_detail where  person_id is not null and visit_detail_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select person_id as mode_vl, count(person_id) as mode_cnt from visit_detail where  person_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by person_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98040' as tbl_id, '9804003' as col_id,  3 as col_seq from visit_detail where visit_detail_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_detail where  visit_detail_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_detail where  visit_detail_concept_id is null and visit_detail_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_detail where person_id  is not null and visit_detail_start_date between  '20100101' and '20211231' ) d  ,(select sum(visit_detail_concept_id) as ave from visit_detail where  visit_detail_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') e   ,(select min(visit_detail_concept_id) as min_vl from visit_detail where  visit_detail_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_concept_id order by visit_detail_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_detail where visit_detail_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_concept_id order by visit_detail_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_detail where visit_detail_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_concept_id order by visit_detail_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_detail where visit_detail_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) i  ,(select max(visit_detail_concept_id) as n4_qrtl_cnt from visit_detail where  visit_detail_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_detail_concept_id as mode_vl, count(visit_detail_concept_id) as mode_cnt from visit_detail where  visit_detail_concept_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by visit_detail_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98040' as tbl_id, '9804008' as col_id,  8 as col_seq from visit_detail where visit_detail_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_detail where  visit_detail_type_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_detail where  visit_detail_type_concept_id is null and visit_detail_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_detail where person_id  is not null and visit_detail_start_date between  '20100101' and '20211231' ) d  ,(select sum(visit_detail_type_concept_id) as ave from visit_detail where  visit_detail_type_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') e   ,(select min(visit_detail_type_concept_id) as min_vl from visit_detail where  visit_detail_type_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_type_concept_id order by visit_detail_type_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_detail where visit_detail_type_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_type_concept_id order by visit_detail_type_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_detail where visit_detail_type_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_type_concept_id order by visit_detail_type_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_detail where visit_detail_type_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) i  ,(select max(visit_detail_type_concept_id) as n4_qrtl_cnt from visit_detail where  visit_detail_type_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_detail_type_concept_id as mode_vl, count(visit_detail_type_concept_id) as mode_cnt from visit_detail where  visit_detail_type_concept_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by visit_detail_type_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98040' as tbl_id, '9804009' as col_id,  9 as col_seq from visit_detail where visit_detail_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_detail where  provider_id is not null and visit_detail_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_detail where  provider_id is null and visit_detail_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_detail where person_id  is not null and visit_detail_start_date between  '20100101' and '20211231' ) d  ,(select sum(provider_id) as ave from visit_detail where  provider_id is not null and visit_detail_start_date between  '20100101' and '20211231') e   ,(select min(provider_id) as min_vl from visit_detail where  provider_id is not null and visit_detail_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_detail where provider_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_detail where provider_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_detail where provider_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) i  ,(select max(provider_id) as n4_qrtl_cnt from visit_detail where  provider_id is not null and visit_detail_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select provider_id as mode_vl, count(provider_id) as mode_cnt from visit_detail where  provider_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by provider_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98040' as tbl_id, '9804010' as col_id,  10 as col_seq from visit_detail where visit_detail_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_detail where  care_site_id is not null and visit_detail_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_detail where  care_site_id is null and visit_detail_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_detail where person_id  is not null and visit_detail_start_date between  '20100101' and '20211231' ) d  ,(select sum(care_site_id) as ave from visit_detail where  care_site_id is not null and visit_detail_start_date between  '20100101' and '20211231') e   ,(select min(care_site_id) as min_vl from visit_detail where  care_site_id is not null and visit_detail_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(care_site_id order by care_site_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_detail where care_site_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(care_site_id order by care_site_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_detail where care_site_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(care_site_id order by care_site_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_detail where care_site_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) i  ,(select max(care_site_id) as n4_qrtl_cnt from visit_detail where  care_site_id is not null and visit_detail_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select care_site_id as mode_vl, count(care_site_id) as mode_cnt from visit_detail where  care_site_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by care_site_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98040' as tbl_id, '9804012' as col_id,  12 as col_seq from visit_detail where visit_detail_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_detail where  visit_detail_source_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_detail where  visit_detail_source_concept_id is null and visit_detail_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_detail where person_id  is not null and visit_detail_start_date between  '20100101' and '20211231' ) d  ,(select sum(visit_detail_source_concept_id) as ave from visit_detail where  visit_detail_source_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') e   ,(select min(visit_detail_source_concept_id) as min_vl from visit_detail where  visit_detail_source_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_source_concept_id order by visit_detail_source_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_detail where visit_detail_source_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_source_concept_id order by visit_detail_source_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_detail where visit_detail_source_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_source_concept_id order by visit_detail_source_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_detail where visit_detail_source_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) i  ,(select max(visit_detail_source_concept_id) as n4_qrtl_cnt from visit_detail where  visit_detail_source_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_detail_source_concept_id as mode_vl, count(visit_detail_source_concept_id) as mode_cnt from visit_detail where  visit_detail_source_concept_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by visit_detail_source_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98040' as tbl_id, '9804014' as col_id,  14 as col_seq from visit_detail where visit_detail_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_detail where  admitting_source_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_detail where  admitting_source_concept_id is null and visit_detail_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_detail where person_id  is not null and visit_detail_start_date between  '20100101' and '20211231' ) d  ,(select sum(admitting_source_concept_id) as ave from visit_detail where  admitting_source_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') e   ,(select min(admitting_source_concept_id) as min_vl from visit_detail where  admitting_source_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(admitting_source_concept_id order by admitting_source_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_detail where admitting_source_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(admitting_source_concept_id order by admitting_source_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_detail where admitting_source_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(admitting_source_concept_id order by admitting_source_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_detail where admitting_source_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) i  ,(select max(admitting_source_concept_id) as n4_qrtl_cnt from visit_detail where  admitting_source_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select admitting_source_concept_id as mode_vl, count(admitting_source_concept_id) as mode_cnt from visit_detail where  admitting_source_concept_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by admitting_source_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98040' as tbl_id, '9804016' as col_id,  16 as col_seq from visit_detail where visit_detail_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_detail where  discharge_to_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_detail where  discharge_to_concept_id is null and visit_detail_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_detail where person_id  is not null and visit_detail_start_date between  '20100101' and '20211231' ) d  ,(select sum(discharge_to_concept_id) as ave from visit_detail where  discharge_to_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') e   ,(select min(discharge_to_concept_id) as min_vl from visit_detail where  discharge_to_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(discharge_to_concept_id order by discharge_to_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_detail where discharge_to_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(discharge_to_concept_id order by discharge_to_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_detail where discharge_to_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(discharge_to_concept_id order by discharge_to_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_detail where discharge_to_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) i  ,(select max(discharge_to_concept_id) as n4_qrtl_cnt from visit_detail where  discharge_to_concept_id is not null and visit_detail_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select discharge_to_concept_id as mode_vl, count(discharge_to_concept_id) as mode_cnt from visit_detail where  discharge_to_concept_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by discharge_to_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98040' as tbl_id, '9804017' as col_id,  17 as col_seq from visit_detail where visit_detail_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_detail where  preceding_visit_detail_id is not null and visit_detail_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_detail where  preceding_visit_detail_id is null and visit_detail_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_detail where person_id  is not null and visit_detail_start_date between  '20100101' and '20211231' ) d  ,(select sum(preceding_visit_detail_id) as ave from visit_detail where  preceding_visit_detail_id is not null and visit_detail_start_date between  '20100101' and '20211231') e   ,(select min(preceding_visit_detail_id) as min_vl from visit_detail where  preceding_visit_detail_id is not null and visit_detail_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(preceding_visit_detail_id order by preceding_visit_detail_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_detail where preceding_visit_detail_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(preceding_visit_detail_id order by preceding_visit_detail_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_detail where preceding_visit_detail_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(preceding_visit_detail_id order by preceding_visit_detail_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_detail where preceding_visit_detail_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) i  ,(select max(preceding_visit_detail_id) as n4_qrtl_cnt from visit_detail where  preceding_visit_detail_id is not null and visit_detail_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select preceding_visit_detail_id as mode_vl, count(preceding_visit_detail_id) as mode_cnt from visit_detail where  preceding_visit_detail_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by preceding_visit_detail_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98040' as tbl_id, '9804018' as col_id,  18 as col_seq from visit_detail where visit_detail_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_detail where  visit_detail_parent_id is not null and visit_detail_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_detail where  visit_detail_parent_id is null and visit_detail_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_detail where person_id  is not null and visit_detail_start_date between  '20100101' and '20211231' ) d  ,(select sum(visit_detail_parent_id) as ave from visit_detail where  visit_detail_parent_id is not null and visit_detail_start_date between  '20100101' and '20211231') e   ,(select min(visit_detail_parent_id) as min_vl from visit_detail where  visit_detail_parent_id is not null and visit_detail_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_parent_id order by visit_detail_parent_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_detail where visit_detail_parent_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_parent_id order by visit_detail_parent_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_detail where visit_detail_parent_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_parent_id order by visit_detail_parent_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_detail where visit_detail_parent_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) i  ,(select max(visit_detail_parent_id) as n4_qrtl_cnt from visit_detail where  visit_detail_parent_id is not null and visit_detail_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_detail_parent_id as mode_vl, count(visit_detail_parent_id) as mode_cnt from visit_detail where  visit_detail_parent_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by visit_detail_parent_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98040' as tbl_id, '9804019' as col_id,  19 as col_seq from visit_detail where visit_detail_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from visit_detail where  visit_occurrence_id is not null and visit_detail_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from visit_detail where  visit_occurrence_id is null and visit_detail_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from visit_detail where person_id  is not null and visit_detail_start_date between  '20100101' and '20211231' ) d  ,(select sum(visit_occurrence_id) as ave from visit_detail where  visit_occurrence_id is not null and visit_detail_start_date between  '20100101' and '20211231') e   ,(select min(visit_occurrence_id) as min_vl from visit_detail where  visit_occurrence_id is not null and visit_detail_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from visit_detail where visit_occurrence_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from visit_detail where visit_occurrence_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from visit_detail where visit_occurrence_id is not null and visit_detail_start_date between  '20100101' and '20211231') a) i  ,(select max(visit_occurrence_id) as n4_qrtl_cnt from visit_detail where  visit_occurrence_id is not null and visit_detail_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_occurrence_id as mode_vl, count(visit_occurrence_id) as mode_cnt from visit_detail where  visit_occurrence_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by visit_occurrence_id ) a group by a.mode_vl limit 1) k ;
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt   ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211235'  as coll_end_ymd ,current_timestamp as crtn_dt from (select '9999' as hosp_cd,'98050' as tbl_id, '9805001' as col_id,  1 as col_seq from condition_occurrence where condition_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from condition_occurrence where  condition_occurrence_id is not null and condition_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from condition_occurrence where  condition_occurrence_id is null and condition_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from condition_occurrence where person_id  is not null and condition_start_date between  '20100101' and '20211231' ) d ;        */
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98050' as tbl_id, '9805002' as col_id,  2 as col_seq from condition_occurrence where condition_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from condition_occurrence where  person_id is not null and condition_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from condition_occurrence where  person_id is null and condition_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from condition_occurrence where person_id  is not null and condition_start_date between  '20100101' and '20211231' ) d  ,(select sum(person_id) as ave from condition_occurrence where  person_id is not null and condition_start_date between  '20100101' and '20211231') e   ,(select min(person_id) as min_vl from condition_occurrence where  person_id is not null and condition_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from condition_occurrence where person_id is not null and condition_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from condition_occurrence where person_id is not null and condition_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from condition_occurrence where person_id is not null and condition_start_date between  '20100101' and '20211231') a) i  ,(select max(person_id) as n4_qrtl_cnt from condition_occurrence where  person_id is not null and condition_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select person_id as mode_vl, count(person_id) as mode_cnt from condition_occurrence where  person_id is not null  and condition_start_date between  '20100101' and '20211231' group by person_id ) a group by a.mode_vl limit 1) k ;*/
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98050' as tbl_id, '9805003' as col_id,  3 as col_seq from condition_occurrence where condition_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from condition_occurrence where  condition_concept_id is not null and condition_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from condition_occurrence where  condition_concept_id is null and condition_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from condition_occurrence where person_id  is not null and condition_start_date between  '20100101' and '20211231' ) d  ,(select sum(condition_concept_id) as ave from condition_occurrence where  condition_concept_id is not null and condition_start_date between  '20100101' and '20211231') e   ,(select min(condition_concept_id) as min_vl from condition_occurrence where  condition_concept_id is not null and condition_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(condition_concept_id order by condition_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from condition_occurrence where condition_concept_id is not null and condition_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(condition_concept_id order by condition_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from condition_occurrence where condition_concept_id is not null and condition_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(condition_concept_id order by condition_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from condition_occurrence where condition_concept_id is not null and condition_start_date between  '20100101' and '20211231') a) i  ,(select max(condition_concept_id) as n4_qrtl_cnt from condition_occurrence where  condition_concept_id is not null and condition_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select condition_concept_id as mode_vl, count(condition_concept_id) as mode_cnt from condition_occurrence where  condition_concept_id is not null  and condition_start_date between  '20100101' and '20211231' group by condition_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98050' as tbl_id, '9805008' as col_id,  8 as col_seq from condition_occurrence where condition_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from condition_occurrence where  condition_type_concept_id is not null and condition_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from condition_occurrence where  condition_type_concept_id is null and condition_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from condition_occurrence where person_id  is not null and condition_start_date between  '20100101' and '20211231' ) d  ,(select sum(condition_type_concept_id) as ave from condition_occurrence where  condition_type_concept_id is not null and condition_start_date between  '20100101' and '20211231') e   ,(select min(condition_type_concept_id) as min_vl from condition_occurrence where  condition_type_concept_id is not null and condition_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(condition_type_concept_id order by condition_type_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from condition_occurrence where condition_type_concept_id is not null and condition_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(condition_type_concept_id order by condition_type_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from condition_occurrence where condition_type_concept_id is not null and condition_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(condition_type_concept_id order by condition_type_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from condition_occurrence where condition_type_concept_id is not null and condition_start_date between  '20100101' and '20211231') a) i  ,(select max(condition_type_concept_id) as n4_qrtl_cnt from condition_occurrence where  condition_type_concept_id is not null and condition_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select condition_type_concept_id as mode_vl, count(condition_type_concept_id) as mode_cnt from condition_occurrence where  condition_type_concept_id is not null  and condition_start_date between  '20100101' and '20211231' group by condition_type_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98050' as tbl_id, '9805009' as col_id,  9 as col_seq from condition_occurrence where condition_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from condition_occurrence where  condition_status_concept_id is not null and condition_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from condition_occurrence where  condition_status_concept_id is null and condition_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from condition_occurrence where person_id  is not null and condition_start_date between  '20100101' and '20211231' ) d  ,(select sum(condition_status_concept_id) as ave from condition_occurrence where  condition_status_concept_id is not null and condition_start_date between  '20100101' and '20211231') e   ,(select min(condition_status_concept_id) as min_vl from condition_occurrence where  condition_status_concept_id is not null and condition_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(condition_status_concept_id order by condition_status_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from condition_occurrence where condition_status_concept_id is not null and condition_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(condition_status_concept_id order by condition_status_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from condition_occurrence where condition_status_concept_id is not null and condition_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(condition_status_concept_id order by condition_status_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from condition_occurrence where condition_status_concept_id is not null and condition_start_date between  '20100101' and '20211231') a) i  ,(select max(condition_status_concept_id) as n4_qrtl_cnt from condition_occurrence where  condition_status_concept_id is not null and condition_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select condition_status_concept_id as mode_vl, count(condition_status_concept_id) as mode_cnt from condition_occurrence where  condition_status_concept_id is not null  and condition_start_date between  '20100101' and '20211231' group by condition_status_concept_id ) a group by a.mode_vl limit 1) k ;
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98050' as tbl_id, '9805011' as col_id,  11 as col_seq from condition_occurrence where condition_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from condition_occurrence where  provider_id is not null and condition_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from condition_occurrence where  provider_id is null and condition_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from condition_occurrence where person_id  is not null and condition_start_date between  '20100101' and '20211231' ) d  ,(select sum(provider_id) as ave from condition_occurrence where  provider_id is not null and condition_start_date between  '20100101' and '20211231') e   ,(select min(provider_id) as min_vl from condition_occurrence where  provider_id is not null and condition_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from condition_occurrence where provider_id is not null and condition_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from condition_occurrence where provider_id is not null and condition_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from condition_occurrence where provider_id is not null and condition_start_date between  '20100101' and '20211231') a) i  ,(select max(provider_id) as n4_qrtl_cnt from condition_occurrence where  provider_id is not null and condition_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select provider_id as mode_vl, count(provider_id) as mode_cnt from condition_occurrence where  provider_id is not null  and condition_start_date between  '20100101' and '20211231' group by provider_id ) a group by a.mode_vl limit 1) k ;*/
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98050' as tbl_id, '9805012' as col_id,  12 as col_seq from condition_occurrence where condition_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from condition_occurrence where  visit_occurrence_id is not null and condition_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from condition_occurrence where  visit_occurrence_id is null and condition_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from condition_occurrence where person_id  is not null and condition_start_date between  '20100101' and '20211231' ) d  ,(select sum(visit_occurrence_id) as ave from condition_occurrence where  visit_occurrence_id is not null and condition_start_date between  '20100101' and '20211231') e   ,(select min(visit_occurrence_id) as min_vl from condition_occurrence where  visit_occurrence_id is not null and condition_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from condition_occurrence where visit_occurrence_id is not null and condition_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from condition_occurrence where visit_occurrence_id is not null and condition_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from condition_occurrence where visit_occurrence_id is not null and condition_start_date between  '20100101' and '20211231') a) i  ,(select max(visit_occurrence_id) as n4_qrtl_cnt from condition_occurrence where  visit_occurrence_id is not null and condition_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_occurrence_id as mode_vl, count(visit_occurrence_id) as mode_cnt from condition_occurrence where  visit_occurrence_id is not null  and condition_start_date between  '20100101' and '20211231' group by visit_occurrence_id ) a group by a.mode_vl limit 1) k ;*/
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98050' as tbl_id, '9805013' as col_id,  13 as col_seq from condition_occurrence where condition_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from condition_occurrence where  visit_detail_id is not null and condition_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from condition_occurrence where  visit_detail_id is null and condition_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from condition_occurrence where person_id  is not null and condition_start_date between  '20100101' and '20211231' ) d  ,(select sum(visit_detail_id) as ave from condition_occurrence where  visit_detail_id is not null and condition_start_date between  '20100101' and '20211231') e   ,(select min(visit_detail_id) as min_vl from condition_occurrence where  visit_detail_id is not null and condition_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from condition_occurrence where visit_detail_id is not null and condition_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from condition_occurrence where visit_detail_id is not null and condition_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from condition_occurrence where visit_detail_id is not null and condition_start_date between  '20100101' and '20211231') a) i  ,(select max(visit_detail_id) as n4_qrtl_cnt from condition_occurrence where  visit_detail_id is not null and condition_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_detail_id as mode_vl, count(visit_detail_id) as mode_cnt from condition_occurrence where  visit_detail_id is not null  and condition_start_date between  '20100101' and '20211231' group by visit_detail_id ) a group by a.mode_vl limit 1) k ;*/
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98050' as tbl_id, '9805015' as col_id,  15 as col_seq from condition_occurrence where condition_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from condition_occurrence where  condition_source_concept_id is not null and condition_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from condition_occurrence where  condition_source_concept_id is null and condition_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from condition_occurrence where person_id  is not null and condition_start_date between  '20100101' and '20211231' ) d  ,(select sum(condition_source_concept_id) as ave from condition_occurrence where  condition_source_concept_id is not null and condition_start_date between  '20100101' and '20211231') e   ,(select min(condition_source_concept_id) as min_vl from condition_occurrence where  condition_source_concept_id is not null and condition_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(condition_source_concept_id order by condition_source_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from condition_occurrence where condition_source_concept_id is not null and condition_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(condition_source_concept_id order by condition_source_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from condition_occurrence where condition_source_concept_id is not null and condition_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(condition_source_concept_id order by condition_source_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from condition_occurrence where condition_source_concept_id is not null and condition_start_date between  '20100101' and '20211231') a) i  ,(select max(condition_source_concept_id) as n4_qrtl_cnt from condition_occurrence where  condition_source_concept_id is not null and condition_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select condition_source_concept_id as mode_vl, count(condition_source_concept_id) as mode_cnt from condition_occurrence where  condition_source_concept_id is not null  and condition_start_date between  '20100101' and '20211231' group by condition_source_concept_id ) a group by a.mode_vl limit 1) k ;
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt   ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211235'  as coll_end_ymd ,current_timestamp as crtn_dt from (select '9999' as hosp_cd,'98060' as tbl_id, '9806001' as col_id,  1 as col_seq from drug_exposure where drug_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from drug_exposure where  drug_exposure_id is not null and drug_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from drug_exposure where  drug_exposure_id is null and drug_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from drug_exposure where person_id  is not null and drug_exposure_start_date between  '20100101' and '20211231' ) d ;       */
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98060' as tbl_id, '9806002' as col_id,  2 as col_seq from drug_exposure where drug_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from drug_exposure where  person_id is not null and drug_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from drug_exposure where  person_id is null and drug_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from drug_exposure where person_id  is not null and drug_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(person_id) as ave from drug_exposure where  person_id is not null and drug_exposure_start_date between  '20100101' and '20211231') e   ,(select min(person_id) as min_vl from drug_exposure where  person_id is not null and drug_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from drug_exposure where person_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from drug_exposure where person_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from drug_exposure where person_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(person_id) as n4_qrtl_cnt from drug_exposure where  person_id is not null and drug_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select person_id as mode_vl, count(person_id) as mode_cnt from drug_exposure where  person_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by person_id ) a group by a.mode_vl limit 1) k ;*/
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98060' as tbl_id, '9806003' as col_id,  3 as col_seq from drug_exposure where drug_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from drug_exposure where  drug_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from drug_exposure where  drug_concept_id is null and drug_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from drug_exposure where person_id  is not null and drug_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(drug_concept_id) as ave from drug_exposure where  drug_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') e   ,(select min(drug_concept_id) as min_vl from drug_exposure where  drug_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(drug_concept_id order by drug_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from drug_exposure where drug_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(drug_concept_id order by drug_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from drug_exposure where drug_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(drug_concept_id order by drug_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from drug_exposure where drug_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(drug_concept_id) as n4_qrtl_cnt from drug_exposure where  drug_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select drug_concept_id as mode_vl, count(drug_concept_id) as mode_cnt from drug_exposure where  drug_concept_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by drug_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98060' as tbl_id, '9806009' as col_id,  9 as col_seq from drug_exposure where drug_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from drug_exposure where  drug_type_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from drug_exposure where  drug_type_concept_id is null and drug_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from drug_exposure where person_id  is not null and drug_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(drug_type_concept_id) as ave from drug_exposure where  drug_type_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') e   ,(select min(drug_type_concept_id) as min_vl from drug_exposure where  drug_type_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(drug_type_concept_id order by drug_type_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from drug_exposure where drug_type_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(drug_type_concept_id order by drug_type_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from drug_exposure where drug_type_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(drug_type_concept_id order by drug_type_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from drug_exposure where drug_type_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(drug_type_concept_id) as n4_qrtl_cnt from drug_exposure where  drug_type_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select drug_type_concept_id as mode_vl, count(drug_type_concept_id) as mode_cnt from drug_exposure where  drug_type_concept_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by drug_type_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98060' as tbl_id, '9806011' as col_id,  11 as col_seq from drug_exposure where drug_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from drug_exposure where  refills is not null and drug_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from drug_exposure where  refills is null and drug_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from drug_exposure where person_id  is not null and drug_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(refills) as ave from drug_exposure where  refills is not null and drug_exposure_start_date between  '20100101' and '20211231') e   ,(select min(refills) as min_vl from drug_exposure where  refills is not null and drug_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(refills order by refills separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from drug_exposure where refills is not null and drug_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(refills order by refills separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from drug_exposure where refills is not null and drug_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(refills order by refills separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from drug_exposure where refills is not null and drug_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(refills) as n4_qrtl_cnt from drug_exposure where  refills is not null and drug_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select refills as mode_vl, count(refills) as mode_cnt from drug_exposure where  refills is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by refills ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98060' as tbl_id, '9806012' as col_id,  12 as col_seq from drug_exposure where drug_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from drug_exposure where  quantity is not null and drug_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from drug_exposure where  quantity is null and drug_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from drug_exposure where person_id  is not null and drug_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(quantity) as ave from drug_exposure where  quantity is not null and drug_exposure_start_date between  '20100101' and '20211231') e   ,(select min(quantity) as min_vl from drug_exposure where  quantity is not null and drug_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(quantity order by quantity separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from drug_exposure where quantity is not null and drug_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(quantity order by quantity separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from drug_exposure where quantity is not null and drug_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(quantity order by quantity separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from drug_exposure where quantity is not null and drug_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(quantity) as n4_qrtl_cnt from drug_exposure where  quantity is not null and drug_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select quantity as mode_vl, count(quantity) as mode_cnt from drug_exposure where  quantity is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by quantity ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98060' as tbl_id, '9806013' as col_id,  13 as col_seq from drug_exposure where drug_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from drug_exposure where  days_supply is not null and drug_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from drug_exposure where  days_supply is null and drug_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from drug_exposure where person_id  is not null and drug_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(days_supply) as ave from drug_exposure where  days_supply is not null and drug_exposure_start_date between  '20100101' and '20211231') e   ,(select min(days_supply) as min_vl from drug_exposure where  days_supply is not null and drug_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(days_supply order by days_supply separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from drug_exposure where days_supply is not null and drug_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(days_supply order by days_supply separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from drug_exposure where days_supply is not null and drug_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(days_supply order by days_supply separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from drug_exposure where days_supply is not null and drug_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(days_supply) as n4_qrtl_cnt from drug_exposure where  days_supply is not null and drug_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select days_supply as mode_vl, count(days_supply) as mode_cnt from drug_exposure where  days_supply is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by days_supply ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98060' as tbl_id, '9806015' as col_id,  15 as col_seq from drug_exposure where drug_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from drug_exposure where  route_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from drug_exposure where  route_concept_id is null and drug_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from drug_exposure where person_id  is not null and drug_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(route_concept_id) as ave from drug_exposure where  route_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') e   ,(select min(route_concept_id) as min_vl from drug_exposure where  route_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(route_concept_id order by route_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from drug_exposure where route_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(route_concept_id order by route_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from drug_exposure where route_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(route_concept_id order by route_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from drug_exposure where route_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(route_concept_id) as n4_qrtl_cnt from drug_exposure where  route_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select route_concept_id as mode_vl, count(route_concept_id) as mode_cnt from drug_exposure where  route_concept_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by route_concept_id ) a group by a.mode_vl limit 1) k ;
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98060' as tbl_id, '9806017' as col_id,  17 as col_seq from drug_exposure where drug_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from drug_exposure where  provider_id is not null and drug_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from drug_exposure where  provider_id is null and drug_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from drug_exposure where person_id  is not null and drug_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(provider_id) as ave from drug_exposure where  provider_id is not null and drug_exposure_start_date between  '20100101' and '20211231') e   ,(select min(provider_id) as min_vl from drug_exposure where  provider_id is not null and drug_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from drug_exposure where provider_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from drug_exposure where provider_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from drug_exposure where provider_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(provider_id) as n4_qrtl_cnt from drug_exposure where  provider_id is not null and drug_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select provider_id as mode_vl, count(provider_id) as mode_cnt from drug_exposure where  provider_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by provider_id ) a group by a.mode_vl limit 1) k ;*/
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98060' as tbl_id, '9806018' as col_id,  18 as col_seq from drug_exposure where drug_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from drug_exposure where  visit_occurrence_id is not null and drug_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from drug_exposure where  visit_occurrence_id is null and drug_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from drug_exposure where person_id  is not null and drug_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(visit_occurrence_id) as ave from drug_exposure where  visit_occurrence_id is not null and drug_exposure_start_date between  '20100101' and '20211231') e   ,(select min(visit_occurrence_id) as min_vl from drug_exposure where  visit_occurrence_id is not null and drug_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from drug_exposure where visit_occurrence_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from drug_exposure where visit_occurrence_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from drug_exposure where visit_occurrence_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(visit_occurrence_id) as n4_qrtl_cnt from drug_exposure where  visit_occurrence_id is not null and drug_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_occurrence_id as mode_vl, count(visit_occurrence_id) as mode_cnt from drug_exposure where  visit_occurrence_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by visit_occurrence_id ) a group by a.mode_vl limit 1) k ;*/
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98060' as tbl_id, '9806019' as col_id,  19 as col_seq from drug_exposure where drug_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from drug_exposure where  visit_detail_id is not null and drug_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from drug_exposure where  visit_detail_id is null and drug_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from drug_exposure where person_id  is not null and drug_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(visit_detail_id) as ave from drug_exposure where  visit_detail_id is not null and drug_exposure_start_date between  '20100101' and '20211231') e   ,(select min(visit_detail_id) as min_vl from drug_exposure where  visit_detail_id is not null and drug_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from drug_exposure where visit_detail_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from drug_exposure where visit_detail_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from drug_exposure where visit_detail_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(visit_detail_id) as n4_qrtl_cnt from drug_exposure where  visit_detail_id is not null and drug_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_detail_id as mode_vl, count(visit_detail_id) as mode_cnt from drug_exposure where  visit_detail_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by visit_detail_id ) a group by a.mode_vl limit 1) k ;*/
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98060' as tbl_id, '9806021' as col_id,  21 as col_seq from drug_exposure where drug_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from drug_exposure where  drug_source_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from drug_exposure where  drug_source_concept_id is null and drug_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from drug_exposure where person_id  is not null and drug_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(drug_source_concept_id) as ave from drug_exposure where  drug_source_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') e   ,(select min(drug_source_concept_id) as min_vl from drug_exposure where  drug_source_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(drug_source_concept_id order by drug_source_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from drug_exposure where drug_source_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(drug_source_concept_id order by drug_source_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from drug_exposure where drug_source_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(drug_source_concept_id order by drug_source_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from drug_exposure where drug_source_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(drug_source_concept_id) as n4_qrtl_cnt from drug_exposure where  drug_source_concept_id is not null and drug_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select drug_source_concept_id as mode_vl, count(drug_source_concept_id) as mode_cnt from drug_exposure where  drug_source_concept_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by drug_source_concept_id ) a group by a.mode_vl limit 1) k ;
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt   ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211235'  as coll_end_ymd ,current_timestamp as crtn_dt from (select '9999' as hosp_cd,'98070' as tbl_id, '9807001' as col_id,  1 as col_seq from procedure_occurrence where procedure_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from procedure_occurrence where  procedure_occurrence_id is not null and procedure_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from procedure_occurrence where  procedure_occurrence_id is null and procedure_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from procedure_occurrence where person_id  is not null and procedure_date between  '20100101' and '20211231' ) d ;       */
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98070' as tbl_id, '9807002' as col_id,  2 as col_seq from procedure_occurrence where procedure_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from procedure_occurrence where  person_id is not null and procedure_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from procedure_occurrence where  person_id is null and procedure_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from procedure_occurrence where person_id  is not null and procedure_date between  '20100101' and '20211231' ) d  ,(select sum(person_id) as ave from procedure_occurrence where  person_id is not null and procedure_date between  '20100101' and '20211231') e   ,(select min(person_id) as min_vl from procedure_occurrence where  person_id is not null and procedure_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from procedure_occurrence where person_id is not null and procedure_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from procedure_occurrence where person_id is not null and procedure_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from procedure_occurrence where person_id is not null and procedure_date between  '20100101' and '20211231') a) i  ,(select max(person_id) as n4_qrtl_cnt from procedure_occurrence where  person_id is not null and procedure_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select person_id as mode_vl, count(person_id) as mode_cnt from procedure_occurrence where  person_id is not null  and procedure_date between  '20100101' and '20211231' group by person_id ) a group by a.mode_vl limit 1) k ;*/
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98070' as tbl_id, '9807003' as col_id,  3 as col_seq from procedure_occurrence where procedure_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from procedure_occurrence where  procedure_concept_id is not null and procedure_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from procedure_occurrence where  procedure_concept_id is null and procedure_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from procedure_occurrence where person_id  is not null and procedure_date between  '20100101' and '20211231' ) d  ,(select sum(procedure_concept_id) as ave from procedure_occurrence where  procedure_concept_id is not null and procedure_date between  '20100101' and '20211231') e   ,(select min(procedure_concept_id) as min_vl from procedure_occurrence where  procedure_concept_id is not null and procedure_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(procedure_concept_id order by procedure_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from procedure_occurrence where procedure_concept_id is not null and procedure_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(procedure_concept_id order by procedure_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from procedure_occurrence where procedure_concept_id is not null and procedure_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(procedure_concept_id order by procedure_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from procedure_occurrence where procedure_concept_id is not null and procedure_date between  '20100101' and '20211231') a) i  ,(select max(procedure_concept_id) as n4_qrtl_cnt from procedure_occurrence where  procedure_concept_id is not null and procedure_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select procedure_concept_id as mode_vl, count(procedure_concept_id) as mode_cnt from procedure_occurrence where  procedure_concept_id is not null  and procedure_date between  '20100101' and '20211231' group by procedure_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98070' as tbl_id, '9807006' as col_id,  6 as col_seq from procedure_occurrence where procedure_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from procedure_occurrence where  procedure_type_concept_id is not null and procedure_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from procedure_occurrence where  procedure_type_concept_id is null and procedure_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from procedure_occurrence where person_id  is not null and procedure_date between  '20100101' and '20211231' ) d  ,(select sum(procedure_type_concept_id) as ave from procedure_occurrence where  procedure_type_concept_id is not null and procedure_date between  '20100101' and '20211231') e   ,(select min(procedure_type_concept_id) as min_vl from procedure_occurrence where  procedure_type_concept_id is not null and procedure_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(procedure_type_concept_id order by procedure_type_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from procedure_occurrence where procedure_type_concept_id is not null and procedure_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(procedure_type_concept_id order by procedure_type_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from procedure_occurrence where procedure_type_concept_id is not null and procedure_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(procedure_type_concept_id order by procedure_type_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from procedure_occurrence where procedure_type_concept_id is not null and procedure_date between  '20100101' and '20211231') a) i  ,(select max(procedure_type_concept_id) as n4_qrtl_cnt from procedure_occurrence where  procedure_type_concept_id is not null and procedure_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select procedure_type_concept_id as mode_vl, count(procedure_type_concept_id) as mode_cnt from procedure_occurrence where  procedure_type_concept_id is not null  and procedure_date between  '20100101' and '20211231' group by procedure_type_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98070' as tbl_id, '9807007' as col_id,  7 as col_seq from procedure_occurrence where procedure_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from procedure_occurrence where  modifier_concept_id is not null and procedure_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from procedure_occurrence where  modifier_concept_id is null and procedure_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from procedure_occurrence where person_id  is not null and procedure_date between  '20100101' and '20211231' ) d  ,(select sum(modifier_concept_id) as ave from procedure_occurrence where  modifier_concept_id is not null and procedure_date between  '20100101' and '20211231') e   ,(select min(modifier_concept_id) as min_vl from procedure_occurrence where  modifier_concept_id is not null and procedure_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(modifier_concept_id order by modifier_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from procedure_occurrence where modifier_concept_id is not null and procedure_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(modifier_concept_id order by modifier_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from procedure_occurrence where modifier_concept_id is not null and procedure_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(modifier_concept_id order by modifier_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from procedure_occurrence where modifier_concept_id is not null and procedure_date between  '20100101' and '20211231') a) i  ,(select max(modifier_concept_id) as n4_qrtl_cnt from procedure_occurrence where  modifier_concept_id is not null and procedure_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select modifier_concept_id as mode_vl, count(modifier_concept_id) as mode_cnt from procedure_occurrence where  modifier_concept_id is not null  and procedure_date between  '20100101' and '20211231' group by modifier_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98070' as tbl_id, '9807008' as col_id,  8 as col_seq from procedure_occurrence where procedure_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from procedure_occurrence where  quantity is not null and procedure_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from procedure_occurrence where  quantity is null and procedure_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from procedure_occurrence where person_id  is not null and procedure_date between  '20100101' and '20211231' ) d  ,(select sum(quantity) as ave from procedure_occurrence where  quantity is not null and procedure_date between  '20100101' and '20211231') e   ,(select min(quantity) as min_vl from procedure_occurrence where  quantity is not null and procedure_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(quantity order by quantity separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from procedure_occurrence where quantity is not null and procedure_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(quantity order by quantity separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from procedure_occurrence where quantity is not null and procedure_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(quantity order by quantity separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from procedure_occurrence where quantity is not null and procedure_date between  '20100101' and '20211231') a) i  ,(select max(quantity) as n4_qrtl_cnt from procedure_occurrence where  quantity is not null and procedure_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select quantity as mode_vl, count(quantity) as mode_cnt from procedure_occurrence where  quantity is not null  and procedure_date between  '20100101' and '20211231' group by quantity ) a group by a.mode_vl limit 1) k ;
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98070' as tbl_id, '9807009' as col_id,  9 as col_seq from procedure_occurrence where procedure_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from procedure_occurrence where  provider_id is not null and procedure_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from procedure_occurrence where  provider_id is null and procedure_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from procedure_occurrence where person_id  is not null and procedure_date between  '20100101' and '20211231' ) d  ,(select sum(provider_id) as ave from procedure_occurrence where  provider_id is not null and procedure_date between  '20100101' and '20211231') e   ,(select min(provider_id) as min_vl from procedure_occurrence where  provider_id is not null and procedure_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from procedure_occurrence where provider_id is not null and procedure_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from procedure_occurrence where provider_id is not null and procedure_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from procedure_occurrence where provider_id is not null and procedure_date between  '20100101' and '20211231') a) i  ,(select max(provider_id) as n4_qrtl_cnt from procedure_occurrence where  provider_id is not null and procedure_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select provider_id as mode_vl, count(provider_id) as mode_cnt from procedure_occurrence where  provider_id is not null  and procedure_date between  '20100101' and '20211231' group by provider_id ) a group by a.mode_vl limit 1) k ;*/
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98070' as tbl_id, '9807010' as col_id,  10 as col_seq from procedure_occurrence where procedure_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from procedure_occurrence where  visit_occurrence_id is not null and procedure_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from procedure_occurrence where  visit_occurrence_id is null and procedure_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from procedure_occurrence where person_id  is not null and procedure_date between  '20100101' and '20211231' ) d  ,(select sum(visit_occurrence_id) as ave from procedure_occurrence where  visit_occurrence_id is not null and procedure_date between  '20100101' and '20211231') e   ,(select min(visit_occurrence_id) as min_vl from procedure_occurrence where  visit_occurrence_id is not null and procedure_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from procedure_occurrence where visit_occurrence_id is not null and procedure_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from procedure_occurrence where visit_occurrence_id is not null and procedure_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from procedure_occurrence where visit_occurrence_id is not null and procedure_date between  '20100101' and '20211231') a) i  ,(select max(visit_occurrence_id) as n4_qrtl_cnt from procedure_occurrence where  visit_occurrence_id is not null and procedure_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_occurrence_id as mode_vl, count(visit_occurrence_id) as mode_cnt from procedure_occurrence where  visit_occurrence_id is not null  and procedure_date between  '20100101' and '20211231' group by visit_occurrence_id ) a group by a.mode_vl limit 1) k ;*/
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98070' as tbl_id, '9807011' as col_id,  11 as col_seq from procedure_occurrence where procedure_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from procedure_occurrence where  visit_detail_id is not null and procedure_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from procedure_occurrence where  visit_detail_id is null and procedure_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from procedure_occurrence where person_id  is not null and procedure_date between  '20100101' and '20211231' ) d  ,(select sum(visit_detail_id) as ave from procedure_occurrence where  visit_detail_id is not null and procedure_date between  '20100101' and '20211231') e   ,(select min(visit_detail_id) as min_vl from procedure_occurrence where  visit_detail_id is not null and procedure_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from procedure_occurrence where visit_detail_id is not null and procedure_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from procedure_occurrence where visit_detail_id is not null and procedure_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from procedure_occurrence where visit_detail_id is not null and procedure_date between  '20100101' and '20211231') a) i  ,(select max(visit_detail_id) as n4_qrtl_cnt from procedure_occurrence where  visit_detail_id is not null and procedure_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_detail_id as mode_vl, count(visit_detail_id) as mode_cnt from procedure_occurrence where  visit_detail_id is not null  and procedure_date between  '20100101' and '20211231' group by visit_detail_id ) a group by a.mode_vl limit 1) k ;*/
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98070' as tbl_id, '9807013' as col_id,  13 as col_seq from procedure_occurrence where procedure_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from procedure_occurrence where  procedure_source_concept_id is not null and procedure_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from procedure_occurrence where  procedure_source_concept_id is null and procedure_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from procedure_occurrence where person_id  is not null and procedure_date between  '20100101' and '20211231' ) d  ,(select sum(procedure_source_concept_id) as ave from procedure_occurrence where  procedure_source_concept_id is not null and procedure_date between  '20100101' and '20211231') e   ,(select min(procedure_source_concept_id) as min_vl from procedure_occurrence where  procedure_source_concept_id is not null and procedure_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(procedure_source_concept_id order by procedure_source_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from procedure_occurrence where procedure_source_concept_id is not null and procedure_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(procedure_source_concept_id order by procedure_source_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from procedure_occurrence where procedure_source_concept_id is not null and procedure_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(procedure_source_concept_id order by procedure_source_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from procedure_occurrence where procedure_source_concept_id is not null and procedure_date between  '20100101' and '20211231') a) i  ,(select max(procedure_source_concept_id) as n4_qrtl_cnt from procedure_occurrence where  procedure_source_concept_id is not null and procedure_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select procedure_source_concept_id as mode_vl, count(procedure_source_concept_id) as mode_cnt from procedure_occurrence where  procedure_source_concept_id is not null  and procedure_date between  '20100101' and '20211231' group by procedure_source_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt   ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211235'  as coll_end_ymd ,current_timestamp as crtn_dt from (select '9999' as hosp_cd,'98080' as tbl_id, '9808001' as col_id,  1 as col_seq from device_exposure where device_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from device_exposure where  device_exposure_id is not null and device_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from device_exposure where  device_exposure_id is null and device_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from device_exposure where person_id  is not null and device_exposure_start_date between  '20100101' and '20211231' ) d ;       
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98080' as tbl_id, '9808002' as col_id,  2 as col_seq from device_exposure where device_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from device_exposure where  person_id is not null and device_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from device_exposure where  person_id is null and device_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from device_exposure where person_id  is not null and device_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(person_id) as ave from device_exposure where  person_id is not null and device_exposure_start_date between  '20100101' and '20211231') e   ,(select min(person_id) as min_vl from device_exposure where  person_id is not null and device_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from device_exposure where person_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from device_exposure where person_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from device_exposure where person_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(person_id) as n4_qrtl_cnt from device_exposure where  person_id is not null and device_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select person_id as mode_vl, count(person_id) as mode_cnt from device_exposure where  person_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by person_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98080' as tbl_id, '9808003' as col_id,  3 as col_seq from device_exposure where device_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from device_exposure where  device_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from device_exposure where  device_concept_id is null and device_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from device_exposure where person_id  is not null and device_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(device_concept_id) as ave from device_exposure where  device_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') e   ,(select min(device_concept_id) as min_vl from device_exposure where  device_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(device_concept_id order by device_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from device_exposure where device_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(device_concept_id order by device_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from device_exposure where device_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(device_concept_id order by device_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from device_exposure where device_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(device_concept_id) as n4_qrtl_cnt from device_exposure where  device_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select device_concept_id as mode_vl, count(device_concept_id) as mode_cnt from device_exposure where  device_concept_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by device_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98080' as tbl_id, '9808008' as col_id,  8 as col_seq from device_exposure where device_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from device_exposure where  device_type_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from device_exposure where  device_type_concept_id is null and device_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from device_exposure where person_id  is not null and device_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(device_type_concept_id) as ave from device_exposure where  device_type_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') e   ,(select min(device_type_concept_id) as min_vl from device_exposure where  device_type_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(device_type_concept_id order by device_type_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from device_exposure where device_type_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(device_type_concept_id order by device_type_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from device_exposure where device_type_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(device_type_concept_id order by device_type_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from device_exposure where device_type_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(device_type_concept_id) as n4_qrtl_cnt from device_exposure where  device_type_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select device_type_concept_id as mode_vl, count(device_type_concept_id) as mode_cnt from device_exposure where  device_type_concept_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by device_type_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98080' as tbl_id, '9808011' as col_id,  11 as col_seq from device_exposure where device_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from device_exposure where  quantity is not null and device_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from device_exposure where  quantity is null and device_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from device_exposure where person_id  is not null and device_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(quantity) as ave from device_exposure where  quantity is not null and device_exposure_start_date between  '20100101' and '20211231') e   ,(select min(quantity) as min_vl from device_exposure where  quantity is not null and device_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(quantity order by quantity separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from device_exposure where quantity is not null and device_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(quantity order by quantity separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from device_exposure where quantity is not null and device_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(quantity order by quantity separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from device_exposure where quantity is not null and device_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(quantity) as n4_qrtl_cnt from device_exposure where  quantity is not null and device_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select quantity as mode_vl, count(quantity) as mode_cnt from device_exposure where  quantity is not null  and device_exposure_start_date between  '20100101' and '20211231' group by quantity ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98080' as tbl_id, '9808012' as col_id,  12 as col_seq from device_exposure where device_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from device_exposure where  provider_id is not null and device_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from device_exposure where  provider_id is null and device_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from device_exposure where person_id  is not null and device_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(provider_id) as ave from device_exposure where  provider_id is not null and device_exposure_start_date between  '20100101' and '20211231') e   ,(select min(provider_id) as min_vl from device_exposure where  provider_id is not null and device_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from device_exposure where provider_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from device_exposure where provider_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from device_exposure where provider_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(provider_id) as n4_qrtl_cnt from device_exposure where  provider_id is not null and device_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select provider_id as mode_vl, count(provider_id) as mode_cnt from device_exposure where  provider_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by provider_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98080' as tbl_id, '9808013' as col_id,  13 as col_seq from device_exposure where device_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from device_exposure where  visit_occurrence_id is not null and device_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from device_exposure where  visit_occurrence_id is null and device_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from device_exposure where person_id  is not null and device_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(visit_occurrence_id) as ave from device_exposure where  visit_occurrence_id is not null and device_exposure_start_date between  '20100101' and '20211231') e   ,(select min(visit_occurrence_id) as min_vl from device_exposure where  visit_occurrence_id is not null and device_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from device_exposure where visit_occurrence_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from device_exposure where visit_occurrence_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from device_exposure where visit_occurrence_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(visit_occurrence_id) as n4_qrtl_cnt from device_exposure where  visit_occurrence_id is not null and device_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_occurrence_id as mode_vl, count(visit_occurrence_id) as mode_cnt from device_exposure where  visit_occurrence_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by visit_occurrence_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98080' as tbl_id, '9808014' as col_id,  14 as col_seq from device_exposure where device_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from device_exposure where  visit_detail_id is not null and device_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from device_exposure where  visit_detail_id is null and device_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from device_exposure where person_id  is not null and device_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(visit_detail_id) as ave from device_exposure where  visit_detail_id is not null and device_exposure_start_date between  '20100101' and '20211231') e   ,(select min(visit_detail_id) as min_vl from device_exposure where  visit_detail_id is not null and device_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from device_exposure where visit_detail_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from device_exposure where visit_detail_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from device_exposure where visit_detail_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(visit_detail_id) as n4_qrtl_cnt from device_exposure where  visit_detail_id is not null and device_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_detail_id as mode_vl, count(visit_detail_id) as mode_cnt from device_exposure where  visit_detail_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by visit_detail_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98080' as tbl_id, '9808016' as col_id,  16 as col_seq from device_exposure where device_exposure_start_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from device_exposure where  device_source_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from device_exposure where  device_source_concept_id is null and device_exposure_start_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from device_exposure where person_id  is not null and device_exposure_start_date between  '20100101' and '20211231' ) d  ,(select sum(device_source_concept_id) as ave from device_exposure where  device_source_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') e   ,(select min(device_source_concept_id) as min_vl from device_exposure where  device_source_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(device_source_concept_id order by device_source_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from device_exposure where device_source_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(device_source_concept_id order by device_source_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from device_exposure where device_source_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(device_source_concept_id order by device_source_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from device_exposure where device_source_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') a) i  ,(select max(device_source_concept_id) as n4_qrtl_cnt from device_exposure where  device_source_concept_id is not null and device_exposure_start_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select device_source_concept_id as mode_vl, count(device_source_concept_id) as mode_cnt from device_exposure where  device_source_concept_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by device_source_concept_id ) a group by a.mode_vl limit 1) k ;
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt   ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211235'  as coll_end_ymd ,current_timestamp as crtn_dt from (select '9999' as hosp_cd,'98090' as tbl_id, '9809001' as col_id,  1 as col_seq from measurement where measurement_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from measurement where  measurement_id is not null and measurement_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from measurement where  measurement_id is null and measurement_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from measurement where person_id  is not null and measurement_date between  '20100101' and '20211231' ) d ;       */
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98090' as tbl_id, '9809002' as col_id,  2 as col_seq from measurement where measurement_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from measurement where  person_id is not null and measurement_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from measurement where  person_id is null and measurement_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from measurement where person_id  is not null and measurement_date between  '20100101' and '20211231' ) d  ,(select sum(person_id) as ave from measurement where  person_id is not null and measurement_date between  '20100101' and '20211231') e   ,(select min(person_id) as min_vl from measurement where  person_id is not null and measurement_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from measurement where person_id is not null and measurement_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from measurement where person_id is not null and measurement_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from measurement where person_id is not null and measurement_date between  '20100101' and '20211231') a) i  ,(select max(person_id) as n4_qrtl_cnt from measurement where  person_id is not null and measurement_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select person_id as mode_vl, count(person_id) as mode_cnt from measurement where  person_id is not null  and measurement_date between  '20100101' and '20211231' group by person_id ) a group by a.mode_vl limit 1) k ;*/
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98090' as tbl_id, '9809003' as col_id,  3 as col_seq from measurement where measurement_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from measurement where  measurement_concept_id is not null and measurement_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from measurement where  measurement_concept_id is null and measurement_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from measurement where person_id  is not null and measurement_date between  '20100101' and '20211231' ) d  ,(select sum(measurement_concept_id) as ave from measurement where  measurement_concept_id is not null and measurement_date between  '20100101' and '20211231') e   ,(select min(measurement_concept_id) as min_vl from measurement where  measurement_concept_id is not null and measurement_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(measurement_concept_id order by measurement_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from measurement where measurement_concept_id is not null and measurement_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(measurement_concept_id order by measurement_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from measurement where measurement_concept_id is not null and measurement_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(measurement_concept_id order by measurement_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from measurement where measurement_concept_id is not null and measurement_date between  '20100101' and '20211231') a) i  ,(select max(measurement_concept_id) as n4_qrtl_cnt from measurement where  measurement_concept_id is not null and measurement_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select measurement_concept_id as mode_vl, count(measurement_concept_id) as mode_cnt from measurement where  measurement_concept_id is not null  and measurement_date between  '20100101' and '20211231' group by measurement_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98090' as tbl_id, '9809007' as col_id,  7 as col_seq from measurement where measurement_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from measurement where  measurement_type_concept_id is not null and measurement_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from measurement where  measurement_type_concept_id is null and measurement_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from measurement where person_id  is not null and measurement_date between  '20100101' and '20211231' ) d  ,(select sum(measurement_type_concept_id) as ave from measurement where  measurement_type_concept_id is not null and measurement_date between  '20100101' and '20211231') e   ,(select min(measurement_type_concept_id) as min_vl from measurement where  measurement_type_concept_id is not null and measurement_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(measurement_type_concept_id order by measurement_type_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from measurement where measurement_type_concept_id is not null and measurement_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(measurement_type_concept_id order by measurement_type_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from measurement where measurement_type_concept_id is not null and measurement_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(measurement_type_concept_id order by measurement_type_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from measurement where measurement_type_concept_id is not null and measurement_date between  '20100101' and '20211231') a) i  ,(select max(measurement_type_concept_id) as n4_qrtl_cnt from measurement where  measurement_type_concept_id is not null and measurement_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select measurement_type_concept_id as mode_vl, count(measurement_type_concept_id) as mode_cnt from measurement where  measurement_type_concept_id is not null  and measurement_date between  '20100101' and '20211231' group by measurement_type_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98090' as tbl_id, '9809008' as col_id,  8 as col_seq from measurement where measurement_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from measurement where  operator_concept_id is not null and measurement_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from measurement where  operator_concept_id is null and measurement_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from measurement where person_id  is not null and measurement_date between  '20100101' and '20211231' ) d  ,(select sum(operator_concept_id) as ave from measurement where  operator_concept_id is not null and measurement_date between  '20100101' and '20211231') e   ,(select min(operator_concept_id) as min_vl from measurement where  operator_concept_id is not null and measurement_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(operator_concept_id order by operator_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from measurement where operator_concept_id is not null and measurement_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(operator_concept_id order by operator_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from measurement where operator_concept_id is not null and measurement_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(operator_concept_id order by operator_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from measurement where operator_concept_id is not null and measurement_date between  '20100101' and '20211231') a) i  ,(select max(operator_concept_id) as n4_qrtl_cnt from measurement where  operator_concept_id is not null and measurement_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select operator_concept_id as mode_vl, count(operator_concept_id) as mode_cnt from measurement where  operator_concept_id is not null  and measurement_date between  '20100101' and '20211231' group by operator_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98090' as tbl_id, '9809009' as col_id,  9 as col_seq from measurement where measurement_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from measurement where  value_as_number is not null and measurement_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from measurement where  value_as_number is null and measurement_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from measurement where person_id  is not null and measurement_date between  '20100101' and '20211231' ) d  ,(select sum(value_as_number) as ave from measurement where  value_as_number is not null and measurement_date between  '20100101' and '20211231') e   ,(select min(value_as_number) as min_vl from measurement where  value_as_number is not null and measurement_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(value_as_number order by value_as_number separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from measurement where value_as_number is not null and measurement_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(value_as_number order by value_as_number separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from measurement where value_as_number is not null and measurement_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(value_as_number order by value_as_number separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from measurement where value_as_number is not null and measurement_date between  '20100101' and '20211231') a) i  ,(select max(value_as_number) as n4_qrtl_cnt from measurement where  value_as_number is not null and measurement_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select value_as_number as mode_vl, count(value_as_number) as mode_cnt from measurement where  value_as_number is not null  and measurement_date between  '20100101' and '20211231' group by value_as_number ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98090' as tbl_id, '9809010' as col_id,  10 as col_seq from measurement where measurement_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from measurement where  value_as_concept_id is not null and measurement_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from measurement where  value_as_concept_id is null and measurement_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from measurement where person_id  is not null and measurement_date between  '20100101' and '20211231' ) d  ,(select sum(value_as_concept_id) as ave from measurement where  value_as_concept_id is not null and measurement_date between  '20100101' and '20211231') e   ,(select min(value_as_concept_id) as min_vl from measurement where  value_as_concept_id is not null and measurement_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(value_as_concept_id order by value_as_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from measurement where value_as_concept_id is not null and measurement_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(value_as_concept_id order by value_as_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from measurement where value_as_concept_id is not null and measurement_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(value_as_concept_id order by value_as_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from measurement where value_as_concept_id is not null and measurement_date between  '20100101' and '20211231') a) i  ,(select max(value_as_concept_id) as n4_qrtl_cnt from measurement where  value_as_concept_id is not null and measurement_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select value_as_concept_id as mode_vl, count(value_as_concept_id) as mode_cnt from measurement where  value_as_concept_id is not null  and measurement_date between  '20100101' and '20211231' group by value_as_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98090' as tbl_id, '9809011' as col_id,  11 as col_seq from measurement where measurement_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from measurement where  unit_concept_id is not null and measurement_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from measurement where  unit_concept_id is null and measurement_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from measurement where person_id  is not null and measurement_date between  '20100101' and '20211231' ) d  ,(select sum(unit_concept_id) as ave from measurement where  unit_concept_id is not null and measurement_date between  '20100101' and '20211231') e   ,(select min(unit_concept_id) as min_vl from measurement where  unit_concept_id is not null and measurement_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(unit_concept_id order by unit_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from measurement where unit_concept_id is not null and measurement_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(unit_concept_id order by unit_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from measurement where unit_concept_id is not null and measurement_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(unit_concept_id order by unit_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from measurement where unit_concept_id is not null and measurement_date between  '20100101' and '20211231') a) i  ,(select max(unit_concept_id) as n4_qrtl_cnt from measurement where  unit_concept_id is not null and measurement_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select unit_concept_id as mode_vl, count(unit_concept_id) as mode_cnt from measurement where  unit_concept_id is not null  and measurement_date between  '20100101' and '20211231' group by unit_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98090' as tbl_id, '9809012' as col_id,  12 as col_seq from measurement where measurement_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from measurement where  range_low is not null and measurement_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from measurement where  range_low is null and measurement_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from measurement where person_id  is not null and measurement_date between  '20100101' and '20211231' ) d  ,(select sum(range_low) as ave from measurement where  range_low is not null and measurement_date between  '20100101' and '20211231') e   ,(select min(range_low) as min_vl from measurement where  range_low is not null and measurement_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(range_low order by range_low separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from measurement where range_low is not null and measurement_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(range_low order by range_low separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from measurement where range_low is not null and measurement_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(range_low order by range_low separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from measurement where range_low is not null and measurement_date between  '20100101' and '20211231') a) i  ,(select max(range_low) as n4_qrtl_cnt from measurement where  range_low is not null and measurement_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select range_low as mode_vl, count(range_low) as mode_cnt from measurement where  range_low is not null  and measurement_date between  '20100101' and '20211231' group by range_low ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98090' as tbl_id, '9809013' as col_id,  13 as col_seq from measurement where measurement_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from measurement where  range_high is not null and measurement_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from measurement where  range_high is null and measurement_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from measurement where person_id  is not null and measurement_date between  '20100101' and '20211231' ) d  ,(select sum(range_high) as ave from measurement where  range_high is not null and measurement_date between  '20100101' and '20211231') e   ,(select min(range_high) as min_vl from measurement where  range_high is not null and measurement_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(range_high order by range_high separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from measurement where range_high is not null and measurement_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(range_high order by range_high separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from measurement where range_high is not null and measurement_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(range_high order by range_high separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from measurement where range_high is not null and measurement_date between  '20100101' and '20211231') a) i  ,(select max(range_high) as n4_qrtl_cnt from measurement where  range_high is not null and measurement_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select range_high as mode_vl, count(range_high) as mode_cnt from measurement where  range_high is not null  and measurement_date between  '20100101' and '20211231' group by range_high ) a group by a.mode_vl limit 1) k ;
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98090' as tbl_id, '9809014' as col_id,  14 as col_seq from measurement where measurement_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from measurement where  provider_id is not null and measurement_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from measurement where  provider_id is null and measurement_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from measurement where person_id  is not null and measurement_date between  '20100101' and '20211231' ) d  ,(select sum(provider_id) as ave from measurement where  provider_id is not null and measurement_date between  '20100101' and '20211231') e   ,(select min(provider_id) as min_vl from measurement where  provider_id is not null and measurement_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from measurement where provider_id is not null and measurement_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from measurement where provider_id is not null and measurement_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from measurement where provider_id is not null and measurement_date between  '20100101' and '20211231') a) i  ,(select max(provider_id) as n4_qrtl_cnt from measurement where  provider_id is not null and measurement_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select provider_id as mode_vl, count(provider_id) as mode_cnt from measurement where  provider_id is not null  and measurement_date between  '20100101' and '20211231' group by provider_id ) a group by a.mode_vl limit 1) k ;*/
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98090' as tbl_id, '9809015' as col_id,  15 as col_seq from measurement where measurement_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from measurement where  visit_occurrence_id is not null and measurement_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from measurement where  visit_occurrence_id is null and measurement_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from measurement where person_id  is not null and measurement_date between  '20100101' and '20211231' ) d  ,(select sum(visit_occurrence_id) as ave from measurement where  visit_occurrence_id is not null and measurement_date between  '20100101' and '20211231') e   ,(select min(visit_occurrence_id) as min_vl from measurement where  visit_occurrence_id is not null and measurement_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from measurement where visit_occurrence_id is not null and measurement_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from measurement where visit_occurrence_id is not null and measurement_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from measurement where visit_occurrence_id is not null and measurement_date between  '20100101' and '20211231') a) i  ,(select max(visit_occurrence_id) as n4_qrtl_cnt from measurement where  visit_occurrence_id is not null and measurement_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_occurrence_id as mode_vl, count(visit_occurrence_id) as mode_cnt from measurement where  visit_occurrence_id is not null  and measurement_date between  '20100101' and '20211231' group by visit_occurrence_id ) a group by a.mode_vl limit 1) k ;*/
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98090' as tbl_id, '9809016' as col_id,  16 as col_seq from measurement where measurement_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from measurement where  visit_detail_id is not null and measurement_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from measurement where  visit_detail_id is null and measurement_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from measurement where person_id  is not null and measurement_date between  '20100101' and '20211231' ) d  ,(select sum(visit_detail_id) as ave from measurement where  visit_detail_id is not null and measurement_date between  '20100101' and '20211231') e   ,(select min(visit_detail_id) as min_vl from measurement where  visit_detail_id is not null and measurement_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from measurement where visit_detail_id is not null and measurement_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from measurement where visit_detail_id is not null and measurement_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from measurement where visit_detail_id is not null and measurement_date between  '20100101' and '20211231') a) i  ,(select max(visit_detail_id) as n4_qrtl_cnt from measurement where  visit_detail_id is not null and measurement_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_detail_id as mode_vl, count(visit_detail_id) as mode_cnt from measurement where  visit_detail_id is not null  and measurement_date between  '20100101' and '20211231' group by visit_detail_id ) a group by a.mode_vl limit 1) k ;*/
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98090' as tbl_id, '9809018' as col_id,  18 as col_seq from measurement where measurement_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from measurement where  measurement_source_concept_id is not null and measurement_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from measurement where  measurement_source_concept_id is null and measurement_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from measurement where person_id  is not null and measurement_date between  '20100101' and '20211231' ) d  ,(select sum(measurement_source_concept_id) as ave from measurement where  measurement_source_concept_id is not null and measurement_date between  '20100101' and '20211231') e   ,(select min(measurement_source_concept_id) as min_vl from measurement where  measurement_source_concept_id is not null and measurement_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(measurement_source_concept_id order by measurement_source_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from measurement where measurement_source_concept_id is not null and measurement_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(measurement_source_concept_id order by measurement_source_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from measurement where measurement_source_concept_id is not null and measurement_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(measurement_source_concept_id order by measurement_source_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from measurement where measurement_source_concept_id is not null and measurement_date between  '20100101' and '20211231') a) i  ,(select max(measurement_source_concept_id) as n4_qrtl_cnt from measurement where  measurement_source_concept_id is not null and measurement_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select measurement_source_concept_id as mode_vl, count(measurement_source_concept_id) as mode_cnt from measurement where  measurement_source_concept_id is not null  and measurement_date between  '20100101' and '20211231' group by measurement_source_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt   ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211235'  as coll_end_ymd ,current_timestamp as crtn_dt from (select '9999' as hosp_cd,'98100' as tbl_id, '9810001' as col_id,  1 as col_seq from observation where observation_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from observation where  observation_id is not null and observation_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from observation where  observation_id is null and observation_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from observation where person_id  is not null and observation_date between  '20100101' and '20211231' ) d ;       
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98100' as tbl_id, '9810002' as col_id,  2 as col_seq from observation where observation_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from observation where  person_id is not null and observation_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from observation where  person_id is null and observation_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from observation where person_id  is not null and observation_date between  '20100101' and '20211231' ) d  ,(select sum(person_id) as ave from observation where  person_id is not null and observation_date between  '20100101' and '20211231') e   ,(select min(person_id) as min_vl from observation where  person_id is not null and observation_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from observation where person_id is not null and observation_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from observation where person_id is not null and observation_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from observation where person_id is not null and observation_date between  '20100101' and '20211231') a) i  ,(select max(person_id) as n4_qrtl_cnt from observation where  person_id is not null and observation_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select person_id as mode_vl, count(person_id) as mode_cnt from observation where  person_id is not null  and observation_date between  '20100101' and '20211231' group by person_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98100' as tbl_id, '9810003' as col_id,  3 as col_seq from observation where observation_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from observation where  observation_concept_id is not null and observation_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from observation where  observation_concept_id is null and observation_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from observation where person_id  is not null and observation_date between  '20100101' and '20211231' ) d  ,(select sum(observation_concept_id) as ave from observation where  observation_concept_id is not null and observation_date between  '20100101' and '20211231') e   ,(select min(observation_concept_id) as min_vl from observation where  observation_concept_id is not null and observation_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(observation_concept_id order by observation_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from observation where observation_concept_id is not null and observation_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(observation_concept_id order by observation_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from observation where observation_concept_id is not null and observation_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(observation_concept_id order by observation_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from observation where observation_concept_id is not null and observation_date between  '20100101' and '20211231') a) i  ,(select max(observation_concept_id) as n4_qrtl_cnt from observation where  observation_concept_id is not null and observation_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select observation_concept_id as mode_vl, count(observation_concept_id) as mode_cnt from observation where  observation_concept_id is not null  and observation_date between  '20100101' and '20211231' group by observation_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98100' as tbl_id, '9810006' as col_id,  6 as col_seq from observation where observation_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from observation where  observation_type_concept_id is not null and observation_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from observation where  observation_type_concept_id is null and observation_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from observation where person_id  is not null and observation_date between  '20100101' and '20211231' ) d  ,(select sum(observation_type_concept_id) as ave from observation where  observation_type_concept_id is not null and observation_date between  '20100101' and '20211231') e   ,(select min(observation_type_concept_id) as min_vl from observation where  observation_type_concept_id is not null and observation_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(observation_type_concept_id order by observation_type_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from observation where observation_type_concept_id is not null and observation_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(observation_type_concept_id order by observation_type_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from observation where observation_type_concept_id is not null and observation_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(observation_type_concept_id order by observation_type_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from observation where observation_type_concept_id is not null and observation_date between  '20100101' and '20211231') a) i  ,(select max(observation_type_concept_id) as n4_qrtl_cnt from observation where  observation_type_concept_id is not null and observation_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select observation_type_concept_id as mode_vl, count(observation_type_concept_id) as mode_cnt from observation where  observation_type_concept_id is not null  and observation_date between  '20100101' and '20211231' group by observation_type_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98100' as tbl_id, '9810007' as col_id,  7 as col_seq from observation where observation_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from observation where  value_as_number is not null and observation_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from observation where  value_as_number is null and observation_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from observation where person_id  is not null and observation_date between  '20100101' and '20211231' ) d  ,(select sum(value_as_number) as ave from observation where  value_as_number is not null and observation_date between  '20100101' and '20211231') e   ,(select min(value_as_number) as min_vl from observation where  value_as_number is not null and observation_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(value_as_number order by value_as_number separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from observation where value_as_number is not null and observation_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(value_as_number order by value_as_number separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from observation where value_as_number is not null and observation_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(value_as_number order by value_as_number separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from observation where value_as_number is not null and observation_date between  '20100101' and '20211231') a) i  ,(select max(value_as_number) as n4_qrtl_cnt from observation where  value_as_number is not null and observation_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select value_as_number as mode_vl, count(value_as_number) as mode_cnt from observation where  value_as_number is not null  and observation_date between  '20100101' and '20211231' group by value_as_number ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98100' as tbl_id, '9810009' as col_id,  9 as col_seq from observation where observation_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from observation where  value_as_concept_id is not null and observation_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from observation where  value_as_concept_id is null and observation_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from observation where person_id  is not null and observation_date between  '20100101' and '20211231' ) d  ,(select sum(value_as_concept_id) as ave from observation where  value_as_concept_id is not null and observation_date between  '20100101' and '20211231') e   ,(select min(value_as_concept_id) as min_vl from observation where  value_as_concept_id is not null and observation_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(value_as_concept_id order by value_as_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from observation where value_as_concept_id is not null and observation_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(value_as_concept_id order by value_as_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from observation where value_as_concept_id is not null and observation_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(value_as_concept_id order by value_as_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from observation where value_as_concept_id is not null and observation_date between  '20100101' and '20211231') a) i  ,(select max(value_as_concept_id) as n4_qrtl_cnt from observation where  value_as_concept_id is not null and observation_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select value_as_concept_id as mode_vl, count(value_as_concept_id) as mode_cnt from observation where  value_as_concept_id is not null  and observation_date between  '20100101' and '20211231' group by value_as_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98100' as tbl_id, '9810010' as col_id,  10 as col_seq from observation where observation_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from observation where  qualifier_concept_id is not null and observation_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from observation where  qualifier_concept_id is null and observation_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from observation where person_id  is not null and observation_date between  '20100101' and '20211231' ) d  ,(select sum(qualifier_concept_id) as ave from observation where  qualifier_concept_id is not null and observation_date between  '20100101' and '20211231') e   ,(select min(qualifier_concept_id) as min_vl from observation where  qualifier_concept_id is not null and observation_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(qualifier_concept_id order by qualifier_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from observation where qualifier_concept_id is not null and observation_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(qualifier_concept_id order by qualifier_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from observation where qualifier_concept_id is not null and observation_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(qualifier_concept_id order by qualifier_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from observation where qualifier_concept_id is not null and observation_date between  '20100101' and '20211231') a) i  ,(select max(qualifier_concept_id) as n4_qrtl_cnt from observation where  qualifier_concept_id is not null and observation_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select qualifier_concept_id as mode_vl, count(qualifier_concept_id) as mode_cnt from observation where  qualifier_concept_id is not null  and observation_date between  '20100101' and '20211231' group by qualifier_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98100' as tbl_id, '9810011' as col_id,  11 as col_seq from observation where observation_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from observation where  unit_concept_id is not null and observation_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from observation where  unit_concept_id is null and observation_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from observation where person_id  is not null and observation_date between  '20100101' and '20211231' ) d  ,(select sum(unit_concept_id) as ave from observation where  unit_concept_id is not null and observation_date between  '20100101' and '20211231') e   ,(select min(unit_concept_id) as min_vl from observation where  unit_concept_id is not null and observation_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(unit_concept_id order by unit_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from observation where unit_concept_id is not null and observation_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(unit_concept_id order by unit_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from observation where unit_concept_id is not null and observation_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(unit_concept_id order by unit_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from observation where unit_concept_id is not null and observation_date between  '20100101' and '20211231') a) i  ,(select max(unit_concept_id) as n4_qrtl_cnt from observation where  unit_concept_id is not null and observation_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select unit_concept_id as mode_vl, count(unit_concept_id) as mode_cnt from observation where  unit_concept_id is not null  and observation_date between  '20100101' and '20211231' group by unit_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98100' as tbl_id, '9810012' as col_id,  12 as col_seq from observation where observation_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from observation where  provider_id is not null and observation_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from observation where  provider_id is null and observation_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from observation where person_id  is not null and observation_date between  '20100101' and '20211231' ) d  ,(select sum(provider_id) as ave from observation where  provider_id is not null and observation_date between  '20100101' and '20211231') e   ,(select min(provider_id) as min_vl from observation where  provider_id is not null and observation_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from observation where provider_id is not null and observation_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from observation where provider_id is not null and observation_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from observation where provider_id is not null and observation_date between  '20100101' and '20211231') a) i  ,(select max(provider_id) as n4_qrtl_cnt from observation where  provider_id is not null and observation_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select provider_id as mode_vl, count(provider_id) as mode_cnt from observation where  provider_id is not null  and observation_date between  '20100101' and '20211231' group by provider_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98100' as tbl_id, '9810013' as col_id,  13 as col_seq from observation where observation_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from observation where  visit_occurrence_id is not null and observation_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from observation where  visit_occurrence_id is null and observation_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from observation where person_id  is not null and observation_date between  '20100101' and '20211231' ) d  ,(select sum(visit_occurrence_id) as ave from observation where  visit_occurrence_id is not null and observation_date between  '20100101' and '20211231') e   ,(select min(visit_occurrence_id) as min_vl from observation where  visit_occurrence_id is not null and observation_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from observation where visit_occurrence_id is not null and observation_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from observation where visit_occurrence_id is not null and observation_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from observation where visit_occurrence_id is not null and observation_date between  '20100101' and '20211231') a) i  ,(select max(visit_occurrence_id) as n4_qrtl_cnt from observation where  visit_occurrence_id is not null and observation_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_occurrence_id as mode_vl, count(visit_occurrence_id) as mode_cnt from observation where  visit_occurrence_id is not null  and observation_date between  '20100101' and '20211231' group by visit_occurrence_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98100' as tbl_id, '9810014' as col_id,  14 as col_seq from observation where observation_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from observation where  visit_detail_id is not null and observation_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from observation where  visit_detail_id is null and observation_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from observation where person_id  is not null and observation_date between  '20100101' and '20211231' ) d  ,(select sum(visit_detail_id) as ave from observation where  visit_detail_id is not null and observation_date between  '20100101' and '20211231') e   ,(select min(visit_detail_id) as min_vl from observation where  visit_detail_id is not null and observation_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from observation where visit_detail_id is not null and observation_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from observation where visit_detail_id is not null and observation_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from observation where visit_detail_id is not null and observation_date between  '20100101' and '20211231') a) i  ,(select max(visit_detail_id) as n4_qrtl_cnt from observation where  visit_detail_id is not null and observation_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_detail_id as mode_vl, count(visit_detail_id) as mode_cnt from observation where  visit_detail_id is not null  and observation_date between  '20100101' and '20211231' group by visit_detail_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98100' as tbl_id, '9810016' as col_id,  16 as col_seq from observation where observation_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from observation where  observation_source_concept_id is not null and observation_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from observation where  observation_source_concept_id is null and observation_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from observation where person_id  is not null and observation_date between  '20100101' and '20211231' ) d  ,(select sum(observation_source_concept_id) as ave from observation where  observation_source_concept_id is not null and observation_date between  '20100101' and '20211231') e   ,(select min(observation_source_concept_id) as min_vl from observation where  observation_source_concept_id is not null and observation_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(observation_source_concept_id order by observation_source_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from observation where observation_source_concept_id is not null and observation_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(observation_source_concept_id order by observation_source_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from observation where observation_source_concept_id is not null and observation_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(observation_source_concept_id order by observation_source_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from observation where observation_source_concept_id is not null and observation_date between  '20100101' and '20211231') a) i  ,(select max(observation_source_concept_id) as n4_qrtl_cnt from observation where  observation_source_concept_id is not null and observation_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select observation_source_concept_id as mode_vl, count(observation_source_concept_id) as mode_cnt from observation where  observation_source_concept_id is not null  and observation_date between  '20100101' and '20211231' group by observation_source_concept_id ) a group by a.mode_vl limit 1) k ;
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98110' as tbl_id, '9811001' as col_id,  1 as col_seq from death where death_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from death where  person_id is not null and death_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from death where  person_id is null and death_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from death where person_id  is not null and death_date between  '20100101' and '20211231' ) d  ,(select sum(person_id) as ave from death where  person_id is not null and death_date between  '20100101' and '20211231') e   ,(select min(person_id) as min_vl from death where  person_id is not null and death_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from death where person_id is not null and death_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from death where person_id is not null and death_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from death where person_id is not null and death_date between  '20100101' and '20211231') a) i  ,(select max(person_id) as n4_qrtl_cnt from death where  person_id is not null and death_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select person_id as mode_vl, count(person_id) as mode_cnt from death where  person_id is not null  and death_date between  '20100101' and '20211231' group by person_id ) a group by a.mode_vl limit 1) k ;*/
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98110' as tbl_id, '9811004' as col_id,  4 as col_seq from death where death_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from death where  death_type_concept_id is not null and death_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from death where  death_type_concept_id is null and death_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from death where person_id  is not null and death_date between  '20100101' and '20211231' ) d  ,(select sum(death_type_concept_id) as ave from death where  death_type_concept_id is not null and death_date between  '20100101' and '20211231') e   ,(select min(death_type_concept_id) as min_vl from death where  death_type_concept_id is not null and death_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(death_type_concept_id order by death_type_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from death where death_type_concept_id is not null and death_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(death_type_concept_id order by death_type_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from death where death_type_concept_id is not null and death_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(death_type_concept_id order by death_type_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from death where death_type_concept_id is not null and death_date between  '20100101' and '20211231') a) i  ,(select max(death_type_concept_id) as n4_qrtl_cnt from death where  death_type_concept_id is not null and death_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select death_type_concept_id as mode_vl, count(death_type_concept_id) as mode_cnt from death where  death_type_concept_id is not null  and death_date between  '20100101' and '20211231' group by death_type_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98110' as tbl_id, '9811005' as col_id,  5 as col_seq from death where death_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from death where  cause_concept_id is not null and death_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from death where  cause_concept_id is null and death_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from death where person_id  is not null and death_date between  '20100101' and '20211231' ) d  ,(select sum(cause_concept_id) as ave from death where  cause_concept_id is not null and death_date between  '20100101' and '20211231') e   ,(select min(cause_concept_id) as min_vl from death where  cause_concept_id is not null and death_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(cause_concept_id order by cause_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from death where cause_concept_id is not null and death_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(cause_concept_id order by cause_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from death where cause_concept_id is not null and death_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(cause_concept_id order by cause_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from death where cause_concept_id is not null and death_date between  '20100101' and '20211231') a) i  ,(select max(cause_concept_id) as n4_qrtl_cnt from death where  cause_concept_id is not null and death_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select cause_concept_id as mode_vl, count(cause_concept_id) as mode_cnt from death where  cause_concept_id is not null  and death_date between  '20100101' and '20211231' group by cause_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98110' as tbl_id, '9811007' as col_id,  7 as col_seq from death where death_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from death where  cause_source_concept_id is not null and death_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from death where  cause_source_concept_id is null and death_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from death where person_id  is not null and death_date between  '20100101' and '20211231' ) d  ,(select sum(cause_source_concept_id) as ave from death where  cause_source_concept_id is not null and death_date between  '20100101' and '20211231') e   ,(select min(cause_source_concept_id) as min_vl from death where  cause_source_concept_id is not null and death_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(cause_source_concept_id order by cause_source_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from death where cause_source_concept_id is not null and death_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(cause_source_concept_id order by cause_source_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from death where cause_source_concept_id is not null and death_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(cause_source_concept_id order by cause_source_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from death where cause_source_concept_id is not null and death_date between  '20100101' and '20211231') a) i  ,(select max(cause_source_concept_id) as n4_qrtl_cnt from death where  cause_source_concept_id is not null and death_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select cause_source_concept_id as mode_vl, count(cause_source_concept_id) as mode_cnt from death where  cause_source_concept_id is not null  and death_date between  '20100101' and '20211231' group by cause_source_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt   ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211235'  as coll_end_ymd ,current_timestamp as crtn_dt from (select '9999' as hosp_cd,'98120' as tbl_id, '9812001' as col_id,  1 as col_seq from note where note_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from note where  note_id is not null and note_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from note where  note_id is null and note_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from note where person_id  is not null and note_date between  '20100101' and '20211231' ) d ;       
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98120' as tbl_id, '9812002' as col_id,  2 as col_seq from note where note_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from note where  person_id is not null and note_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from note where  person_id is null and note_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from note where person_id  is not null and note_date between  '20100101' and '20211231' ) d  ,(select sum(person_id) as ave from note where  person_id is not null and note_date between  '20100101' and '20211231') e   ,(select min(person_id) as min_vl from note where  person_id is not null and note_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from note where person_id is not null and note_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from note where person_id is not null and note_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from note where person_id is not null and note_date between  '20100101' and '20211231') a) i  ,(select max(person_id) as n4_qrtl_cnt from note where  person_id is not null and note_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select person_id as mode_vl, count(person_id) as mode_cnt from note where  person_id is not null  and note_date between  '20100101' and '20211231' group by person_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98120' as tbl_id, '9812005' as col_id,  5 as col_seq from note where note_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from note where  note_type_concept_id is not null and note_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from note where  note_type_concept_id is null and note_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from note where person_id  is not null and note_date between  '20100101' and '20211231' ) d  ,(select sum(note_type_concept_id) as ave from note where  note_type_concept_id is not null and note_date between  '20100101' and '20211231') e   ,(select min(note_type_concept_id) as min_vl from note where  note_type_concept_id is not null and note_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(note_type_concept_id order by note_type_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from note where note_type_concept_id is not null and note_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(note_type_concept_id order by note_type_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from note where note_type_concept_id is not null and note_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(note_type_concept_id order by note_type_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from note where note_type_concept_id is not null and note_date between  '20100101' and '20211231') a) i  ,(select max(note_type_concept_id) as n4_qrtl_cnt from note where  note_type_concept_id is not null and note_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select note_type_concept_id as mode_vl, count(note_type_concept_id) as mode_cnt from note where  note_type_concept_id is not null  and note_date between  '20100101' and '20211231' group by note_type_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98120' as tbl_id, '9812006' as col_id,  6 as col_seq from note where note_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from note where  note_class_concept_id is not null and note_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from note where  note_class_concept_id is null and note_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from note where person_id  is not null and note_date between  '20100101' and '20211231' ) d  ,(select sum(note_class_concept_id) as ave from note where  note_class_concept_id is not null and note_date between  '20100101' and '20211231') e   ,(select min(note_class_concept_id) as min_vl from note where  note_class_concept_id is not null and note_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(note_class_concept_id order by note_class_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from note where note_class_concept_id is not null and note_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(note_class_concept_id order by note_class_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from note where note_class_concept_id is not null and note_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(note_class_concept_id order by note_class_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from note where note_class_concept_id is not null and note_date between  '20100101' and '20211231') a) i  ,(select max(note_class_concept_id) as n4_qrtl_cnt from note where  note_class_concept_id is not null and note_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select note_class_concept_id as mode_vl, count(note_class_concept_id) as mode_cnt from note where  note_class_concept_id is not null  and note_date between  '20100101' and '20211231' group by note_class_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98120' as tbl_id, '9812009' as col_id,  9 as col_seq from note where note_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from note where  encoding_concept_id is not null and note_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from note where  encoding_concept_id is null and note_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from note where person_id  is not null and note_date between  '20100101' and '20211231' ) d  ,(select sum(encoding_concept_id) as ave from note where  encoding_concept_id is not null and note_date between  '20100101' and '20211231') e   ,(select min(encoding_concept_id) as min_vl from note where  encoding_concept_id is not null and note_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(encoding_concept_id order by encoding_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from note where encoding_concept_id is not null and note_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(encoding_concept_id order by encoding_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from note where encoding_concept_id is not null and note_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(encoding_concept_id order by encoding_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from note where encoding_concept_id is not null and note_date between  '20100101' and '20211231') a) i  ,(select max(encoding_concept_id) as n4_qrtl_cnt from note where  encoding_concept_id is not null and note_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select encoding_concept_id as mode_vl, count(encoding_concept_id) as mode_cnt from note where  encoding_concept_id is not null  and note_date between  '20100101' and '20211231' group by encoding_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98120' as tbl_id, '9812010' as col_id,  10 as col_seq from note where note_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from note where  language_concept_id is not null and note_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from note where  language_concept_id is null and note_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from note where person_id  is not null and note_date between  '20100101' and '20211231' ) d  ,(select sum(language_concept_id) as ave from note where  language_concept_id is not null and note_date between  '20100101' and '20211231') e   ,(select min(language_concept_id) as min_vl from note where  language_concept_id is not null and note_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(language_concept_id order by language_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from note where language_concept_id is not null and note_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(language_concept_id order by language_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from note where language_concept_id is not null and note_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(language_concept_id order by language_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from note where language_concept_id is not null and note_date between  '20100101' and '20211231') a) i  ,(select max(language_concept_id) as n4_qrtl_cnt from note where  language_concept_id is not null and note_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select language_concept_id as mode_vl, count(language_concept_id) as mode_cnt from note where  language_concept_id is not null  and note_date between  '20100101' and '20211231' group by language_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98120' as tbl_id, '9812011' as col_id,  11 as col_seq from note where note_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from note where  provider_id is not null and note_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from note where  provider_id is null and note_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from note where person_id  is not null and note_date between  '20100101' and '20211231' ) d  ,(select sum(provider_id) as ave from note where  provider_id is not null and note_date between  '20100101' and '20211231') e   ,(select min(provider_id) as min_vl from note where  provider_id is not null and note_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from note where provider_id is not null and note_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from note where provider_id is not null and note_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from note where provider_id is not null and note_date between  '20100101' and '20211231') a) i  ,(select max(provider_id) as n4_qrtl_cnt from note where  provider_id is not null and note_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select provider_id as mode_vl, count(provider_id) as mode_cnt from note where  provider_id is not null  and note_date between  '20100101' and '20211231' group by provider_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98120' as tbl_id, '9812012' as col_id,  12 as col_seq from note where note_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from note where  visit_occurrence_id is not null and note_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from note where  visit_occurrence_id is null and note_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from note where person_id  is not null and note_date between  '20100101' and '20211231' ) d  ,(select sum(visit_occurrence_id) as ave from note where  visit_occurrence_id is not null and note_date between  '20100101' and '20211231') e   ,(select min(visit_occurrence_id) as min_vl from note where  visit_occurrence_id is not null and note_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from note where visit_occurrence_id is not null and note_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from note where visit_occurrence_id is not null and note_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_occurrence_id order by visit_occurrence_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from note where visit_occurrence_id is not null and note_date between  '20100101' and '20211231') a) i  ,(select max(visit_occurrence_id) as n4_qrtl_cnt from note where  visit_occurrence_id is not null and note_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_occurrence_id as mode_vl, count(visit_occurrence_id) as mode_cnt from note where  visit_occurrence_id is not null  and note_date between  '20100101' and '20211231' group by visit_occurrence_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98120' as tbl_id, '9812013' as col_id,  13 as col_seq from note where note_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from note where  visit_detail_id is not null and note_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from note where  visit_detail_id is null and note_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from note where person_id  is not null and note_date between  '20100101' and '20211231' ) d  ,(select sum(visit_detail_id) as ave from note where  visit_detail_id is not null and note_date between  '20100101' and '20211231') e   ,(select min(visit_detail_id) as min_vl from note where  visit_detail_id is not null and note_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from note where visit_detail_id is not null and note_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from note where visit_detail_id is not null and note_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(visit_detail_id order by visit_detail_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from note where visit_detail_id is not null and note_date between  '20100101' and '20211231') a) i  ,(select max(visit_detail_id) as n4_qrtl_cnt from note where  visit_detail_id is not null and note_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select visit_detail_id as mode_vl, count(visit_detail_id) as mode_cnt from note where  visit_detail_id is not null  and note_date between  '20100101' and '20211231' group by visit_detail_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt   ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211235'  as coll_end_ymd ,current_timestamp as crtn_dt from (select '9999' as hosp_cd,'98140' as tbl_id, '9814001' as col_id,  1 as col_seq from specimen where specimen_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from specimen where  specimen_id is not null and specimen_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from specimen where  specimen_id is null and specimen_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from specimen where person_id  is not null and specimen_date between  '20100101' and '20211231' ) d ;       
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98140' as tbl_id, '9814002' as col_id,  2 as col_seq from specimen where specimen_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from specimen where  person_id is not null and specimen_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from specimen where  person_id is null and specimen_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from specimen where person_id  is not null and specimen_date between  '20100101' and '20211231' ) d  ,(select sum(person_id) as ave from specimen where  person_id is not null and specimen_date between  '20100101' and '20211231') e   ,(select min(person_id) as min_vl from specimen where  person_id is not null and specimen_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from specimen where person_id is not null and specimen_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from specimen where person_id is not null and specimen_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(person_id order by person_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from specimen where person_id is not null and specimen_date between  '20100101' and '20211231') a) i  ,(select max(person_id) as n4_qrtl_cnt from specimen where  person_id is not null and specimen_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select person_id as mode_vl, count(person_id) as mode_cnt from specimen where  person_id is not null  and specimen_date between  '20100101' and '20211231' group by person_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98140' as tbl_id, '9814003' as col_id,  3 as col_seq from specimen where specimen_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from specimen where  specimen_concept_id is not null and specimen_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from specimen where  specimen_concept_id is null and specimen_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from specimen where person_id  is not null and specimen_date between  '20100101' and '20211231' ) d  ,(select sum(specimen_concept_id) as ave from specimen where  specimen_concept_id is not null and specimen_date between  '20100101' and '20211231') e   ,(select min(specimen_concept_id) as min_vl from specimen where  specimen_concept_id is not null and specimen_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(specimen_concept_id order by specimen_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from specimen where specimen_concept_id is not null and specimen_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(specimen_concept_id order by specimen_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from specimen where specimen_concept_id is not null and specimen_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(specimen_concept_id order by specimen_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from specimen where specimen_concept_id is not null and specimen_date between  '20100101' and '20211231') a) i  ,(select max(specimen_concept_id) as n4_qrtl_cnt from specimen where  specimen_concept_id is not null and specimen_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select specimen_concept_id as mode_vl, count(specimen_concept_id) as mode_cnt from specimen where  specimen_concept_id is not null  and specimen_date between  '20100101' and '20211231' group by specimen_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98140' as tbl_id, '9814004' as col_id,  4 as col_seq from specimen where specimen_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from specimen where  specimen_type_concept_id is not null and specimen_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from specimen where  specimen_type_concept_id is null and specimen_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from specimen where person_id  is not null and specimen_date between  '20100101' and '20211231' ) d  ,(select sum(specimen_type_concept_id) as ave from specimen where  specimen_type_concept_id is not null and specimen_date between  '20100101' and '20211231') e   ,(select min(specimen_type_concept_id) as min_vl from specimen where  specimen_type_concept_id is not null and specimen_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(specimen_type_concept_id order by specimen_type_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from specimen where specimen_type_concept_id is not null and specimen_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(specimen_type_concept_id order by specimen_type_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from specimen where specimen_type_concept_id is not null and specimen_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(specimen_type_concept_id order by specimen_type_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from specimen where specimen_type_concept_id is not null and specimen_date between  '20100101' and '20211231') a) i  ,(select max(specimen_type_concept_id) as n4_qrtl_cnt from specimen where  specimen_type_concept_id is not null and specimen_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select specimen_type_concept_id as mode_vl, count(specimen_type_concept_id) as mode_cnt from specimen where  specimen_type_concept_id is not null  and specimen_date between  '20100101' and '20211231' group by specimen_type_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98140' as tbl_id, '9814007' as col_id,  7 as col_seq from specimen where specimen_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from specimen where  quantity is not null and specimen_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from specimen where  quantity is null and specimen_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from specimen where person_id  is not null and specimen_date between  '20100101' and '20211231' ) d  ,(select sum(quantity) as ave from specimen where  quantity is not null and specimen_date between  '20100101' and '20211231') e   ,(select min(quantity) as min_vl from specimen where  quantity is not null and specimen_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(quantity order by quantity separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from specimen where quantity is not null and specimen_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(quantity order by quantity separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from specimen where quantity is not null and specimen_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(quantity order by quantity separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from specimen where quantity is not null and specimen_date between  '20100101' and '20211231') a) i  ,(select max(quantity) as n4_qrtl_cnt from specimen where  quantity is not null and specimen_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select quantity as mode_vl, count(quantity) as mode_cnt from specimen where  quantity is not null  and specimen_date between  '20100101' and '20211231' group by quantity ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98140' as tbl_id, '9814008' as col_id,  8 as col_seq from specimen where specimen_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from specimen where  unit_concept_id is not null and specimen_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from specimen where  unit_concept_id is null and specimen_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from specimen where person_id  is not null and specimen_date between  '20100101' and '20211231' ) d  ,(select sum(unit_concept_id) as ave from specimen where  unit_concept_id is not null and specimen_date between  '20100101' and '20211231') e   ,(select min(unit_concept_id) as min_vl from specimen where  unit_concept_id is not null and specimen_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(unit_concept_id order by unit_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from specimen where unit_concept_id is not null and specimen_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(unit_concept_id order by unit_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from specimen where unit_concept_id is not null and specimen_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(unit_concept_id order by unit_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from specimen where unit_concept_id is not null and specimen_date between  '20100101' and '20211231') a) i  ,(select max(unit_concept_id) as n4_qrtl_cnt from specimen where  unit_concept_id is not null and specimen_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select unit_concept_id as mode_vl, count(unit_concept_id) as mode_cnt from specimen where  unit_concept_id is not null  and specimen_date between  '20100101' and '20211231' group by unit_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98140' as tbl_id, '9814009' as col_id,  9 as col_seq from specimen where specimen_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from specimen where  anatomic_site_concept_id is not null and specimen_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from specimen where  anatomic_site_concept_id is null and specimen_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from specimen where person_id  is not null and specimen_date between  '20100101' and '20211231' ) d  ,(select sum(anatomic_site_concept_id) as ave from specimen where  anatomic_site_concept_id is not null and specimen_date between  '20100101' and '20211231') e   ,(select min(anatomic_site_concept_id) as min_vl from specimen where  anatomic_site_concept_id is not null and specimen_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(anatomic_site_concept_id order by anatomic_site_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from specimen where anatomic_site_concept_id is not null and specimen_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(anatomic_site_concept_id order by anatomic_site_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from specimen where anatomic_site_concept_id is not null and specimen_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(anatomic_site_concept_id order by anatomic_site_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from specimen where anatomic_site_concept_id is not null and specimen_date between  '20100101' and '20211231') a) i  ,(select max(anatomic_site_concept_id) as n4_qrtl_cnt from specimen where  anatomic_site_concept_id is not null and specimen_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select anatomic_site_concept_id as mode_vl, count(anatomic_site_concept_id) as mode_cnt from specimen where  anatomic_site_concept_id is not null  and specimen_date between  '20100101' and '20211231' group by anatomic_site_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98140' as tbl_id, '9814010' as col_id,  10 as col_seq from specimen where specimen_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from specimen where  disease_status_concept_id is not null and specimen_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from specimen where  disease_status_concept_id is null and specimen_date between  '20100101' and '20211231') c  ,(select count(distinct person_id) as pt_cnt from specimen where person_id  is not null and specimen_date between  '20100101' and '20211231' ) d  ,(select sum(disease_status_concept_id) as ave from specimen where  disease_status_concept_id is not null and specimen_date between  '20100101' and '20211231') e   ,(select min(disease_status_concept_id) as min_vl from specimen where  disease_status_concept_id is not null and specimen_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(disease_status_concept_id order by disease_status_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from specimen where disease_status_concept_id is not null and specimen_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(disease_status_concept_id order by disease_status_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from specimen where disease_status_concept_id is not null and specimen_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(disease_status_concept_id order by disease_status_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from specimen where disease_status_concept_id is not null and specimen_date between  '20100101' and '20211231') a) i  ,(select max(disease_status_concept_id) as n4_qrtl_cnt from specimen where  disease_status_concept_id is not null and specimen_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select disease_status_concept_id as mode_vl, count(disease_status_concept_id) as mode_cnt from specimen where  disease_status_concept_id is not null  and specimen_date between  '20100101' and '20211231' group by disease_status_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,null  ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98130' as tbl_id, '9813001' as col_id,  1 as col_seq from note_nlp where nlp_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from note_nlp where  note_nlp_id is not null and nlp_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from note_nlp where  note_nlp_id is null and nlp_date between  '20100101' and '20211231') c ;        
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,null,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98130' as tbl_id, '9813002' as col_id,  2 as col_seq from note_nlp where nlp_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from note_nlp where  note_id is not null and nlp_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from note_nlp where  note_id is null and nlp_date between  '20100101' and '20211231') c   ,(select sum(note_id) as ave from note_nlp where  note_id is not null and nlp_date between  '20100101' and '20211231') e   ,(select min(note_id) as min_vl from note_nlp where  note_id is not null and nlp_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(note_id order by note_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from note_nlp where note_id is not null and nlp_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(note_id order by note_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from note_nlp where note_id is not null and nlp_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(note_id order by note_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from note_nlp where note_id is not null and nlp_date between  '20100101' and '20211231') a) i  ,(select max(note_id) as n4_qrtl_cnt from note_nlp where  note_id is not null and nlp_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select note_id as mode_vl, count(note_id) as mode_cnt from note_nlp where  note_id is not null  and nlp_date between  '20100101' and '20211231' group by note_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,null,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98130' as tbl_id, '9813003' as col_id,  3 as col_seq from note_nlp where nlp_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from note_nlp where  section_concept_id is not null and nlp_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from note_nlp where  section_concept_id is null and nlp_date between  '20100101' and '20211231') c   ,(select sum(section_concept_id) as ave from note_nlp where  section_concept_id is not null and nlp_date between  '20100101' and '20211231') e   ,(select min(section_concept_id) as min_vl from note_nlp where  section_concept_id is not null and nlp_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(section_concept_id order by section_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from note_nlp where section_concept_id is not null and nlp_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(section_concept_id order by section_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from note_nlp where section_concept_id is not null and nlp_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(section_concept_id order by section_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from note_nlp where section_concept_id is not null and nlp_date between  '20100101' and '20211231') a) i  ,(select max(section_concept_id) as n4_qrtl_cnt from note_nlp where  section_concept_id is not null and nlp_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select section_concept_id as mode_vl, count(section_concept_id) as mode_cnt from note_nlp where  section_concept_id is not null  and nlp_date between  '20100101' and '20211231' group by section_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,null,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98130' as tbl_id, '9813007' as col_id,  7 as col_seq from note_nlp where nlp_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from note_nlp where  note_nlp_concept_id is not null and nlp_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from note_nlp where  note_nlp_concept_id is null and nlp_date between  '20100101' and '20211231') c   ,(select sum(note_nlp_concept_id) as ave from note_nlp where  note_nlp_concept_id is not null and nlp_date between  '20100101' and '20211231') e   ,(select min(note_nlp_concept_id) as min_vl from note_nlp where  note_nlp_concept_id is not null and nlp_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(note_nlp_concept_id order by note_nlp_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from note_nlp where note_nlp_concept_id is not null and nlp_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(note_nlp_concept_id order by note_nlp_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from note_nlp where note_nlp_concept_id is not null and nlp_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(note_nlp_concept_id order by note_nlp_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from note_nlp where note_nlp_concept_id is not null and nlp_date between  '20100101' and '20211231') a) i  ,(select max(note_nlp_concept_id) as n4_qrtl_cnt from note_nlp where  note_nlp_concept_id is not null and nlp_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select note_nlp_concept_id as mode_vl, count(note_nlp_concept_id) as mode_cnt from note_nlp where  note_nlp_concept_id is not null  and nlp_date between  '20100101' and '20211231' group by note_nlp_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,null,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98130' as tbl_id, '9813008' as col_id,  8 as col_seq from note_nlp where nlp_date between  '20100101' and '20211231' )  a  ,(select count(*) as row_cnt from note_nlp where  note_nlp_source_concept_id is not null and nlp_date between  '20100101' and '20211231') b  ,(select count(*) as null_ncs from note_nlp where  note_nlp_source_concept_id is null and nlp_date between  '20100101' and '20211231') c   ,(select sum(note_nlp_source_concept_id) as ave from note_nlp where  note_nlp_source_concept_id is not null and nlp_date between  '20100101' and '20211231') e   ,(select min(note_nlp_source_concept_id) as min_vl from note_nlp where  note_nlp_source_concept_id is not null and nlp_date between  '20100101' and '20211231') f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(note_nlp_source_concept_id order by note_nlp_source_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from note_nlp where note_nlp_source_concept_id is not null and nlp_date between  '20100101' and '20211231') a) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(note_nlp_source_concept_id order by note_nlp_source_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from note_nlp where note_nlp_source_concept_id is not null and nlp_date between  '20100101' and '20211231') a) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(note_nlp_source_concept_id order by note_nlp_source_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from note_nlp where note_nlp_source_concept_id is not null and nlp_date between  '20100101' and '20211231') a) i  ,(select max(note_nlp_source_concept_id) as n4_qrtl_cnt from note_nlp where  note_nlp_source_concept_id is not null and nlp_date between  '20100101' and '20211231') j   ,(select  a.mode_vl, max(a.mode_cnt) from (select note_nlp_source_concept_id as mode_vl, count(note_nlp_source_concept_id) as mode_cnt from note_nlp where  note_nlp_source_concept_id is not null  and nlp_date between  '20100101' and '20211231' group by note_nlp_source_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt   ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211235'  as coll_end_ymd ,current_timestamp as crtn_dt from (select '9999' as hosp_cd,'98010' as tbl_id, '9801001' as col_id,  1 as col_seq from person )  a  ,(select count(*) as row_cnt from person where  person_id is not null ) b  ,(select count(*) as null_ncs from person where  person_id is null ) c  ,(select count(distinct person_id) as pt_cnt from person where person_id  is not null  ) d ;       
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98010' as tbl_id, '9801002' as col_id,  2 as col_seq from person )  a  ,(select count(*) as row_cnt from person where  gender_concept_id is not null ) b  ,(select count(*) as null_ncs from person where  gender_concept_id is null ) c  ,(select count(distinct person_id) as pt_cnt from person where person_id  is not null  ) d  ,(select sum(gender_concept_id) as ave from person where  gender_concept_id is not null ) e   ,(select min(gender_concept_id) as min_vl from person where  gender_concept_id is not null ) f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(gender_concept_id order by gender_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from person where gender_concept_id is not null ) a ) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(gender_concept_id order by gender_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from person where gender_concept_id is not null ) a ) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(gender_concept_id order by gender_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from person where gender_concept_id is not null ) a ) i  ,(select max(gender_concept_id) as n4_qrtl_cnt from person where  gender_concept_id is not null ) j   ,(select  a.mode_vl, max(a.mode_cnt) from (select gender_concept_id as mode_vl, count(gender_concept_id) as mode_cnt from person where  gender_concept_id is not null  group by gender_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98010' as tbl_id, '9801003' as col_id,  3 as col_seq from person )  a  ,(select count(*) as row_cnt from person where  year_of_birth is not null ) b  ,(select count(*) as null_ncs from person where  year_of_birth is null ) c  ,(select count(distinct person_id) as pt_cnt from person where person_id  is not null  ) d  ,(select sum(year_of_birth) as ave from person where  year_of_birth is not null ) e   ,(select min(year_of_birth) as min_vl from person where  year_of_birth is not null ) f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(year_of_birth order by year_of_birth separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from person where year_of_birth is not null ) a ) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(year_of_birth order by year_of_birth separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from person where year_of_birth is not null ) a ) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(year_of_birth order by year_of_birth separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from person where year_of_birth is not null ) a ) i  ,(select max(year_of_birth) as n4_qrtl_cnt from person where  year_of_birth is not null ) j   ,(select  a.mode_vl, max(a.mode_cnt) from (select year_of_birth as mode_vl, count(year_of_birth) as mode_cnt from person where  year_of_birth is not null  group by year_of_birth ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98010' as tbl_id, '9801004' as col_id,  4 as col_seq from person )  a  ,(select count(*) as row_cnt from person where  month_of_birth is not null ) b  ,(select count(*) as null_ncs from person where  month_of_birth is null ) c  ,(select count(distinct person_id) as pt_cnt from person where person_id  is not null  ) d  ,(select sum(month_of_birth) as ave from person where  month_of_birth is not null ) e   ,(select min(month_of_birth) as min_vl from person where  month_of_birth is not null ) f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(month_of_birth order by month_of_birth separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from person where month_of_birth is not null ) a ) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(month_of_birth order by month_of_birth separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from person where month_of_birth is not null ) a ) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(month_of_birth order by month_of_birth separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from person where month_of_birth is not null ) a ) i  ,(select max(month_of_birth) as n4_qrtl_cnt from person where  month_of_birth is not null ) j   ,(select  a.mode_vl, max(a.mode_cnt) from (select month_of_birth as mode_vl, count(month_of_birth) as mode_cnt from person where  month_of_birth is not null  group by month_of_birth ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98010' as tbl_id, '9801005' as col_id,  5 as col_seq from person )  a  ,(select count(*) as row_cnt from person where  day_of_birth is not null ) b  ,(select count(*) as null_ncs from person where  day_of_birth is null ) c  ,(select count(distinct person_id) as pt_cnt from person where person_id  is not null  ) d  ,(select sum(day_of_birth) as ave from person where  day_of_birth is not null ) e   ,(select min(day_of_birth) as min_vl from person where  day_of_birth is not null ) f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(day_of_birth order by day_of_birth separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from person where day_of_birth is not null ) a ) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(day_of_birth order by day_of_birth separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from person where day_of_birth is not null ) a ) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(day_of_birth order by day_of_birth separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from person where day_of_birth is not null ) a ) i  ,(select max(day_of_birth) as n4_qrtl_cnt from person where  day_of_birth is not null ) j   ,(select  a.mode_vl, max(a.mode_cnt) from (select day_of_birth as mode_vl, count(day_of_birth) as mode_cnt from person where  day_of_birth is not null  group by day_of_birth ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98010' as tbl_id, '9801007' as col_id,  7 as col_seq from person )  a  ,(select count(*) as row_cnt from person where  race_concept_id is not null ) b  ,(select count(*) as null_ncs from person where  race_concept_id is null ) c  ,(select count(distinct person_id) as pt_cnt from person where person_id  is not null  ) d  ,(select sum(race_concept_id) as ave from person where  race_concept_id is not null ) e   ,(select min(race_concept_id) as min_vl from person where  race_concept_id is not null ) f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(race_concept_id order by race_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from person where race_concept_id is not null ) a ) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(race_concept_id order by race_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from person where race_concept_id is not null ) a ) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(race_concept_id order by race_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from person where race_concept_id is not null ) a ) i  ,(select max(race_concept_id) as n4_qrtl_cnt from person where  race_concept_id is not null ) j   ,(select  a.mode_vl, max(a.mode_cnt) from (select race_concept_id as mode_vl, count(race_concept_id) as mode_cnt from person where  race_concept_id is not null  group by race_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98010' as tbl_id, '9801008' as col_id,  8 as col_seq from person )  a  ,(select count(*) as row_cnt from person where  ethnicity_concept_id is not null ) b  ,(select count(*) as null_ncs from person where  ethnicity_concept_id is null ) c  ,(select count(distinct person_id) as pt_cnt from person where person_id  is not null  ) d  ,(select sum(ethnicity_concept_id) as ave from person where  ethnicity_concept_id is not null ) e   ,(select min(ethnicity_concept_id) as min_vl from person where  ethnicity_concept_id is not null ) f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(ethnicity_concept_id order by ethnicity_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from person where ethnicity_concept_id is not null ) a ) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(ethnicity_concept_id order by ethnicity_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from person where ethnicity_concept_id is not null ) a ) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(ethnicity_concept_id order by ethnicity_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from person where ethnicity_concept_id is not null ) a ) i  ,(select max(ethnicity_concept_id) as n4_qrtl_cnt from person where  ethnicity_concept_id is not null ) j   ,(select  a.mode_vl, max(a.mode_cnt) from (select ethnicity_concept_id as mode_vl, count(ethnicity_concept_id) as mode_cnt from person where  ethnicity_concept_id is not null  group by ethnicity_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98010' as tbl_id, '9801009' as col_id,  9 as col_seq from person )  a  ,(select count(*) as row_cnt from person where  location_id is not null ) b  ,(select count(*) as null_ncs from person where  location_id is null ) c  ,(select count(distinct person_id) as pt_cnt from person where person_id  is not null  ) d  ,(select sum(location_id) as ave from person where  location_id is not null ) e   ,(select min(location_id) as min_vl from person where  location_id is not null ) f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(location_id order by location_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from person where location_id is not null ) a ) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(location_id order by location_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from person where location_id is not null ) a ) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(location_id order by location_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from person where location_id is not null ) a ) i  ,(select max(location_id) as n4_qrtl_cnt from person where  location_id is not null ) j   ,(select  a.mode_vl, max(a.mode_cnt) from (select location_id as mode_vl, count(location_id) as mode_cnt from person where  location_id is not null  group by location_id ) a group by a.mode_vl limit 1) k ;
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98010' as tbl_id, '9801010' as col_id,  10 as col_seq from person )  a  ,(select count(*) as row_cnt from person where  provider_id is not null ) b  ,(select count(*) as null_ncs from person where  provider_id is null ) c  ,(select count(distinct person_id) as pt_cnt from person where person_id  is not null  ) d  ,(select sum(provider_id) as ave from person where  provider_id is not null ) e   ,(select min(provider_id) as min_vl from person where  provider_id is not null ) f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from person where provider_id is not null ) a ) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from person where provider_id is not null ) a ) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(provider_id order by provider_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from person where provider_id is not null ) a ) i  ,(select max(provider_id) as n4_qrtl_cnt from person where  provider_id is not null ) j   ,(select  a.mode_vl, max(a.mode_cnt) from (select provider_id as mode_vl, count(provider_id) as mode_cnt from person where  provider_id is not null  group by provider_id ) a group by a.mode_vl limit 1) k ;*/
/*insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98010' as tbl_id, '9801011' as col_id,  11 as col_seq from person )  a  ,(select count(*) as row_cnt from person where  care_site_id is not null ) b  ,(select count(*) as null_ncs from person where  care_site_id is null ) c  ,(select count(distinct person_id) as pt_cnt from person where person_id  is not null  ) d  ,(select sum(care_site_id) as ave from person where  care_site_id is not null ) e   ,(select min(care_site_id) as min_vl from person where  care_site_id is not null ) f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(care_site_id order by care_site_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from person where care_site_id is not null ) a ) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(care_site_id order by care_site_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from person where care_site_id is not null ) a ) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(care_site_id order by care_site_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from person where care_site_id is not null ) a ) i  ,(select max(care_site_id) as n4_qrtl_cnt from person where  care_site_id is not null ) j   ,(select  a.mode_vl, max(a.mode_cnt) from (select care_site_id as mode_vl, count(care_site_id) as mode_cnt from person where  care_site_id is not null  group by care_site_id ) a group by a.mode_vl limit 1) k ;*/
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98010' as tbl_id, '9801014' as col_id,  14 as col_seq from person )  a  ,(select count(*) as row_cnt from person where  gender_source_concept_id is not null ) b  ,(select count(*) as null_ncs from person where  gender_source_concept_id is null ) c  ,(select count(distinct person_id) as pt_cnt from person where person_id  is not null  ) d  ,(select sum(gender_source_concept_id) as ave from person where  gender_source_concept_id is not null ) e   ,(select min(gender_source_concept_id) as min_vl from person where  gender_source_concept_id is not null ) f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(gender_source_concept_id order by gender_source_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from person where gender_source_concept_id is not null ) a ) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(gender_source_concept_id order by gender_source_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from person where gender_source_concept_id is not null ) a ) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(gender_source_concept_id order by gender_source_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from person where gender_source_concept_id is not null ) a ) i  ,(select max(gender_source_concept_id) as n4_qrtl_cnt from person where  gender_source_concept_id is not null ) j   ,(select  a.mode_vl, max(a.mode_cnt) from (select gender_source_concept_id as mode_vl, count(gender_source_concept_id) as mode_cnt from person where  gender_source_concept_id is not null  group by gender_source_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98010' as tbl_id, '9801016' as col_id,  16 as col_seq from person )  a  ,(select count(*) as row_cnt from person where  race_source_concept_id is not null ) b  ,(select count(*) as null_ncs from person where  race_source_concept_id is null ) c  ,(select count(distinct person_id) as pt_cnt from person where person_id  is not null  ) d  ,(select sum(race_source_concept_id) as ave from person where  race_source_concept_id is not null ) e   ,(select min(race_source_concept_id) as min_vl from person where  race_source_concept_id is not null ) f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(race_source_concept_id order by race_source_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from person where race_source_concept_id is not null ) a ) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(race_source_concept_id order by race_source_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from person where race_source_concept_id is not null ) a ) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(race_source_concept_id order by race_source_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from person where race_source_concept_id is not null ) a ) i  ,(select max(race_source_concept_id) as n4_qrtl_cnt from person where  race_source_concept_id is not null ) j   ,(select  a.mode_vl, max(a.mode_cnt) from (select race_source_concept_id as mode_vl, count(race_source_concept_id) as mode_cnt from person where  race_source_concept_id is not null  group by race_source_concept_id ) a group by a.mode_vl limit 1) k ;
insert into cncr_tbl_col_dtrn_stats (hosp_cd ,tbl_id ,col_id ,col_seq ,row_cnt ,null_ncs ,pt_cnt ,ave_vl,min_vl ,n1_qrtl_cnt ,n2_qrtl_cnt ,n3_qrtl_cnt ,n4_qrtl_cnt ,mode_vl ,stats_work_ymd ,coll_strt_ymd ,coll_end_ymd,crtn_dt ) select distinct  a.hosp_cd ,a.tbl_id ,a.col_id ,a.col_seq ,b.row_cnt ,c.null_ncs ,d.pt_cnt,e.ave / row_cnt ,f.min_vl   ,g.n1_qrtl_cnt ,h.n2_qrtl_cnt ,i.n3_qrtl_cnt ,j.n4_qrtl_cnt,k.mode_vl ,date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd ,current_timestamp as crtn_dt  from (select '9999' as hosp_cd,'98010' as tbl_id, '9801018' as col_id,  18 as col_seq from person )  a  ,(select count(*) as row_cnt from person where  ethnicity_source_concept_id is not null ) b  ,(select count(*) as null_ncs from person where  ethnicity_source_concept_id is null ) c  ,(select count(distinct person_id) as pt_cnt from person where person_id  is not null  ) d  ,(select sum(ethnicity_source_concept_id) as ave from person where  ethnicity_source_concept_id is not null ) e   ,(select min(ethnicity_source_concept_id) as min_vl from person where  ethnicity_source_concept_id is not null ) f   , (select sum(a.n1_qrtl_cnt) as n1_qrtl_cnt  from (select substring_index(substring_index(group_concat(ethnicity_source_concept_id order by ethnicity_source_concept_id separator ','), ',', 25/100 * count(*) +1), ',', -1) n1_qrtl_cnt from person where ethnicity_source_concept_id is not null ) a ) g  , (select sum(a.n2_qrtl_cnt) as n2_qrtl_cnt  from (select substring_index(substring_index(group_concat(ethnicity_source_concept_id order by ethnicity_source_concept_id separator ','), ',', 50/100 * count(*) +1), ',', -1) n2_qrtl_cnt from person where ethnicity_source_concept_id is not null ) a ) h  , (select sum(a.n3_qrtl_cnt) as n3_qrtl_cnt  from (select substring_index(substring_index(group_concat(ethnicity_source_concept_id order by ethnicity_source_concept_id separator ','), ',', 75/100 * count(*) +1), ',', -1) n3_qrtl_cnt from person where ethnicity_source_concept_id is not null ) a ) i  ,(select max(ethnicity_source_concept_id) as n4_qrtl_cnt from person where  ethnicity_source_concept_id is not null ) j   ,(select  a.mode_vl, max(a.mode_cnt) from (select ethnicity_source_concept_id as mode_vl, count(ethnicity_source_concept_id) as mode_cnt from person where  ethnicity_source_concept_id is not null  group by ethnicity_source_concept_id ) a group by a.mode_vl limit 1) k ;
