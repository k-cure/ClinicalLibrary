insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98020' as tbl_id , '9802001' as col_id, 1 as col_seq from observation_period where observation_period_id is not null )  a  ,(select substr(date_format(observation_period_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation_period where  observation_period_id is not null  and observation_period_start_date between  '20100101' and '20211231' group by substring(date_format(observation_period_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_period_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation_period  where observation_period_id is not null  and observation_period_start_date between  '20100101' and '20211231' group by substr(date_format(observation_period_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98020' as tbl_id , '9802002' as col_id, 2 as col_seq from observation_period where person_id is not null )  a  ,(select substr(date_format(observation_period_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation_period where  person_id is not null  and observation_period_start_date between  '20100101' and '20211231' group by substring(date_format(observation_period_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_period_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation_period  where person_id is not null  and observation_period_start_date between  '20100101' and '20211231' group by substr(date_format(observation_period_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98020' as tbl_id , '9802003' as col_id, 3 as col_seq from observation_period where observation_period_start_date is not null )  a  ,(select substr(date_format(observation_period_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation_period where  observation_period_start_date is not null  and observation_period_start_date between  '20100101' and '20211231' group by substring(date_format(observation_period_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_period_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation_period  where observation_period_start_date is not null  and observation_period_start_date between  '20100101' and '20211231' group by substr(date_format(observation_period_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98020' as tbl_id , '9802004' as col_id, 4 as col_seq from observation_period where observation_period_end_date is not null )  a  ,(select substr(date_format(observation_period_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation_period where  observation_period_end_date is not null  and observation_period_start_date between  '20100101' and '20211231' group by substring(date_format(observation_period_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_period_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation_period  where observation_period_end_date is not null  and observation_period_start_date between  '20100101' and '20211231' group by substr(date_format(observation_period_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98020' as tbl_id , '9802005' as col_id, 5 as col_seq from observation_period where period_type_concept_id is not null )  a  ,(select substr(date_format(observation_period_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation_period where  period_type_concept_id is not null  and observation_period_start_date between  '20100101' and '20211231' group by substring(date_format(observation_period_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_period_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation_period  where period_type_concept_id is not null  and observation_period_start_date between  '20100101' and '20211231' group by substr(date_format(observation_period_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98030' as tbl_id , '9803001' as col_id, 1 as col_seq from visit_occurrence where visit_occurrence_id is not null )  a  ,(select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_occurrence where  visit_occurrence_id is not null  and visit_start_date between  '20100101' and '20211231' group by substring(date_format(visit_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_occurrence  where visit_occurrence_id is not null  and visit_start_date between  '20100101' and '20211231' group by substr(date_format(visit_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98030' as tbl_id , '9803002' as col_id, 2 as col_seq from visit_occurrence where person_id is not null )  a  ,(select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_occurrence where  person_id is not null  and visit_start_date between  '20100101' and '20211231' group by substring(date_format(visit_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_occurrence  where person_id is not null  and visit_start_date between  '20100101' and '20211231' group by substr(date_format(visit_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98030' as tbl_id , '9803003' as col_id, 3 as col_seq from visit_occurrence where visit_concept_id is not null )  a  ,(select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_occurrence where  visit_concept_id is not null  and visit_start_date between  '20100101' and '20211231' group by substring(date_format(visit_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_occurrence  where visit_concept_id is not null  and visit_start_date between  '20100101' and '20211231' group by substr(date_format(visit_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98030' as tbl_id , '9803004' as col_id, 4 as col_seq from visit_occurrence where visit_start_date is not null )  a  ,(select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_occurrence where  visit_start_date is not null  and visit_start_date between  '20100101' and '20211231' group by substring(date_format(visit_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_occurrence  where visit_start_date is not null  and visit_start_date between  '20100101' and '20211231' group by substr(date_format(visit_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98030' as tbl_id , '9803005' as col_id, 5 as col_seq from visit_occurrence where visit_start_datetime is not null )  a  ,(select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_occurrence where  visit_start_datetime is not null  and visit_start_date between  '20100101' and '20211231' group by substring(date_format(visit_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_occurrence  where visit_start_datetime is not null  and visit_start_date between  '20100101' and '20211231' group by substr(date_format(visit_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98030' as tbl_id , '9803006' as col_id, 6 as col_seq from visit_occurrence where visit_end_date is not null )  a  ,(select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_occurrence where  visit_end_date is not null  and visit_start_date between  '20100101' and '20211231' group by substring(date_format(visit_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_occurrence  where visit_end_date is not null  and visit_start_date between  '20100101' and '20211231' group by substr(date_format(visit_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98030' as tbl_id , '9803007' as col_id, 7 as col_seq from visit_occurrence where visit_end_datetime is not null )  a  ,(select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_occurrence where  visit_end_datetime is not null  and visit_start_date between  '20100101' and '20211231' group by substring(date_format(visit_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_occurrence  where visit_end_datetime is not null  and visit_start_date between  '20100101' and '20211231' group by substr(date_format(visit_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98030' as tbl_id , '9803008' as col_id, 8 as col_seq from visit_occurrence where visit_type_concept_id is not null )  a  ,(select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_occurrence where  visit_type_concept_id is not null  and visit_start_date between  '20100101' and '20211231' group by substring(date_format(visit_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_occurrence  where visit_type_concept_id is not null  and visit_start_date between  '20100101' and '20211231' group by substr(date_format(visit_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98030' as tbl_id , '9803009' as col_id, 9 as col_seq from visit_occurrence where provider_id is not null )  a  ,(select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_occurrence where  provider_id is not null  and visit_start_date between  '20100101' and '20211231' group by substring(date_format(visit_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_occurrence  where provider_id is not null  and visit_start_date between  '20100101' and '20211231' group by substr(date_format(visit_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98030' as tbl_id , '9803010' as col_id, 10 as col_seq from visit_occurrence where care_site_id is not null )  a  ,(select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_occurrence where  care_site_id is not null  and visit_start_date between  '20100101' and '20211231' group by substring(date_format(visit_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_occurrence  where care_site_id is not null  and visit_start_date between  '20100101' and '20211231' group by substr(date_format(visit_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98030' as tbl_id , '9803011' as col_id, 11 as col_seq from visit_occurrence where visit_source_value is not null )  a  ,(select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_occurrence where  visit_source_value is not null  and visit_start_date between  '20100101' and '20211231' group by substring(date_format(visit_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_occurrence  where visit_source_value is not null  and visit_start_date between  '20100101' and '20211231' group by substr(date_format(visit_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98030' as tbl_id , '9803012' as col_id, 12 as col_seq from visit_occurrence where visit_source_concept_id is not null )  a  ,(select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_occurrence where  visit_source_concept_id is not null  and visit_start_date between  '20100101' and '20211231' group by substring(date_format(visit_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_occurrence  where visit_source_concept_id is not null  and visit_start_date between  '20100101' and '20211231' group by substr(date_format(visit_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98030' as tbl_id , '9803013' as col_id, 13 as col_seq from visit_occurrence where admitting_source_concept_id is not null )  a  ,(select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_occurrence where  admitting_source_concept_id is not null  and visit_start_date between  '20100101' and '20211231' group by substring(date_format(visit_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_occurrence  where admitting_source_concept_id is not null  and visit_start_date between  '20100101' and '20211231' group by substr(date_format(visit_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98030' as tbl_id , '9803014' as col_id, 14 as col_seq from visit_occurrence where admitting_source_value is not null )  a  ,(select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_occurrence where  admitting_source_value is not null  and visit_start_date between  '20100101' and '20211231' group by substring(date_format(visit_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_occurrence  where admitting_source_value is not null  and visit_start_date between  '20100101' and '20211231' group by substr(date_format(visit_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98030' as tbl_id , '9803015' as col_id, 15 as col_seq from visit_occurrence where discharge_to_concept_id is not null )  a  ,(select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_occurrence where  discharge_to_concept_id is not null  and visit_start_date between  '20100101' and '20211231' group by substring(date_format(visit_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_occurrence  where discharge_to_concept_id is not null  and visit_start_date between  '20100101' and '20211231' group by substr(date_format(visit_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98030' as tbl_id , '9803016' as col_id, 16 as col_seq from visit_occurrence where discharge_to_source_value is not null )  a  ,(select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_occurrence where  discharge_to_source_value is not null  and visit_start_date between  '20100101' and '20211231' group by substring(date_format(visit_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_occurrence  where discharge_to_source_value is not null  and visit_start_date between  '20100101' and '20211231' group by substr(date_format(visit_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98030' as tbl_id , '9803017' as col_id, 17 as col_seq from visit_occurrence where preceding_visit_occurrence_id is not null )  a  ,(select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_occurrence where  preceding_visit_occurrence_id is not null  and visit_start_date between  '20100101' and '20211231' group by substring(date_format(visit_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_occurrence  where preceding_visit_occurrence_id is not null  and visit_start_date between  '20100101' and '20211231' group by substr(date_format(visit_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804001' as col_id, 1 as col_seq from visit_detail where visit_detail_id is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  visit_detail_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where visit_detail_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804002' as col_id, 2 as col_seq from visit_detail where person_id is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  person_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where person_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804003' as col_id, 3 as col_seq from visit_detail where visit_detail_concept_id is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  visit_detail_concept_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where visit_detail_concept_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804004' as col_id, 4 as col_seq from visit_detail where visit_detail_start_date is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  visit_detail_start_date is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where visit_detail_start_date is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804005' as col_id, 5 as col_seq from visit_detail where visit_detail_start_datetime is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  visit_detail_start_datetime is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where visit_detail_start_datetime is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804006' as col_id, 6 as col_seq from visit_detail where visit_detail_end_date is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  visit_detail_end_date is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where visit_detail_end_date is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804007' as col_id, 7 as col_seq from visit_detail where visit_detail_end_datetime is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  visit_detail_end_datetime is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where visit_detail_end_datetime is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804008' as col_id, 8 as col_seq from visit_detail where visit_detail_type_concept_id is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  visit_detail_type_concept_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where visit_detail_type_concept_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804009' as col_id, 9 as col_seq from visit_detail where provider_id is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  provider_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where provider_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804010' as col_id, 10 as col_seq from visit_detail where care_site_id is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  care_site_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where care_site_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804011' as col_id, 11 as col_seq from visit_detail where visit_detail_source_value is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  visit_detail_source_value is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where visit_detail_source_value is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804012' as col_id, 12 as col_seq from visit_detail where visit_detail_source_concept_id is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  visit_detail_source_concept_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where visit_detail_source_concept_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804013' as col_id, 13 as col_seq from visit_detail where admitting_source_value is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  admitting_source_value is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where admitting_source_value is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804014' as col_id, 14 as col_seq from visit_detail where admitting_source_concept_id is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  admitting_source_concept_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where admitting_source_concept_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804015' as col_id, 15 as col_seq from visit_detail where discharge_to_source_value is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  discharge_to_source_value is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where discharge_to_source_value is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804016' as col_id, 16 as col_seq from visit_detail where discharge_to_concept_id is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  discharge_to_concept_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where discharge_to_concept_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804017' as col_id, 17 as col_seq from visit_detail where preceding_visit_detail_id is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  preceding_visit_detail_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where preceding_visit_detail_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804018' as col_id, 18 as col_seq from visit_detail where visit_detail_parent_id is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  visit_detail_parent_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where visit_detail_parent_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98040' as tbl_id , '9804019' as col_id, 19 as col_seq from visit_detail where visit_occurrence_id is not null )  a  ,(select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from visit_detail where  visit_occurrence_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substring(date_format(visit_detail_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from visit_detail  where visit_occurrence_id is not null  and visit_detail_start_date between  '20100101' and '20211231' group by substr(date_format(visit_detail_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98050' as tbl_id , '9805001' as col_id, 1 as col_seq from condition_occurrence where condition_occurrence_id is not null )  a  ,(select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from condition_occurrence where  condition_occurrence_id is not null  and condition_start_date between  '20100101' and '20211231' group by substring(date_format(condition_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from condition_occurrence  where condition_occurrence_id is not null  and condition_start_date between  '20100101' and '20211231' group by substr(date_format(condition_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98050' as tbl_id , '9805002' as col_id, 2 as col_seq from condition_occurrence where person_id is not null )  a  ,(select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from condition_occurrence where  person_id is not null  and condition_start_date between  '20100101' and '20211231' group by substring(date_format(condition_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from condition_occurrence  where person_id is not null  and condition_start_date between  '20100101' and '20211231' group by substr(date_format(condition_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98050' as tbl_id , '9805003' as col_id, 3 as col_seq from condition_occurrence where condition_concept_id is not null )  a  ,(select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from condition_occurrence where  condition_concept_id is not null  and condition_start_date between  '20100101' and '20211231' group by substring(date_format(condition_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from condition_occurrence  where condition_concept_id is not null  and condition_start_date between  '20100101' and '20211231' group by substr(date_format(condition_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98050' as tbl_id , '9805004' as col_id, 4 as col_seq from condition_occurrence where condition_start_date is not null )  a  ,(select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from condition_occurrence where  condition_start_date is not null  and condition_start_date between  '20100101' and '20211231' group by substring(date_format(condition_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from condition_occurrence  where condition_start_date is not null  and condition_start_date between  '20100101' and '20211231' group by substr(date_format(condition_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98050' as tbl_id , '9805005' as col_id, 5 as col_seq from condition_occurrence where condition_start_datetime is not null )  a  ,(select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from condition_occurrence where  condition_start_datetime is not null  and condition_start_date between  '20100101' and '20211231' group by substring(date_format(condition_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from condition_occurrence  where condition_start_datetime is not null  and condition_start_date between  '20100101' and '20211231' group by substr(date_format(condition_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98050' as tbl_id , '9805006' as col_id, 6 as col_seq from condition_occurrence where condition_end_date is not null )  a  ,(select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from condition_occurrence where  condition_end_date is not null  and condition_start_date between  '20100101' and '20211231' group by substring(date_format(condition_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from condition_occurrence  where condition_end_date is not null  and condition_start_date between  '20100101' and '20211231' group by substr(date_format(condition_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98050' as tbl_id , '9805007' as col_id, 7 as col_seq from condition_occurrence where condition_end_datetime is not null )  a  ,(select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from condition_occurrence where  condition_end_datetime is not null  and condition_start_date between  '20100101' and '20211231' group by substring(date_format(condition_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from condition_occurrence  where condition_end_datetime is not null  and condition_start_date between  '20100101' and '20211231' group by substr(date_format(condition_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98050' as tbl_id , '9805008' as col_id, 8 as col_seq from condition_occurrence where condition_type_concept_id is not null )  a  ,(select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from condition_occurrence where  condition_type_concept_id is not null  and condition_start_date between  '20100101' and '20211231' group by substring(date_format(condition_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from condition_occurrence  where condition_type_concept_id is not null  and condition_start_date between  '20100101' and '20211231' group by substr(date_format(condition_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98050' as tbl_id , '9805009' as col_id, 9 as col_seq from condition_occurrence where condition_status_concept_id is not null )  a  ,(select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from condition_occurrence where  condition_status_concept_id is not null  and condition_start_date between  '20100101' and '20211231' group by substring(date_format(condition_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from condition_occurrence  where condition_status_concept_id is not null  and condition_start_date between  '20100101' and '20211231' group by substr(date_format(condition_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98050' as tbl_id , '9805010' as col_id, 10 as col_seq from condition_occurrence where stop_reason is not null )  a  ,(select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from condition_occurrence where  stop_reason is not null  and condition_start_date between  '20100101' and '20211231' group by substring(date_format(condition_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from condition_occurrence  where stop_reason is not null  and condition_start_date between  '20100101' and '20211231' group by substr(date_format(condition_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98050' as tbl_id , '9805011' as col_id, 11 as col_seq from condition_occurrence where provider_id is not null )  a  ,(select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from condition_occurrence where  provider_id is not null  and condition_start_date between  '20100101' and '20211231' group by substring(date_format(condition_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from condition_occurrence  where provider_id is not null  and condition_start_date between  '20100101' and '20211231' group by substr(date_format(condition_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98050' as tbl_id , '9805012' as col_id, 12 as col_seq from condition_occurrence where visit_occurrence_id is not null )  a  ,(select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from condition_occurrence where  visit_occurrence_id is not null  and condition_start_date between  '20100101' and '20211231' group by substring(date_format(condition_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from condition_occurrence  where visit_occurrence_id is not null  and condition_start_date between  '20100101' and '20211231' group by substr(date_format(condition_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98050' as tbl_id , '9805013' as col_id, 13 as col_seq from condition_occurrence where visit_detail_id is not null )  a  ,(select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from condition_occurrence where  visit_detail_id is not null  and condition_start_date between  '20100101' and '20211231' group by substring(date_format(condition_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from condition_occurrence  where visit_detail_id is not null  and condition_start_date between  '20100101' and '20211231' group by substr(date_format(condition_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98050' as tbl_id , '9805014' as col_id, 14 as col_seq from condition_occurrence where condition_source_value is not null )  a  ,(select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from condition_occurrence where  condition_source_value is not null  and condition_start_date between  '20100101' and '20211231' group by substring(date_format(condition_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from condition_occurrence  where condition_source_value is not null  and condition_start_date between  '20100101' and '20211231' group by substr(date_format(condition_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98050' as tbl_id , '9805015' as col_id, 15 as col_seq from condition_occurrence where condition_source_concept_id is not null )  a  ,(select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from condition_occurrence where  condition_source_concept_id is not null  and condition_start_date between  '20100101' and '20211231' group by substring(date_format(condition_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from condition_occurrence  where condition_source_concept_id is not null  and condition_start_date between  '20100101' and '20211231' group by substr(date_format(condition_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98050' as tbl_id , '9805016' as col_id, 16 as col_seq from condition_occurrence where condition_status_source_value is not null )  a  ,(select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from condition_occurrence where  condition_status_source_value is not null  and condition_start_date between  '20100101' and '20211231' group by substring(date_format(condition_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(condition_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from condition_occurrence  where condition_status_source_value is not null  and condition_start_date between  '20100101' and '20211231' group by substr(date_format(condition_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806001' as col_id, 1 as col_seq from drug_exposure where drug_exposure_id is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  drug_exposure_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where drug_exposure_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806002' as col_id, 2 as col_seq from drug_exposure where person_id is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  person_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where person_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806003' as col_id, 3 as col_seq from drug_exposure where drug_concept_id is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  drug_concept_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where drug_concept_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806004' as col_id, 4 as col_seq from drug_exposure where drug_exposure_start_date is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  drug_exposure_start_date is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where drug_exposure_start_date is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806005' as col_id, 5 as col_seq from drug_exposure where drug_exposure_start_datetime is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  drug_exposure_start_datetime is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where drug_exposure_start_datetime is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806006' as col_id, 6 as col_seq from drug_exposure where drug_exposure_end_date is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  drug_exposure_end_date is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where drug_exposure_end_date is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806007' as col_id, 7 as col_seq from drug_exposure where drug_exposure_end_datetime is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  drug_exposure_end_datetime is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where drug_exposure_end_datetime is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806008' as col_id, 8 as col_seq from drug_exposure where verbatim_end_date is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  verbatim_end_date is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where verbatim_end_date is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806009' as col_id, 9 as col_seq from drug_exposure where drug_type_concept_id is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  drug_type_concept_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where drug_type_concept_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806010' as col_id, 10 as col_seq from drug_exposure where stop_reason is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  stop_reason is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where stop_reason is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806011' as col_id, 11 as col_seq from drug_exposure where refills is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  refills is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where refills is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806012' as col_id, 12 as col_seq from drug_exposure where quantity is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  quantity is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where quantity is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806013' as col_id, 13 as col_seq from drug_exposure where days_supply is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  days_supply is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where days_supply is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806014' as col_id, 14 as col_seq from drug_exposure where sig is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  sig is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where sig is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806015' as col_id, 15 as col_seq from drug_exposure where route_concept_id is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  route_concept_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where route_concept_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806016' as col_id, 16 as col_seq from drug_exposure where lot_number is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  lot_number is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where lot_number is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806017' as col_id, 17 as col_seq from drug_exposure where provider_id is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  provider_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where provider_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806018' as col_id, 18 as col_seq from drug_exposure where visit_occurrence_id is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  visit_occurrence_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where visit_occurrence_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806019' as col_id, 19 as col_seq from drug_exposure where visit_detail_id is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  visit_detail_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where visit_detail_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806020' as col_id, 20 as col_seq from drug_exposure where drug_source_value is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  drug_source_value is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where drug_source_value is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806021' as col_id, 21 as col_seq from drug_exposure where drug_source_concept_id is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  drug_source_concept_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where drug_source_concept_id is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806022' as col_id, 22 as col_seq from drug_exposure where route_source_value is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  route_source_value is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where route_source_value is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98060' as tbl_id , '9806023' as col_id, 23 as col_seq from drug_exposure where dose_unit_source_value is not null )  a  ,(select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from drug_exposure where  dose_unit_source_value is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(drug_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from drug_exposure  where dose_unit_source_value is not null  and drug_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(drug_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98070' as tbl_id , '9807001' as col_id, 1 as col_seq from procedure_occurrence where procedure_occurrence_id is not null )  a  ,(select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from procedure_occurrence where  procedure_occurrence_id is not null  and procedure_date between  '20100101' and '20211231' group by substring(date_format(procedure_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr , person_id  from procedure_occurrence  where procedure_occurrence_id is not null  and procedure_date between  '20100101' and '20211231' group by substr(date_format(procedure_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98070' as tbl_id , '9807002' as col_id, 2 as col_seq from procedure_occurrence where person_id is not null )  a  ,(select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from procedure_occurrence where  person_id is not null  and procedure_date between  '20100101' and '20211231' group by substring(date_format(procedure_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr , person_id  from procedure_occurrence  where person_id is not null  and procedure_date between  '20100101' and '20211231' group by substr(date_format(procedure_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98070' as tbl_id , '9807003' as col_id, 3 as col_seq from procedure_occurrence where procedure_concept_id is not null )  a  ,(select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from procedure_occurrence where  procedure_concept_id is not null  and procedure_date between  '20100101' and '20211231' group by substring(date_format(procedure_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr , person_id  from procedure_occurrence  where procedure_concept_id is not null  and procedure_date between  '20100101' and '20211231' group by substr(date_format(procedure_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98070' as tbl_id , '9807004' as col_id, 4 as col_seq from procedure_occurrence where procedure_date is not null )  a  ,(select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from procedure_occurrence where  procedure_date is not null  and procedure_date between  '20100101' and '20211231' group by substring(date_format(procedure_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr , person_id  from procedure_occurrence  where procedure_date is not null  and procedure_date between  '20100101' and '20211231' group by substr(date_format(procedure_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98070' as tbl_id , '9807005' as col_id, 5 as col_seq from procedure_occurrence where procedure_datetime is not null )  a  ,(select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from procedure_occurrence where  procedure_datetime is not null  and procedure_date between  '20100101' and '20211231' group by substring(date_format(procedure_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr , person_id  from procedure_occurrence  where procedure_datetime is not null  and procedure_date between  '20100101' and '20211231' group by substr(date_format(procedure_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98070' as tbl_id , '9807006' as col_id, 6 as col_seq from procedure_occurrence where procedure_type_concept_id is not null )  a  ,(select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from procedure_occurrence where  procedure_type_concept_id is not null  and procedure_date between  '20100101' and '20211231' group by substring(date_format(procedure_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr , person_id  from procedure_occurrence  where procedure_type_concept_id is not null  and procedure_date between  '20100101' and '20211231' group by substr(date_format(procedure_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98070' as tbl_id , '9807007' as col_id, 7 as col_seq from procedure_occurrence where modifier_concept_id is not null )  a  ,(select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from procedure_occurrence where  modifier_concept_id is not null  and procedure_date between  '20100101' and '20211231' group by substring(date_format(procedure_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr , person_id  from procedure_occurrence  where modifier_concept_id is not null  and procedure_date between  '20100101' and '20211231' group by substr(date_format(procedure_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98070' as tbl_id , '9807008' as col_id, 8 as col_seq from procedure_occurrence where quantity is not null )  a  ,(select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from procedure_occurrence where  quantity is not null  and procedure_date between  '20100101' and '20211231' group by substring(date_format(procedure_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr , person_id  from procedure_occurrence  where quantity is not null  and procedure_date between  '20100101' and '20211231' group by substr(date_format(procedure_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98070' as tbl_id , '9807009' as col_id, 9 as col_seq from procedure_occurrence where provider_id is not null )  a  ,(select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from procedure_occurrence where  provider_id is not null  and procedure_date between  '20100101' and '20211231' group by substring(date_format(procedure_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr , person_id  from procedure_occurrence  where provider_id is not null  and procedure_date between  '20100101' and '20211231' group by substr(date_format(procedure_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98070' as tbl_id , '9807010' as col_id, 10 as col_seq from procedure_occurrence where visit_occurrence_id is not null )  a  ,(select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from procedure_occurrence where  visit_occurrence_id is not null  and procedure_date between  '20100101' and '20211231' group by substring(date_format(procedure_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr , person_id  from procedure_occurrence  where visit_occurrence_id is not null  and procedure_date between  '20100101' and '20211231' group by substr(date_format(procedure_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98070' as tbl_id , '9807011' as col_id, 11 as col_seq from procedure_occurrence where visit_detail_id is not null )  a  ,(select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from procedure_occurrence where  visit_detail_id is not null  and procedure_date between  '20100101' and '20211231' group by substring(date_format(procedure_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr , person_id  from procedure_occurrence  where visit_detail_id is not null  and procedure_date between  '20100101' and '20211231' group by substr(date_format(procedure_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98070' as tbl_id , '9807012' as col_id, 12 as col_seq from procedure_occurrence where procedure_source_value is not null )  a  ,(select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from procedure_occurrence where  procedure_source_value is not null  and procedure_date between  '20100101' and '20211231' group by substring(date_format(procedure_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr , person_id  from procedure_occurrence  where procedure_source_value is not null  and procedure_date between  '20100101' and '20211231' group by substr(date_format(procedure_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98070' as tbl_id , '9807013' as col_id, 13 as col_seq from procedure_occurrence where procedure_source_concept_id is not null )  a  ,(select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from procedure_occurrence where  procedure_source_concept_id is not null  and procedure_date between  '20100101' and '20211231' group by substring(date_format(procedure_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr , person_id  from procedure_occurrence  where procedure_source_concept_id is not null  and procedure_date between  '20100101' and '20211231' group by substr(date_format(procedure_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98070' as tbl_id , '9807014' as col_id, 14 as col_seq from procedure_occurrence where modifier_source_value is not null )  a  ,(select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from procedure_occurrence where  modifier_source_value is not null  and procedure_date between  '20100101' and '20211231' group by substring(date_format(procedure_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(procedure_date,'yyyymmdd'),1,4) as crit_yr , person_id  from procedure_occurrence  where modifier_source_value is not null  and procedure_date between  '20100101' and '20211231' group by substr(date_format(procedure_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98080' as tbl_id , '9808001' as col_id, 1 as col_seq from device_exposure where device_exposure_id is not null )  a  ,(select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from device_exposure where  device_exposure_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(device_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from device_exposure  where device_exposure_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98080' as tbl_id , '9808002' as col_id, 2 as col_seq from device_exposure where person_id is not null )  a  ,(select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from device_exposure where  person_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(device_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from device_exposure  where person_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98080' as tbl_id , '9808003' as col_id, 3 as col_seq from device_exposure where device_concept_id is not null )  a  ,(select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from device_exposure where  device_concept_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(device_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from device_exposure  where device_concept_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98080' as tbl_id , '9808004' as col_id, 4 as col_seq from device_exposure where device_exposure_start_date is not null )  a  ,(select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from device_exposure where  device_exposure_start_date is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(device_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from device_exposure  where device_exposure_start_date is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98080' as tbl_id , '9808005' as col_id, 5 as col_seq from device_exposure where device_exposure_start_datetime is not null )  a  ,(select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from device_exposure where  device_exposure_start_datetime is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(device_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from device_exposure  where device_exposure_start_datetime is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98080' as tbl_id , '9808006' as col_id, 6 as col_seq from device_exposure where device_exposure_end_date is not null )  a  ,(select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from device_exposure where  device_exposure_end_date is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(device_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from device_exposure  where device_exposure_end_date is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98080' as tbl_id , '9808007' as col_id, 7 as col_seq from device_exposure where device_exposure_end_datetime is not null )  a  ,(select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from device_exposure where  device_exposure_end_datetime is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(device_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from device_exposure  where device_exposure_end_datetime is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98080' as tbl_id , '9808008' as col_id, 8 as col_seq from device_exposure where device_type_concept_id is not null )  a  ,(select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from device_exposure where  device_type_concept_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(device_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from device_exposure  where device_type_concept_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98080' as tbl_id , '9808009' as col_id, 9 as col_seq from device_exposure where unique_device_id is not null )  a  ,(select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from device_exposure where  unique_device_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(device_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from device_exposure  where unique_device_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98080' as tbl_id , '9808010' as col_id, 10 as col_seq from device_exposure where production_id is not null )  a  ,(select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from device_exposure where  production_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(device_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from device_exposure  where production_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;*/  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98080' as tbl_id , '9808011' as col_id, 11 as col_seq from device_exposure where quantity is not null )  a  ,(select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from device_exposure where  quantity is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(device_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from device_exposure  where quantity is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98080' as tbl_id , '9808012' as col_id, 12 as col_seq from device_exposure where provider_id is not null )  a  ,(select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from device_exposure where  provider_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(device_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from device_exposure  where provider_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98080' as tbl_id , '9808013' as col_id, 13 as col_seq from device_exposure where visit_occurrence_id is not null )  a  ,(select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from device_exposure where  visit_occurrence_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(device_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from device_exposure  where visit_occurrence_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98080' as tbl_id , '9808014' as col_id, 14 as col_seq from device_exposure where visit_detail_id is not null )  a  ,(select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from device_exposure where  visit_detail_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(device_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from device_exposure  where visit_detail_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98080' as tbl_id , '9808015' as col_id, 15 as col_seq from device_exposure where device_source_value is not null )  a  ,(select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from device_exposure where  device_source_value is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(device_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from device_exposure  where device_source_value is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98080' as tbl_id , '9808016' as col_id, 16 as col_seq from device_exposure where device_source_concept_id is not null )  a  ,(select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from device_exposure where  device_source_concept_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substring(date_format(device_exposure_start_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4) as crit_yr , person_id  from device_exposure  where device_source_concept_id is not null  and device_exposure_start_date between  '20100101' and '20211231' group by substr(date_format(device_exposure_start_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809001' as col_id, 1 as col_seq from measurement where measurement_id is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  measurement_id is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where measurement_id is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809002' as col_id, 2 as col_seq from measurement where person_id is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  person_id is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where person_id is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809003' as col_id, 3 as col_seq from measurement where measurement_concept_id is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  measurement_concept_id is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where measurement_concept_id is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809004' as col_id, 4 as col_seq from measurement where measurement_date is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  measurement_date is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where measurement_date is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809005' as col_id, 5 as col_seq from measurement where measurement_datetime is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  measurement_datetime is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where measurement_datetime is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809006' as col_id, 6 as col_seq from measurement where measurement_time is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  measurement_time is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where measurement_time is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809007' as col_id, 7 as col_seq from measurement where measurement_type_concept_id is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  measurement_type_concept_id is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where measurement_type_concept_id is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809008' as col_id, 8 as col_seq from measurement where operator_concept_id is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  operator_concept_id is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where operator_concept_id is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809009' as col_id, 9 as col_seq from measurement where value_as_number is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  value_as_number is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where value_as_number is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809010' as col_id, 10 as col_seq from measurement where value_as_concept_id is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  value_as_concept_id is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where value_as_concept_id is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809011' as col_id, 11 as col_seq from measurement where unit_concept_id is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  unit_concept_id is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where unit_concept_id is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809012' as col_id, 12 as col_seq from measurement where range_low is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  range_low is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where range_low is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809013' as col_id, 13 as col_seq from measurement where range_high is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  range_high is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where range_high is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809014' as col_id, 14 as col_seq from measurement where provider_id is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  provider_id is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where provider_id is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809015' as col_id, 15 as col_seq from measurement where visit_occurrence_id is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  visit_occurrence_id is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where visit_occurrence_id is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809016' as col_id, 16 as col_seq from measurement where visit_detail_id is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  visit_detail_id is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where visit_detail_id is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809017' as col_id, 17 as col_seq from measurement where measurement_source_value is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  measurement_source_value is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where measurement_source_value is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809018' as col_id, 18 as col_seq from measurement where measurement_source_concept_id is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  measurement_source_concept_id is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where measurement_source_concept_id is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809019' as col_id, 19 as col_seq from measurement where unit_source_value is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  unit_source_value is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where unit_source_value is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98090' as tbl_id , '9809020' as col_id, 20 as col_seq from measurement where value_source_value is not null )  a  ,(select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from measurement where  value_source_value is not null  and measurement_date between  '20100101' and '20211231' group by substring(date_format(measurement_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(measurement_date,'yyyymmdd'),1,4) as crit_yr , person_id  from measurement  where value_source_value is not null  and measurement_date between  '20100101' and '20211231' group by substr(date_format(measurement_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98100' as tbl_id , '9810001' as col_id, 1 as col_seq from observation where observation_id is not null )  a  ,(select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation where  observation_id is not null  and observation_date between  '20100101' and '20211231' group by substring(date_format(observation_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation  where observation_id is not null  and observation_date between  '20100101' and '20211231' group by substr(date_format(observation_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98100' as tbl_id , '9810002' as col_id, 2 as col_seq from observation where person_id is not null )  a  ,(select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation where  person_id is not null  and observation_date between  '20100101' and '20211231' group by substring(date_format(observation_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation  where person_id is not null  and observation_date between  '20100101' and '20211231' group by substr(date_format(observation_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98100' as tbl_id , '9810003' as col_id, 3 as col_seq from observation where observation_concept_id is not null )  a  ,(select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation where  observation_concept_id is not null  and observation_date between  '20100101' and '20211231' group by substring(date_format(observation_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation  where observation_concept_id is not null  and observation_date between  '20100101' and '20211231' group by substr(date_format(observation_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98100' as tbl_id , '9810004' as col_id, 4 as col_seq from observation where observation_date is not null )  a  ,(select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation where  observation_date is not null  and observation_date between  '20100101' and '20211231' group by substring(date_format(observation_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation  where observation_date is not null  and observation_date between  '20100101' and '20211231' group by substr(date_format(observation_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98100' as tbl_id , '9810005' as col_id, 5 as col_seq from observation where observation_datetime is not null )  a  ,(select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation where  observation_datetime is not null  and observation_date between  '20100101' and '20211231' group by substring(date_format(observation_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation  where observation_datetime is not null  and observation_date between  '20100101' and '20211231' group by substr(date_format(observation_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98100' as tbl_id , '9810006' as col_id, 6 as col_seq from observation where observation_type_concept_id is not null )  a  ,(select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation where  observation_type_concept_id is not null  and observation_date between  '20100101' and '20211231' group by substring(date_format(observation_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation  where observation_type_concept_id is not null  and observation_date between  '20100101' and '20211231' group by substr(date_format(observation_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98100' as tbl_id , '9810007' as col_id, 7 as col_seq from observation where value_as_number is not null )  a  ,(select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation where  value_as_number is not null  and observation_date between  '20100101' and '20211231' group by substring(date_format(observation_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation  where value_as_number is not null  and observation_date between  '20100101' and '20211231' group by substr(date_format(observation_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98100' as tbl_id , '9810008' as col_id, 8 as col_seq from observation where value_as_string is not null )  a  ,(select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation where  value_as_string is not null  and observation_date between  '20100101' and '20211231' group by substring(date_format(observation_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation  where value_as_string is not null  and observation_date between  '20100101' and '20211231' group by substr(date_format(observation_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98100' as tbl_id , '9810009' as col_id, 9 as col_seq from observation where value_as_concept_id is not null )  a  ,(select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation where  value_as_concept_id is not null  and observation_date between  '20100101' and '20211231' group by substring(date_format(observation_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation  where value_as_concept_id is not null  and observation_date between  '20100101' and '20211231' group by substr(date_format(observation_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98100' as tbl_id , '9810010' as col_id, 10 as col_seq from observation where qualifier_concept_id is not null )  a  ,(select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation where  qualifier_concept_id is not null  and observation_date between  '20100101' and '20211231' group by substring(date_format(observation_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation  where qualifier_concept_id is not null  and observation_date between  '20100101' and '20211231' group by substr(date_format(observation_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98100' as tbl_id , '9810011' as col_id, 11 as col_seq from observation where unit_concept_id is not null )  a  ,(select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation where  unit_concept_id is not null  and observation_date between  '20100101' and '20211231' group by substring(date_format(observation_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation  where unit_concept_id is not null  and observation_date between  '20100101' and '20211231' group by substr(date_format(observation_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98100' as tbl_id , '9810012' as col_id, 12 as col_seq from observation where provider_id is not null )  a  ,(select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation where  provider_id is not null  and observation_date between  '20100101' and '20211231' group by substring(date_format(observation_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation  where provider_id is not null  and observation_date between  '20100101' and '20211231' group by substr(date_format(observation_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98100' as tbl_id , '9810013' as col_id, 13 as col_seq from observation where visit_occurrence_id is not null )  a  ,(select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation where  visit_occurrence_id is not null  and observation_date between  '20100101' and '20211231' group by substring(date_format(observation_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation  where visit_occurrence_id is not null  and observation_date between  '20100101' and '20211231' group by substr(date_format(observation_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98100' as tbl_id , '9810014' as col_id, 14 as col_seq from observation where visit_detail_id is not null )  a  ,(select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation where  visit_detail_id is not null  and observation_date between  '20100101' and '20211231' group by substring(date_format(observation_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation  where visit_detail_id is not null  and observation_date between  '20100101' and '20211231' group by substr(date_format(observation_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98100' as tbl_id , '9810015' as col_id, 15 as col_seq from observation where observation_source_value is not null )  a  ,(select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation where  observation_source_value is not null  and observation_date between  '20100101' and '20211231' group by substring(date_format(observation_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation  where observation_source_value is not null  and observation_date between  '20100101' and '20211231' group by substr(date_format(observation_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98100' as tbl_id , '9810016' as col_id, 16 as col_seq from observation where observation_source_concept_id is not null )  a  ,(select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation where  observation_source_concept_id is not null  and observation_date between  '20100101' and '20211231' group by substring(date_format(observation_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation  where observation_source_concept_id is not null  and observation_date between  '20100101' and '20211231' group by substr(date_format(observation_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98100' as tbl_id , '9810017' as col_id, 17 as col_seq from observation where unit_source_value is not null )  a  ,(select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation where  unit_source_value is not null  and observation_date between  '20100101' and '20211231' group by substring(date_format(observation_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation  where unit_source_value is not null  and observation_date between  '20100101' and '20211231' group by substr(date_format(observation_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98100' as tbl_id , '9810018' as col_id, 18 as col_seq from observation where qualifier_source_value is not null )  a  ,(select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from observation where  qualifier_source_value is not null  and observation_date between  '20100101' and '20211231' group by substring(date_format(observation_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(observation_date,'yyyymmdd'),1,4) as crit_yr , person_id  from observation  where qualifier_source_value is not null  and observation_date between  '20100101' and '20211231' group by substr(date_format(observation_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where x1113b.crit_yr = c.crit_yr order by b.crit_yr asc ;*/  
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98110' as tbl_id , '9811001' as col_id, 1 as col_seq from death where person_id is not null )  a  ,(select substr(date_format(death_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from death where  person_id is not null  and death_date between  '20100101' and '20211231' group by substring(date_format(death_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(death_date,'yyyymmdd'),1,4) as crit_yr , person_id  from death  where person_id is not null  and death_date between  '20100101' and '20211231' group by substr(date_format(death_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  */
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98110' as tbl_id , '9811002' as col_id, 2 as col_seq from death where death_date is not null )  a  ,(select substr(date_format(death_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from death where  death_date is not null  and death_date between  '20100101' and '20211231' group by substring(date_format(death_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(death_date,'yyyymmdd'),1,4) as crit_yr , person_id  from death  where death_date is not null  and death_date between  '20100101' and '20211231' group by substr(date_format(death_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98110' as tbl_id , '9811003' as col_id, 3 as col_seq from death where death_datetime is not null )  a  ,(select substr(date_format(death_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from death where  death_datetime is not null  and death_date between  '20100101' and '20211231' group by substring(date_format(death_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(death_date,'yyyymmdd'),1,4) as crit_yr , person_id  from death  where death_datetime is not null  and death_date between  '20100101' and '20211231' group by substr(date_format(death_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98110' as tbl_id , '9811004' as col_id, 4 as col_seq from death where death_type_concept_id is not null )  a  ,(select substr(date_format(death_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from death where  death_type_concept_id is not null  and death_date between  '20100101' and '20211231' group by substring(date_format(death_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(death_date,'yyyymmdd'),1,4) as crit_yr , person_id  from death  where death_type_concept_id is not null  and death_date between  '20100101' and '20211231' group by substr(date_format(death_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98110' as tbl_id , '9811005' as col_id, 5 as col_seq from death where cause_concept_id is not null )  a  ,(select substr(date_format(death_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from death where  cause_concept_id is not null  and death_date between  '20100101' and '20211231' group by substring(date_format(death_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(death_date,'yyyymmdd'),1,4) as crit_yr , person_id  from death  where cause_concept_id is not null  and death_date between  '20100101' and '20211231' group by substr(date_format(death_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98110' as tbl_id , '9811006' as col_id, 6 as col_seq from death where cause_source_value is not null )  a  ,(select substr(date_format(death_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from death where  cause_source_value is not null  and death_date between  '20100101' and '20211231' group by substring(date_format(death_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(death_date,'yyyymmdd'),1,4) as crit_yr , person_id  from death  where cause_source_value is not null  and death_date between  '20100101' and '20211231' group by substr(date_format(death_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98110' as tbl_id , '9811007' as col_id, 7 as col_seq from death where cause_source_concept_id is not null )  a  ,(select substr(date_format(death_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from death where  cause_source_concept_id is not null  and death_date between  '20100101' and '20211231' group by substring(date_format(death_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(death_date,'yyyymmdd'),1,4) as crit_yr , person_id  from death  where cause_source_concept_id is not null  and death_date between  '20100101' and '20211231' group by substr(date_format(death_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98120' as tbl_id , '9812001' as col_id, 1 as col_seq from note where note_id is not null )  a  ,(select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note where  note_id is not null  and note_date between  '20100101' and '20211231' group by substring(date_format(note_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr , person_id  from note  where note_id is not null  and note_date between  '20100101' and '20211231' group by substr(date_format(note_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98120' as tbl_id , '9812002' as col_id, 2 as col_seq from note where person_id is not null )  a  ,(select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note where  person_id is not null  and note_date between  '20100101' and '20211231' group by substring(date_format(note_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr , person_id  from note  where person_id is not null  and note_date between  '20100101' and '20211231' group by substr(date_format(note_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98120' as tbl_id , '9812003' as col_id, 3 as col_seq from note where note_date is not null )  a  ,(select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note where  note_date is not null  and note_date between  '20100101' and '20211231' group by substring(date_format(note_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr , person_id  from note  where note_date is not null  and note_date between  '20100101' and '20211231' group by substr(date_format(note_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98120' as tbl_id , '9812004' as col_id, 4 as col_seq from note where note_datetime is not null )  a  ,(select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note where  note_datetime is not null  and note_date between  '20100101' and '20211231' group by substring(date_format(note_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr , person_id  from note  where note_datetime is not null  and note_date between  '20100101' and '20211231' group by substr(date_format(note_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98120' as tbl_id , '9812005' as col_id, 5 as col_seq from note where note_type_concept_id is not null )  a  ,(select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note where  note_type_concept_id is not null  and note_date between  '20100101' and '20211231' group by substring(date_format(note_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr , person_id  from note  where note_type_concept_id is not null  and note_date between  '20100101' and '20211231' group by substr(date_format(note_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98120' as tbl_id , '9812006' as col_id, 6 as col_seq from note where note_class_concept_id is not null )  a  ,(select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note where  note_class_concept_id is not null  and note_date between  '20100101' and '20211231' group by substring(date_format(note_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr , person_id  from note  where note_class_concept_id is not null  and note_date between  '20100101' and '20211231' group by substr(date_format(note_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98120' as tbl_id , '9812007' as col_id, 7 as col_seq from note where note_title is not null )  a  ,(select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note where  note_title is not null  and note_date between  '20100101' and '20211231' group by substring(date_format(note_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr , person_id  from note  where note_title is not null  and note_date between  '20100101' and '20211231' group by substr(date_format(note_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98120' as tbl_id , '9812008' as col_id, 8 as col_seq from note where note_text is not null )  a  ,(select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note where  note_text is not null  and note_date between  '20100101' and '20211231' group by substring(date_format(note_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr , person_id  from note  where note_text is not null  and note_date between  '20100101' and '20211231' group by substr(date_format(note_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98120' as tbl_id , '9812009' as col_id, 9 as col_seq from note where encoding_concept_id is not null )  a  ,(select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note where  encoding_concept_id is not null  and note_date between  '20100101' and '20211231' group by substring(date_format(note_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr , person_id  from note  where encoding_concept_id is not null  and note_date between  '20100101' and '20211231' group by substr(date_format(note_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98120' as tbl_id , '9812010' as col_id, 10 as col_seq from note where language_concept_id is not null )  a  ,(select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note where  language_concept_id is not null  and note_date between  '20100101' and '20211231' group by substring(date_format(note_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr , person_id  from note  where language_concept_id is not null  and note_date between  '20100101' and '20211231' group by substr(date_format(note_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98120' as tbl_id , '9812011' as col_id, 11 as col_seq from note where provider_id is not null )  a  ,(select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note where  provider_id is not null  and note_date between  '20100101' and '20211231' group by substring(date_format(note_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr , person_id  from note  where provider_id is not null  and note_date between  '20100101' and '20211231' group by substr(date_format(note_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98120' as tbl_id , '9812012' as col_id, 12 as col_seq from note where visit_occurrence_id is not null )  a  ,(select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note where  visit_occurrence_id is not null  and note_date between  '20100101' and '20211231' group by substring(date_format(note_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr , person_id  from note  where visit_occurrence_id is not null  and note_date between  '20100101' and '20211231' group by substr(date_format(note_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98120' as tbl_id , '9812013' as col_id, 13 as col_seq from note where visit_detail_id is not null )  a  ,(select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note where  visit_detail_id is not null  and note_date between  '20100101' and '20211231' group by substring(date_format(note_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr , person_id  from note  where visit_detail_id is not null  and note_date between  '20100101' and '20211231' group by substr(date_format(note_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98120' as tbl_id , '9812014' as col_id, 14 as col_seq from note where note_source_value is not null )  a  ,(select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note where  note_source_value is not null  and note_date between  '20100101' and '20211231' group by substring(date_format(note_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(note_date,'yyyymmdd'),1,4) as crit_yr , person_id  from note  where note_source_value is not null  and note_date between  '20100101' and '20211231' group by substr(date_format(note_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98140' as tbl_id , '9814001' as col_id, 1 as col_seq from specimen where specimen_id is not null )  a  ,(select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from specimen where  specimen_id is not null  and specimen_date between  '20100101' and '20211231' group by substring(date_format(specimen_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr , person_id  from specimen  where specimen_id is not null  and specimen_date between  '20100101' and '20211231' group by substr(date_format(specimen_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98140' as tbl_id , '9814002' as col_id, 2 as col_seq from specimen where person_id is not null )  a  ,(select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from specimen where  person_id is not null  and specimen_date between  '20100101' and '20211231' group by substring(date_format(specimen_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr , person_id  from specimen  where person_id is not null  and specimen_date between  '20100101' and '20211231' group by substr(date_format(specimen_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98140' as tbl_id , '9814003' as col_id, 3 as col_seq from specimen where specimen_concept_id is not null )  a  ,(select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from specimen where  specimen_concept_id is not null  and specimen_date between  '20100101' and '20211231' group by substring(date_format(specimen_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr , person_id  from specimen  where specimen_concept_id is not null  and specimen_date between  '20100101' and '20211231' group by substr(date_format(specimen_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98140' as tbl_id , '9814004' as col_id, 4 as col_seq from specimen where specimen_type_concept_id is not null )  a  ,(select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from specimen where  specimen_type_concept_id is not null  and specimen_date between  '20100101' and '20211231' group by substring(date_format(specimen_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr , person_id  from specimen  where specimen_type_concept_id is not null  and specimen_date between  '20100101' and '20211231' group by substr(date_format(specimen_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98140' as tbl_id , '9814005' as col_id, 5 as col_seq from specimen where specimen_date is not null )  a  ,(select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from specimen where  specimen_date is not null  and specimen_date between  '20100101' and '20211231' group by substring(date_format(specimen_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr , person_id  from specimen  where specimen_date is not null  and specimen_date between  '20100101' and '20211231' group by substr(date_format(specimen_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98140' as tbl_id , '9814006' as col_id, 6 as col_seq from specimen where specimen_datetime is not null )  a  ,(select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from specimen where  specimen_datetime is not null  and specimen_date between  '20100101' and '20211231' group by substring(date_format(specimen_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr , person_id  from specimen  where specimen_datetime is not null  and specimen_date between  '20100101' and '20211231' group by substr(date_format(specimen_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98140' as tbl_id , '9814007' as col_id, 7 as col_seq from specimen where quantity is not null )  a  ,(select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from specimen where  quantity is not null  and specimen_date between  '20100101' and '20211231' group by substring(date_format(specimen_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr , person_id  from specimen  where quantity is not null  and specimen_date between  '20100101' and '20211231' group by substr(date_format(specimen_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98140' as tbl_id , '9814008' as col_id, 8 as col_seq from specimen where unit_concept_id is not null )  a  ,(select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from specimen where  unit_concept_id is not null  and specimen_date between  '20100101' and '20211231' group by substring(date_format(specimen_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr , person_id  from specimen  where unit_concept_id is not null  and specimen_date between  '20100101' and '20211231' group by substr(date_format(specimen_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98140' as tbl_id , '9814009' as col_id, 9 as col_seq from specimen where anatomic_site_concept_id is not null )  a  ,(select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from specimen where  anatomic_site_concept_id is not null  and specimen_date between  '20100101' and '20211231' group by substring(date_format(specimen_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr , person_id  from specimen  where anatomic_site_concept_id is not null  and specimen_date between  '20100101' and '20211231' group by substr(date_format(specimen_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98140' as tbl_id , '9814010' as col_id, 10 as col_seq from specimen where disease_status_concept_id is not null )  a  ,(select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from specimen where  disease_status_concept_id is not null  and specimen_date between  '20100101' and '20211231' group by substring(date_format(specimen_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr , person_id  from specimen  where disease_status_concept_id is not null  and specimen_date between  '20100101' and '20211231' group by substr(date_format(specimen_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98140' as tbl_id , '9814011' as col_id, 11 as col_seq from specimen where specimen_source_id is not null )  a  ,(select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from specimen where  specimen_source_id is not null  and specimen_date between  '20100101' and '20211231' group by substring(date_format(specimen_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr , person_id  from specimen  where specimen_source_id is not null  and specimen_date between  '20100101' and '20211231' group by substr(date_format(specimen_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98140' as tbl_id , '9814012' as col_id, 12 as col_seq from specimen where specimen_source_value is not null )  a  ,(select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from specimen where  specimen_source_value is not null  and specimen_date between  '20100101' and '20211231' group by substring(date_format(specimen_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr , person_id  from specimen  where specimen_source_value is not null  and specimen_date between  '20100101' and '20211231' group by substr(date_format(specimen_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98140' as tbl_id , '9814013' as col_id, 13 as col_seq from specimen where unit_source_value is not null )  a  ,(select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from specimen where  unit_source_value is not null  and specimen_date between  '20100101' and '20211231' group by substring(date_format(specimen_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr , person_id  from specimen  where unit_source_value is not null  and specimen_date between  '20100101' and '20211231' group by substr(date_format(specimen_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98140' as tbl_id , '9814014' as col_id, 14 as col_seq from specimen where anatomic_site_source_value is not null )  a  ,(select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from specimen where  anatomic_site_source_value is not null  and specimen_date between  '20100101' and '20211231' group by substring(date_format(specimen_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr , person_id  from specimen  where anatomic_site_source_value is not null  and specimen_date between  '20100101' and '20211231' group by substr(date_format(specimen_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, c.pt_cnt, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98140' as tbl_id , '9814015' as col_id, 15 as col_seq from specimen where disease_status_source_value is not null )  a  ,(select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from specimen where  disease_status_source_value is not null  and specimen_date between  '20100101' and '20211231' group by substring(date_format(specimen_date,'yyyymmdd'),1,4)) b  ,(select  a.crit_yr, count(*) as pt_cnt from (select substr(date_format(specimen_date,'yyyymmdd'),1,4) as crit_yr , person_id  from specimen  where disease_status_source_value is not null  and specimen_date between  '20100101' and '20211231' group by substr(date_format(specimen_date,'yyyymmdd'),1,4), person_id) a  group by a.crit_yr) c where b.crit_yr = c.crit_yr order by b.crit_yr asc ;  
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, null, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98130' as tbl_id , '9813001' as col_id, 1 as col_seq from note_nlp where note_nlp_id is not null )  a  ,(select substr(date_format(nlp_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note_nlp where  note_nlp_id is not null  and nlp_date between  '20100101' and '20211231' group by substr(date_format(nlp_date,'yyyymmdd'),1,4)) b  ;   
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, null, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98130' as tbl_id , '9813002' as col_id, 2 as col_seq from note_nlp where note_id is not null )  a  ,(select substr(date_format(nlp_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note_nlp where  note_id is not null  and nlp_date between  '20100101' and '20211231' group by substr(date_format(nlp_date,'yyyymmdd'),1,4)) b  ;   
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, null, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98130' as tbl_id , '9813003' as col_id, 3 as col_seq from note_nlp where section_concept_id is not null )  a  ,(select substr(date_format(nlp_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note_nlp where  section_concept_id is not null  and nlp_date between  '20100101' and '20211231' group by substr(date_format(nlp_date,'yyyymmdd'),1,4)) b  ;   
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, null, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98130' as tbl_id , '9813004' as col_id, 4 as col_seq from note_nlp where snippet is not null )  a  ,(select substr(date_format(nlp_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note_nlp where  snippet is not null  and nlp_date between  '20100101' and '20211231' group by substr(date_format(nlp_date,'yyyymmdd'),1,4)) b  ;   
/*insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, null, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98130' as tbl_id , '9813005' as col_id, 5 as col_seq from note_nlp where offset is not null )  a  ,(select substr(date_format(nlp_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note_nlp where  offset is not null  and nlp_date between  '20100101' and '20211231' group by substr(date_format(nlp_date,'yyyymmdd'),1,4)) b  ;*/   
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, null, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98130' as tbl_id , '9813006' as col_id, 6 as col_seq from note_nlp where lexical_variant is not null )  a  ,(select substr(date_format(nlp_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note_nlp where  lexical_variant is not null  and nlp_date between  '20100101' and '20211231' group by substr(date_format(nlp_date,'yyyymmdd'),1,4)) b  ;   
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, null, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98130' as tbl_id , '9813007' as col_id, 7 as col_seq from note_nlp where note_nlp_concept_id is not null )  a  ,(select substr(date_format(nlp_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note_nlp where  note_nlp_concept_id is not null  and nlp_date between  '20100101' and '20211231' group by substr(date_format(nlp_date,'yyyymmdd'),1,4)) b  ;   
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, null, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98130' as tbl_id , '9813008' as col_id, 8 as col_seq from note_nlp where note_nlp_source_concept_id is not null )  a  ,(select substr(date_format(nlp_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note_nlp where  note_nlp_source_concept_id is not null  and nlp_date between  '20100101' and '20211231' group by substr(date_format(nlp_date,'yyyymmdd'),1,4)) b  ;   
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, null, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98130' as tbl_id , '9813009' as col_id, 9 as col_seq from note_nlp where nlp_system is not null )  a  ,(select substr(date_format(nlp_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note_nlp where  nlp_system is not null  and nlp_date between  '20100101' and '20211231' group by substr(date_format(nlp_date,'yyyymmdd'),1,4)) b  ;   
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, null, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98130' as tbl_id , '9813010' as col_id, 10 as col_seq from note_nlp where nlp_date is not null )  a  ,(select substr(date_format(nlp_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note_nlp where  nlp_date is not null  and nlp_date between  '20100101' and '20211231' group by substr(date_format(nlp_date,'yyyymmdd'),1,4)) b  ;   
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, null, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98130' as tbl_id , '9813011' as col_id, 11 as col_seq from note_nlp where nlp_datetime is not null )  a  ,(select substr(date_format(nlp_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note_nlp where  nlp_datetime is not null  and nlp_date between  '20100101' and '20211231' group by substr(date_format(nlp_date,'yyyymmdd'),1,4)) b  ;   
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, null, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98130' as tbl_id , '9813012' as col_id, 12 as col_seq from note_nlp where term_exists is not null )  a  ,(select substr(date_format(nlp_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note_nlp where  term_exists is not null  and nlp_date between  '20100101' and '20211231' group by substr(date_format(nlp_date,'yyyymmdd'),1,4)) b  ;   
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, null, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98130' as tbl_id , '9813013' as col_id, 13 as col_seq from note_nlp where term_temporal is not null )  a  ,(select substr(date_format(nlp_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note_nlp where  term_temporal is not null  and nlp_date between  '20100101' and '20211231' group by substr(date_format(nlp_date,'yyyymmdd'),1,4)) b  ;   
insert into cncr_tbl_col_yr_stats (hosp_cd,tbl_id,col_id,col_seq,crit_yr,row_cnt,pt_cnt,stats_work_ymd,coll_strt_ymd,coll_end_ymd,crtn_dt )  select  distinct  a.hosp_cd, a.tbl_id, a.col_id, a.col_seq, b.crit_yr, b.row_cnt, null, date_format(current_timestamp,'yyyymmdd') as stats_work_ymd  ,'20100101' as coll_strt_ymd,'20211231'  as coll_end_ymd,current_timestamp as crtn_dt  from (select '9999' as hosp_cd, '98130' as tbl_id , '9813014' as col_id, 14 as col_seq from note_nlp where term_modifiers is not null )  a  ,(select substr(date_format(nlp_date,'yyyymmdd'),1,4) as crit_yr, count(*) as row_cnt from note_nlp where  term_modifiers is not null  and nlp_date between  '20100101' and '20211231' group by substr(date_format(nlp_date,'yyyymmdd'),1,4)) b  ;   
