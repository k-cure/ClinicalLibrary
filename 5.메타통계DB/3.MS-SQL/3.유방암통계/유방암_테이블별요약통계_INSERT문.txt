
-- 11001 // 유방암 환자수 
	WITH W1 AS( SELECT 11001 AS SMRY_STATS_NO, HCODE, PTNO, SUBSTRING(FDX,1,4) AS CRIT_YR, AGE AS PT_AGE , SEX AS PT_SEX_CD, POPCODE FROM CNCR_RGST WHERE FDX BETWEEN '20100101' AND '20211231' AND POPCODE IS NOT NULL AND POPCODE = 05)	INSERT INTO CNCR_TBL_SMRY_STATS
SELECT 11001 AS SMRY_STATS_NO, A.HCODE AS HOSP_CD, A.CRIT_YR, '유방암 환자수' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD, A.POPCODE AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT, '20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT
	FROM (SELECT HCODE, CRIT_YR,PT_AGE,PT_SEX_CD,POPCODE,COUNT(POPCODE) AS NCS, COUNT(DISTINCT PTNO) AS PT_CNT FROM W1 GROUP BY HCODE, CRIT_YR,PT_AGE,PT_SEX_CD, POPCODE) AS A INNER JOIN ( SELECT HCODE,CRIT_YR,PT_AGE,PT_SEX_CD, COUNT(POPCODE)	 AS WHOL_NCS, COUNT(DISTINCT PTNO) AS WHOL_PT_CNT FROM W1 GROUP BY HCODE, CRIT_YR,PT_AGE,PT_SEX_CD) AS B 
ON A.HCODE = B.HCODE AND A.CRIT_YR = B.CRIT_YR AND A.PT_AGE=B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD 	INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON
ENG_TBL_NM = 'CNCR_RGST' AND ENG_COL_NM = 'POPCODE' ;			

-- 11002 // 유방암 음주여부별 
	WITH W1 AS (SELECT 	11002 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CUR_DRNK_YN_NOANS_SPCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.CUR_DRNK_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11002 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 음주여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.CUR_DRNK_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CUR_DRNK_YN_NOANS_SPCD,
COUNT(CUR_DRNK_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CUR_DRNK_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CUR_DRNK_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'CUR_DRNK_YN_NOANS_SPCD';

-- 11003 // 유방암 음주력여부별 
	WITH W1 AS (SELECT 	11003 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DHIS_YN_NOANS_SPCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.DHIS_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11003 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 음주력여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DHIS_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DHIS_YN_NOANS_SPCD,
COUNT(DHIS_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DHIS_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DHIS_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'DHIS_YN_NOANS_SPCD';

-- 11004 // 유방암 음주시작연령별 
	WITH W1 AS (SELECT 	11004 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRNK_STRT_AGE_VL FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.DRNK_STRT_AGE_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11004 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 음주시작연령별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRNK_STRT_AGE_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRNK_STRT_AGE_VL,
COUNT(DRNK_STRT_AGE_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRNK_STRT_AGE_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRNK_STRT_AGE_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'DRNK_STRT_AGE_VL';

-- 11005 // 유방암 음주종류별 
	WITH W1 AS (SELECT 	11005 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRNK_KNCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.DRNK_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11005 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 음주종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRNK_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRNK_KNCD,
COUNT(DRNK_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRNK_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRNK_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'DRNK_KNCD';

-- 11006 // 유방암 음주량별 
	WITH W1 AS (SELECT 	11006 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRNK_QTY FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.DRNK_QTY IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11006 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 음주량별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRNK_QTY AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRNK_QTY,
COUNT(DRNK_QTY) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRNK_QTY) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRNK_QTY) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'DRNK_QTY';

-- 11007 // 유방암 음주횟수별 
	WITH W1 AS (SELECT 	11007 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRNK_NT FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.DRNK_NT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11007 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 음주횟수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRNK_NT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRNK_NT,
COUNT(DRNK_NT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRNK_NT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRNK_NT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'DRNK_NT';

-- 11008 // 유방암 음주기간년수별 
	WITH W1 AS (SELECT 	11008 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRNK_DTRN_YCNT FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.DRNK_DTRN_YCNT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11008 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 음주기간년수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRNK_DTRN_YCNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRNK_DTRN_YCNT,
COUNT(DRNK_DTRN_YCNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRNK_DTRN_YCNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRNK_DTRN_YCNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'DRNK_DTRN_YCNT';

-- 11009 // 유방암 금주시작년도별 
	WITH W1 AS (SELECT 	11009 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.NDRK_STRT_YR FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.NDRK_STRT_YR IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11009 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 금주시작년도별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.NDRK_STRT_YR AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, NDRK_STRT_YR,
COUNT(NDRK_STRT_YR) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, NDRK_STRT_YR) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(NDRK_STRT_YR) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'NDRK_STRT_YR';

-- 11010 // 유방암 흡연여부별 
	WITH W1 AS (SELECT 	11010 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CUR_SMOK_YN_NOANS_SPCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.CUR_SMOK_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11010 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 흡연여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.CUR_SMOK_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CUR_SMOK_YN_NOANS_SPCD,
COUNT(CUR_SMOK_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CUR_SMOK_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CUR_SMOK_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'CUR_SMOK_YN_NOANS_SPCD';

-- 11011 // 유방암 흡연력여부별 
	WITH W1 AS (SELECT 	11011 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.SHIS_YN_NOANS_SPCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.SHIS_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11011 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 흡연력여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.SHIS_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, SHIS_YN_NOANS_SPCD,
COUNT(SHIS_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, SHIS_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(SHIS_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'SHIS_YN_NOANS_SPCD';

-- 11012 // 유방암 흡연시작연령별 
	WITH W1 AS (SELECT 	11012 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.SMOK_STRT_AGE_VL FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.SMOK_STRT_AGE_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11012 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 흡연시작연령별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.SMOK_STRT_AGE_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, SMOK_STRT_AGE_VL,
COUNT(SMOK_STRT_AGE_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, SMOK_STRT_AGE_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(SMOK_STRT_AGE_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'SMOK_STRT_AGE_VL';

-- 11013 // 유방암 흡연량별 
	WITH W1 AS (SELECT 	11013 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.SMOK_QTY FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.SMOK_QTY IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11013 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 흡연량별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.SMOK_QTY AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, SMOK_QTY,
COUNT(SMOK_QTY) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, SMOK_QTY) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(SMOK_QTY) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'SMOK_QTY';

-- 11014 // 유방암 흡연기간년수별 
	WITH W1 AS (SELECT 	11014 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.SMOK_DTRN_YCNT FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.SMOK_DTRN_YCNT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11014 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 흡연기간년수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.SMOK_DTRN_YCNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, SMOK_DTRN_YCNT,
COUNT(SMOK_DTRN_YCNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, SMOK_DTRN_YCNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(SMOK_DTRN_YCNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'SMOK_DTRN_YCNT';

-- 11015 // 유방암 금연시작년도별 
	WITH W1 AS (SELECT 	11015 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.NSMK_STRT_YR FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.NSMK_STRT_YR IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11015 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 금연시작년도별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.NSMK_STRT_YR AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, NSMK_STRT_YR,
COUNT(NSMK_STRT_YR) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, NSMK_STRT_YR) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(NSMK_STRT_YR) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'NSMK_STRT_YR';

-- 11016 // 유방암 병력여부별 
	WITH W1 AS (SELECT 	11016 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_YN_NOANS_SPCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.MHIS_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11016 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 병력여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MHIS_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_YN_NOANS_SPCD,
COUNT(MHIS_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_YN_NOANS_SPCD';

-- 11017 // 유방암 병력고혈압여부별 
	WITH W1 AS (SELECT 	11017 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_HTN_YN_NOANS_SPCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.MHIS_HTN_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11017 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 병력고혈압여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MHIS_HTN_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_HTN_YN_NOANS_SPCD,
COUNT(MHIS_HTN_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_HTN_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_HTN_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_HTN_YN_NOANS_SPCD';

-- 11018 // 유방암 병력당뇨여부별 
	WITH W1 AS (SELECT 	11018 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_DBT_YN_NOANS_SPCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.MHIS_DBT_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11018 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 병력당뇨여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MHIS_DBT_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_DBT_YN_NOANS_SPCD,
COUNT(MHIS_DBT_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_DBT_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_DBT_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_DBT_YN_NOANS_SPCD';

-- 11019 // 유방암 병력결핵여부별 
	WITH W1 AS (SELECT 	11019 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_TB_YN_NOANS_SPCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.MHIS_TB_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11019 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 병력결핵여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MHIS_TB_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_TB_YN_NOANS_SPCD,
COUNT(MHIS_TB_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_TB_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_TB_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_TB_YN_NOANS_SPCD';

-- 11020 // 유방암 병력간질환여부별 
	WITH W1 AS (SELECT 	11020 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_LVDS_YN_NOANS_SPCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.MHIS_LVDS_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11020 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 병력간질환여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MHIS_LVDS_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_LVDS_YN_NOANS_SPCD,
COUNT(MHIS_LVDS_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_LVDS_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_LVDS_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_LVDS_YN_NOANS_SPCD';

-- 11021 // 유방암 병력고지혈증여부별 
	WITH W1 AS (SELECT 	11021 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_HL_YN_NOANS_SPCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.MHIS_HL_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11021 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 병력고지혈증여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MHIS_HL_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_HL_YN_NOANS_SPCD,
COUNT(MHIS_HL_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_HL_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_HL_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_HL_YN_NOANS_SPCD';

-- 11022 // 유방암 병력암여부별 
	WITH W1 AS (SELECT 	11022 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_CNCR_YN_NOANS_SPCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.MHIS_CNCR_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11022 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 병력암여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MHIS_CNCR_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_CNCR_YN_NOANS_SPCD,
COUNT(MHIS_CNCR_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_CNCR_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_CNCR_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_CNCR_YN_NOANS_SPCD';

-- 11023 // 유방암 병력암종류별 
	WITH W1 AS (SELECT 	11023 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_CNCR_KNCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.MHIS_CNCR_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11023 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 병력암종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MHIS_CNCR_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_CNCR_KNCD,
COUNT(MHIS_CNCR_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_CNCR_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_CNCR_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_CNCR_KNCD';

-- 11024 // 유방암 병력우울증여부별 
	WITH W1 AS (SELECT 	11024 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_DEPR_YN_NOANS_SPCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.MHIS_DEPR_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11024 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 병력우울증여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MHIS_DEPR_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_DEPR_YN_NOANS_SPCD,
COUNT(MHIS_DEPR_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_DEPR_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_DEPR_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_DEPR_YN_NOANS_SPCD';

-- 11025 // 유방암 병력불면증여부별 
	WITH W1 AS (SELECT 	11025 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_INSM_YN_NOANS_SPCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.MHIS_INSM_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11025 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 병력불면증여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MHIS_INSM_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_INSM_YN_NOANS_SPCD,
COUNT(MHIS_INSM_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_INSM_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_INSM_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_INSM_YN_NOANS_SPCD';

-- 11026 // 유방암 병력심장질환여부별 
	WITH W1 AS (SELECT 	11026 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MHIS_CADS_YN_NOANS_SPCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.MHIS_CADS_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11026 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 병력심장질환여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MHIS_CADS_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MHIS_CADS_YN_NOANS_SPCD,
COUNT(MHIS_CADS_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MHIS_CADS_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MHIS_CADS_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'MHIS_CADS_YN_NOANS_SPCD';

-- 11027 // 유방암 기타병력여부별 
	WITH W1 AS (SELECT 	11027 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ETC_MHIS_YN_NOANS_SPCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.ETC_MHIS_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11027 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 기타병력여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.ETC_MHIS_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ETC_MHIS_YN_NOANS_SPCD,
COUNT(ETC_MHIS_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ETC_MHIS_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ETC_MHIS_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'ETC_MHIS_YN_NOANS_SPCD';

-- 11028 // 유방암 기타병력질환내용별 
	WITH W1 AS (SELECT 	11028 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, SUBSTRING(A.ETC_MHIS_DISS_CONT,1,100) AS ETC_MHIS_DISS_CONT FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.ETC_MHIS_DISS_CONT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11028 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 기타병력질환내용별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.ETC_MHIS_DISS_CONT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ETC_MHIS_DISS_CONT,
COUNT(ETC_MHIS_DISS_CONT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ETC_MHIS_DISS_CONT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ETC_MHIS_DISS_CONT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'ETC_MHIS_DISS_CONT';

-- 11029 // 유방암 주증상여부별 
	WITH W1 AS (SELECT 	11029 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MAIN_SYM_YN_NOANS_SPCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.MAIN_SYM_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11029 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 주증상여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MAIN_SYM_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MAIN_SYM_YN_NOANS_SPCD,
COUNT(MAIN_SYM_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MAIN_SYM_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MAIN_SYM_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'MAIN_SYM_YN_NOANS_SPCD';

-- 11030 // 유방암 주증상내용별 
	WITH W1 AS (SELECT 	11030 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, SUBSTRING(A.MAIN_SYM_CONT,1,100) AS MAIN_SYM_CONT FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.MAIN_SYM_CONT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11030 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 주증상내용별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MAIN_SYM_CONT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MAIN_SYM_CONT,
COUNT(MAIN_SYM_CONT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MAIN_SYM_CONT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MAIN_SYM_CONT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'MAIN_SYM_CONT';

-- 11031 // 유방암 타병원진단후전원여부별 
	WITH W1 AS (SELECT 	11031 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OHAD_HSTR_YN_NOANS_SPCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.OHAD_HSTR_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11031 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 타병원진단후전원여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.OHAD_HSTR_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OHAD_HSTR_YN_NOANS_SPCD,
COUNT(OHAD_HSTR_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OHAD_HSTR_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OHAD_HSTR_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'OHAD_HSTR_YN_NOANS_SPCD';

-- 11032 // 유방암 퇴원상태별 
	WITH W1 AS (SELECT 	11032 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ADM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DSCH_STCD FROM BRCN_PT_HLINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ADM_YMD BETWEEN '20100101' AND '20211231' AND A.DSCH_STCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11032 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 퇴원상태별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DSCH_STCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DSCH_STCD,
COUNT(DSCH_STCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DSCH_STCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DSCH_STCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_HLINF' AND ENG_COL_NM = 'DSCH_STCD';

-- 11033 // 유방암 가족력여부별 
	WITH W1 AS (SELECT 	11033 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.FMHT_YN_NOANS_SPCD FROM BRCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.FMHT_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11033 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 가족력여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.FMHT_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHT_YN_NOANS_SPCD,
COUNT(FMHT_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHT_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHT_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_FMHT' AND ENG_COL_NM = 'FMHT_YN_NOANS_SPCD';

-- 11034 // 유방암 환자가족관계별 
	WITH W1 AS (SELECT 	11034 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.PT_FM_RLCD FROM BRCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.PT_FM_RLCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11034 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 환자가족관계별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.PT_FM_RLCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, PT_FM_RLCD,
COUNT(PT_FM_RLCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, PT_FM_RLCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(PT_FM_RLCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_FMHT' AND ENG_COL_NM = 'PT_FM_RLCD';

-- 11035 // 유방암 환자가족관계기타내용별 
	WITH W1 AS (SELECT 	11035 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, SUBSTRING(A.PT_FMRL_ETC_CONT,1,100) AS PT_FMRL_ETC_CONT FROM BRCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.PT_FMRL_ETC_CONT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11035 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 환자가족관계기타내용별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.PT_FMRL_ETC_CONT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, PT_FMRL_ETC_CONT,
COUNT(PT_FMRL_ETC_CONT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, PT_FMRL_ETC_CONT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(PT_FMRL_ETC_CONT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_FMHT' AND ENG_COL_NM = 'PT_FMRL_ETC_CONT';

-- 11036 // 유방암 가족병력고혈압여부별 
	WITH W1 AS (SELECT 	11036 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.FMHS_HTN_YN_NOANS_SPCD FROM BRCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.FMHS_HTN_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11036 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 가족병력고혈압여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.FMHS_HTN_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHS_HTN_YN_NOANS_SPCD,
COUNT(FMHS_HTN_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHS_HTN_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHS_HTN_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_FMHT' AND ENG_COL_NM = 'FMHS_HTN_YN_NOANS_SPCD';

-- 11037 // 유방암 가족병력당뇨여부별 
	WITH W1 AS (SELECT 	11037 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.FMHS_DBT_YN_NOANS_SPCD FROM BRCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.FMHS_DBT_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11037 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 가족병력당뇨여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.FMHS_DBT_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHS_DBT_YN_NOANS_SPCD,
COUNT(FMHS_DBT_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHS_DBT_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHS_DBT_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_FMHT' AND ENG_COL_NM = 'FMHS_DBT_YN_NOANS_SPCD';

-- 11038 // 유방암 가족력결핵여부별 
	WITH W1 AS (SELECT 	11038 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.FMHT_TB_YN_NOANS_SPCD FROM BRCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.FMHT_TB_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11038 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 가족력결핵여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.FMHT_TB_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHT_TB_YN_NOANS_SPCD,
COUNT(FMHT_TB_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHT_TB_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHT_TB_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_FMHT' AND ENG_COL_NM = 'FMHT_TB_YN_NOANS_SPCD';

-- 11039 // 유방암 가족병력간질환여부별 
	WITH W1 AS (SELECT 	11039 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.FMHS_LVDS_YN_NOANS_SPCD FROM BRCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.FMHS_LVDS_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11039 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 가족병력간질환여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.FMHS_LVDS_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHS_LVDS_YN_NOANS_SPCD,
COUNT(FMHS_LVDS_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHS_LVDS_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHS_LVDS_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_FMHT' AND ENG_COL_NM = 'FMHS_LVDS_YN_NOANS_SPCD';

-- 11040 // 유방암 가족병력암여부별 
	WITH W1 AS (SELECT 	11040 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.FMHS_CNCR_YN_NOANS_SPCD FROM BRCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.FMHS_CNCR_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11040 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 가족병력암여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.FMHS_CNCR_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHS_CNCR_YN_NOANS_SPCD,
COUNT(FMHS_CNCR_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHS_CNCR_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHS_CNCR_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_FMHT' AND ENG_COL_NM = 'FMHS_CNCR_YN_NOANS_SPCD';

-- 11041 // 유방암 가족력암종류별 
	WITH W1 AS (SELECT 	11041 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.FMHT_CNCR_KNCD FROM BRCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.FMHT_CNCR_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11041 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 가족력암종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.FMHT_CNCR_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHT_CNCR_KNCD,
COUNT(FMHT_CNCR_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHT_CNCR_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHT_CNCR_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_FMHT' AND ENG_COL_NM = 'FMHT_CNCR_KNCD';

-- 11042 // 유방암 가족력암종류기타내용별 
	WITH W1 AS (SELECT 	11042 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, SUBSTRING(A.FMHT_CNCR_KIND_ETC_CONT,1,100) AS FMHT_CNCR_KIND_ETC_CONT FROM BRCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.FMHT_CNCR_KIND_ETC_CONT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11042 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 가족력암종류기타내용별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.FMHT_CNCR_KIND_ETC_CONT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHT_CNCR_KIND_ETC_CONT,
COUNT(FMHT_CNCR_KIND_ETC_CONT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHT_CNCR_KIND_ETC_CONT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHT_CNCR_KIND_ETC_CONT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_FMHT' AND ENG_COL_NM = 'FMHT_CNCR_KIND_ETC_CONT';

-- 11043 // 유방암 가족병력기타여부별 
	WITH W1 AS (SELECT 	11043 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.FMHS_ETC_YN_NOANS_SPCD FROM BRCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.FMHS_ETC_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11043 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 가족병력기타여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.FMHS_ETC_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHS_ETC_YN_NOANS_SPCD,
COUNT(FMHS_ETC_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHS_ETC_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHS_ETC_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_FMHT' AND ENG_COL_NM = 'FMHS_ETC_YN_NOANS_SPCD';

-- 11044 // 유방암 가족병력기타내용별 
	WITH W1 AS (SELECT 	11044 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.FMHT_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, SUBSTRING(A.FMHS_ETC_CONT,1,100) AS FMHS_ETC_CONT FROM BRCN_PT_FMHT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	FMHT_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.FMHS_ETC_CONT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11044 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 가족병력기타내용별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.FMHS_ETC_CONT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, FMHS_ETC_CONT,
COUNT(FMHS_ETC_CONT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, FMHS_ETC_CONT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(FMHS_ETC_CONT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_FMHT' AND ENG_COL_NM = 'FMHS_ETC_CONT';

-- 11045 // 유방암 결혼여부별 
	WITH W1 AS (SELECT 	11045 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OBTR_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MARG_YN_NOANS_SPCD FROM BRCN_PT_OBINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OBTR_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.MARG_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11045 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 결혼여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MARG_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MARG_YN_NOANS_SPCD,
COUNT(MARG_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MARG_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MARG_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_OBINF' AND ENG_COL_NM = 'MARG_YN_NOANS_SPCD';

-- 11046 // 유방암 HRT경험여부별 
	WITH W1 AS (SELECT 	11046 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OBTR_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.HRPR_YN_NOANS_SPCD FROM BRCN_PT_OBINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OBTR_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.HRPR_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11046 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 HRT경험여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.HRPR_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, HRPR_YN_NOANS_SPCD,
COUNT(HRPR_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, HRPR_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(HRPR_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_OBINF' AND ENG_COL_NM = 'HRPR_YN_NOANS_SPCD';

-- 11047 // 유방암 HRT시행월수별 
	WITH W1 AS (SELECT 	11047 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OBTR_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.HRT_IMPL_MCNT FROM BRCN_PT_OBINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OBTR_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.HRT_IMPL_MCNT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11047 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 HRT시행월수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.HRT_IMPL_MCNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, HRT_IMPL_MCNT,
COUNT(HRT_IMPL_MCNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, HRT_IMPL_MCNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(HRT_IMPL_MCNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_OBINF' AND ENG_COL_NM = 'HRT_IMPL_MCNT';

-- 11048 // 유방암 초경연령별 
	WITH W1 AS (SELECT 	11048 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OBTR_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MENA_AGE_VL FROM BRCN_PT_OBINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OBTR_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.MENA_AGE_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11048 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 초경연령별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MENA_AGE_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MENA_AGE_VL,
COUNT(MENA_AGE_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MENA_AGE_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MENA_AGE_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_OBINF' AND ENG_COL_NM = 'MENA_AGE_VL';

-- 11049 // 유방암 출산연령별 
	WITH W1 AS (SELECT 	11049 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OBTR_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DELV_AGE_VL FROM BRCN_PT_OBINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OBTR_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.DELV_AGE_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11049 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 출산연령별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DELV_AGE_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DELV_AGE_VL,
COUNT(DELV_AGE_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DELV_AGE_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DELV_AGE_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_OBINF' AND ENG_COL_NM = 'DELV_AGE_VL';

-- 11050 // 유방암 출산자녀수별 
	WITH W1 AS (SELECT 	11050 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OBTR_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DELV_CHLD_CNT FROM BRCN_PT_OBINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OBTR_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.DELV_CHLD_CNT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11050 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 출산자녀수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DELV_CHLD_CNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DELV_CHLD_CNT,
COUNT(DELV_CHLD_CNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DELV_CHLD_CNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DELV_CHLD_CNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_OBINF' AND ENG_COL_NM = 'DELV_CHLD_CNT';

-- 11051 // 유방암 모유수유경험여부별 
	WITH W1 AS (SELECT 	11051 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OBTR_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BFPR_YN_NOANS_SPCD FROM BRCN_PT_OBINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OBTR_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.BFPR_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11051 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 모유수유경험여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.BFPR_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BFPR_YN_NOANS_SPCD,
COUNT(BFPR_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BFPR_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BFPR_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_OBINF' AND ENG_COL_NM = 'BFPR_YN_NOANS_SPCD';

-- 11052 // 유방암 모유수유월수별 
	WITH W1 AS (SELECT 	11052 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OBTR_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BRFD_MCNT FROM BRCN_PT_OBINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OBTR_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.BRFD_MCNT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11052 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 모유수유월수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.BRFD_MCNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BRFD_MCNT,
COUNT(BRFD_MCNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BRFD_MCNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BRFD_MCNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_OBINF' AND ENG_COL_NM = 'BRFD_MCNT';

-- 11053 // 유방암 경구피임약사용여부별 
	WITH W1 AS (SELECT 	11053 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OBTR_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OC_USE_YN_NOANS_SPCD FROM BRCN_PT_OBINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OBTR_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.OC_USE_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11053 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 경구피임약사용여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.OC_USE_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OC_USE_YN_NOANS_SPCD,
COUNT(OC_USE_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OC_USE_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OC_USE_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_OBINF' AND ENG_COL_NM = 'OC_USE_YN_NOANS_SPCD';

-- 11054 // 유방암 경구피임약사용월수별 
	WITH W1 AS (SELECT 	11054 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OBTR_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OC_USE_MCNT FROM BRCN_PT_OBINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OBTR_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.OC_USE_MCNT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11054 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 경구피임약사용월수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.OC_USE_MCNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OC_USE_MCNT,
COUNT(OC_USE_MCNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OC_USE_MCNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OC_USE_MCNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_OBINF' AND ENG_COL_NM = 'OC_USE_MCNT';

-- 11055 // 유방암 폐경여부별 
	WITH W1 AS (SELECT 	11055 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OBTR_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MENO_YN_NOANS_SPCD FROM BRCN_PT_OBINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OBTR_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.MENO_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11055 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 폐경여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MENO_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MENO_YN_NOANS_SPCD,
COUNT(MENO_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MENO_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MENO_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_OBINF' AND ENG_COL_NM = 'MENO_YN_NOANS_SPCD';

-- 11056 // 유방암 폐경연령별 
	WITH W1 AS (SELECT 	11056 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OBTR_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MENO_AGE_VL FROM BRCN_PT_OBINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OBTR_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.MENO_AGE_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11056 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 폐경연령별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MENO_AGE_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MENO_AGE_VL,
COUNT(MENO_AGE_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MENO_AGE_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MENO_AGE_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_OBINF' AND ENG_COL_NM = 'MENO_AGE_VL';

-- 11057 // 유방암 자궁적출술여부별 
	WITH W1 AS (SELECT 	11057 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OBTR_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.UTEC_YN_NOANS_SPCD FROM BRCN_PT_OBINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OBTR_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.UTEC_YN_NOANS_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11057 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 자궁적출술여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.UTEC_YN_NOANS_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, UTEC_YN_NOANS_SPCD,
COUNT(UTEC_YN_NOANS_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, UTEC_YN_NOANS_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(UTEC_YN_NOANS_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_PT_OBINF' AND ENG_COL_NM = 'UTEC_YN_NOANS_SPCD';

-- 11058 // 유방암 신장측정별 
	WITH W1 AS (SELECT 	11058 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTH_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.HT_MSRM_VL FROM BRCN_DIAG_ANINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTH_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.HT_MSRM_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11058 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 신장측정별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.HT_MSRM_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, HT_MSRM_VL,
COUNT(HT_MSRM_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, HT_MSRM_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(HT_MSRM_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_ANINF' AND ENG_COL_NM = 'HT_MSRM_VL';

-- 11059 // 유방암 체중측정별 
	WITH W1 AS (SELECT 	11059 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTH_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.WT_MSRM_VL FROM BRCN_DIAG_ANINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTH_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.WT_MSRM_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11059 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 체중측정별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.WT_MSRM_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, WT_MSRM_VL,
COUNT(WT_MSRM_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, WT_MSRM_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(WT_MSRM_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_ANINF' AND ENG_COL_NM = 'WT_MSRM_VL';

-- 11060 // 유방암 BMI별 
	WITH W1 AS (SELECT 	11060 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTH_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BMI_VL FROM BRCN_DIAG_ANINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTH_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.BMI_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11060 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 BMI별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.BMI_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BMI_VL,
COUNT(BMI_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BMI_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BMI_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_ANINF' AND ENG_COL_NM = 'BMI_VL';

-- 11061 // 유방암 이완혈압별 
	WITH W1 AS (SELECT 	11061 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTH_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RLXT_BLPR_VL FROM BRCN_DIAG_ANINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTH_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.RLXT_BLPR_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11061 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 이완혈압별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RLXT_BLPR_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RLXT_BLPR_VL,
COUNT(RLXT_BLPR_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RLXT_BLPR_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RLXT_BLPR_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_ANINF' AND ENG_COL_NM = 'RLXT_BLPR_VL';

-- 11062 // 유방암 수축혈압별 
	WITH W1 AS (SELECT 	11062 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTH_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CTRT_BLPR_VL FROM BRCN_DIAG_ANINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTH_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.CTRT_BLPR_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11062 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수축혈압별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.CTRT_BLPR_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CTRT_BLPR_VL,
COUNT(CTRT_BLPR_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CTRT_BLPR_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CTRT_BLPR_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_ANINF' AND ENG_COL_NM = 'CTRT_BLPR_VL';

-- 11063 // 유방암 ECOG코드별 
	WITH W1 AS (SELECT 	11063 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTH_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ECOG_CD FROM BRCN_DIAG_ANINF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTH_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.ECOG_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11063 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 ECOG코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.ECOG_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ECOG_CD,
COUNT(ECOG_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ECOG_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ECOG_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_ANINF' AND ENG_COL_NM = 'ECOG_CD';

-- 11064 // 유방암 유방암진단종류별 
	WITH W1 AS (SELECT 	11064 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_RGST_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BRCN_DIAG_KNCD FROM BRCN_DIAG_INF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_RGST_YMD BETWEEN '20100101' AND '20211231' AND A.BRCN_DIAG_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11064 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 유방암진단종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.BRCN_DIAG_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BRCN_DIAG_KNCD,
COUNT(BRCN_DIAG_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BRCN_DIAG_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BRCN_DIAG_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_INF' AND ENG_COL_NM = 'BRCN_DIAG_KNCD';

-- 11065 // 유방암 진단KCD코드별 
	WITH W1 AS (SELECT 	11065 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_RGST_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DIAG_KCD_CD FROM BRCN_DIAG_INF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_RGST_YMD BETWEEN '20100101' AND '20211231' AND A.DIAG_KCD_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11065 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 진단KCD코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DIAG_KCD_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DIAG_KCD_CD,
COUNT(DIAG_KCD_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DIAG_KCD_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DIAG_KCD_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_INF' AND ENG_COL_NM = 'DIAG_KCD_CD';

-- 11066 // 유방암 진단KCD명별 
	WITH W1 AS (SELECT 	11066 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_RGST_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DIAG_KCD_NM FROM BRCN_DIAG_INF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_RGST_YMD BETWEEN '20100101' AND '20211231' AND A.DIAG_KCD_NM IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11066 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 진단KCD명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DIAG_KCD_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DIAG_KCD_NM,
COUNT(DIAG_KCD_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DIAG_KCD_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DIAG_KCD_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_INF' AND ENG_COL_NM = 'DIAG_KCD_NM';

-- 11067 // 유방암 진단SNOMEDCT코드별 
	WITH W1 AS (SELECT 	11067 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_RGST_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DIAG_SMCT_CD FROM BRCN_DIAG_INF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_RGST_YMD BETWEEN '20100101' AND '20211231' AND A.DIAG_SMCT_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11067 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 진단SNOMEDCT코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DIAG_SMCT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DIAG_SMCT_CD,
COUNT(DIAG_SMCT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DIAG_SMCT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DIAG_SMCT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_INF' AND ENG_COL_NM = 'DIAG_SMCT_CD';

-- 11068 // 유방암 진단SNOMEDCT명별 
	WITH W1 AS (SELECT 	11068 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_RGST_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DIAG_SMCT_NM FROM BRCN_DIAG_INF AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_RGST_YMD BETWEEN '20100101' AND '20211231' AND A.DIAG_SMCT_NM IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11068 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 진단SNOMEDCT명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DIAG_SMCT_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DIAG_SMCT_NM,
COUNT(DIAG_SMCT_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DIAG_SMCT_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DIAG_SMCT_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_INF' AND ENG_COL_NM = 'DIAG_SMCT_NM';

-- 11069 // 유방암 전이부위별 
	WITH W1 AS (SELECT 	11069 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.MTDG_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MTST_SITE_CD FROM BRCN_DIAG_MTST AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	MTDG_YMD BETWEEN '20100101' AND '20211231' AND A.MTST_SITE_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11069 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 전이부위별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MTST_SITE_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MTST_SITE_CD,
COUNT(MTST_SITE_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MTST_SITE_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MTST_SITE_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_MTST' AND ENG_COL_NM = 'MTST_SITE_CD';

-- 11070 // 유방암 전이양상별 
	WITH W1 AS (SELECT 	11070 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.MTDG_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MTST_ASPT_CD FROM BRCN_DIAG_MTST AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	MTDG_YMD BETWEEN '20100101' AND '20211231' AND A.MTST_ASPT_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11070 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 전이양상별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MTST_ASPT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MTST_ASPT_CD,
COUNT(MTST_ASPT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MTST_ASPT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MTST_ASPT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_MTST' AND ENG_COL_NM = 'MTST_ASPT_CD';

-- 11071 // 유방암 전이진단방법별 
	WITH W1 AS (SELECT 	11071 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.MTDG_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MTDG_MTCD FROM BRCN_DIAG_MTST AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	MTDG_YMD BETWEEN '20100101' AND '20211231' AND A.MTDG_MTCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11071 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 전이진단방법별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MTDG_MTCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MTDG_MTCD,
COUNT(MTDG_MTCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MTDG_MTCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MTDG_MTCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_MTST' AND ENG_COL_NM = 'MTDG_MTCD';

-- 11072 // 유방암 임상종양특성별 
	WITH W1 AS (SELECT 	11072 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_STAG_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CLNC_TUMR_PRTY_CD FROM BRCN_DIAG_STAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_STAG_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.CLNC_TUMR_PRTY_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11072 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 임상종양특성별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.CLNC_TUMR_PRTY_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CLNC_TUMR_PRTY_CD,
COUNT(CLNC_TUMR_PRTY_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CLNC_TUMR_PRTY_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CLNC_TUMR_PRTY_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_STAG' AND ENG_COL_NM = 'CLNC_TUMR_PRTY_CD';

-- 11073 // 유방암 AJCC년도별 
	WITH W1 AS (SELECT 	11073 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_STAG_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AJCC_YR FROM BRCN_DIAG_STAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_STAG_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.AJCC_YR IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11073 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 AJCC년도별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.AJCC_YR AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AJCC_YR,
COUNT(AJCC_YR) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AJCC_YR) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AJCC_YR) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_STAG' AND ENG_COL_NM = 'AJCC_YR';

-- 11074 // 유방암 임상TNM병기별 
	WITH W1 AS (SELECT 	11074 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_STAG_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CLNC_TNM_STAG_VL FROM BRCN_DIAG_STAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_STAG_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.CLNC_TNM_STAG_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11074 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 임상TNM병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.CLNC_TNM_STAG_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CLNC_TNM_STAG_VL,
COUNT(CLNC_TNM_STAG_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CLNC_TNM_STAG_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CLNC_TNM_STAG_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_STAG' AND ENG_COL_NM = 'CLNC_TNM_STAG_VL';

-- 11075 // 유방암 임상T병기별 
	WITH W1 AS (SELECT 	11075 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_STAG_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CLNC_T_STAG_VL FROM BRCN_DIAG_STAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_STAG_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.CLNC_T_STAG_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11075 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 임상T병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.CLNC_T_STAG_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CLNC_T_STAG_VL,
COUNT(CLNC_T_STAG_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CLNC_T_STAG_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CLNC_T_STAG_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_STAG' AND ENG_COL_NM = 'CLNC_T_STAG_VL';

-- 11076 // 유방암 임상N병기별 
	WITH W1 AS (SELECT 	11076 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_STAG_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CLNC_N_STAG_VL FROM BRCN_DIAG_STAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_STAG_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.CLNC_N_STAG_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11076 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 임상N병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.CLNC_N_STAG_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CLNC_N_STAG_VL,
COUNT(CLNC_N_STAG_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CLNC_N_STAG_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CLNC_N_STAG_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_STAG' AND ENG_COL_NM = 'CLNC_N_STAG_VL';

-- 11077 // 유방암 임상M병기별 
	WITH W1 AS (SELECT 	11077 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DIAG_STAG_RCRD_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CLNC_M_STAG_VL FROM BRCN_DIAG_STAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DIAG_STAG_RCRD_YMD BETWEEN '20100101' AND '20211231' AND A.CLNC_M_STAG_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11077 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 임상M병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.CLNC_M_STAG_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CLNC_M_STAG_VL,
COUNT(CLNC_M_STAG_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CLNC_M_STAG_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CLNC_M_STAG_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_STAG' AND ENG_COL_NM = 'CLNC_M_STAG_VL';

-- 11078 // 유방암 진단검사종류별 
	WITH W1 AS (SELECT 	11078 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.CEXM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CEXM_KNCD FROM BRCN_EXAM_DIAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	CEXM_YMD BETWEEN '20100101' AND '20211231' AND A.CEXM_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11078 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 진단검사종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.CEXM_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CEXM_KNCD,
COUNT(CEXM_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CEXM_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CEXM_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_DIAG' AND ENG_COL_NM = 'CEXM_KNCD';

-- 11079 // 유방암 진단검사EDI코드별 
	WITH W1 AS (SELECT 	11079 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.CEXM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CEXM_EDI_CD FROM BRCN_EXAM_DIAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	CEXM_YMD BETWEEN '20100101' AND '20211231' AND A.CEXM_EDI_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11079 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 진단검사EDI코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.CEXM_EDI_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CEXM_EDI_CD,
COUNT(CEXM_EDI_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CEXM_EDI_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CEXM_EDI_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_DIAG' AND ENG_COL_NM = 'CEXM_EDI_CD';

-- 11080 // 유방암 진단검사EDI명별 
	WITH W1 AS (SELECT 	11080 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.CEXM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CEXM_EDI_NM FROM BRCN_EXAM_DIAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	CEXM_YMD BETWEEN '20100101' AND '20211231' AND A.CEXM_EDI_NM IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11080 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 진단검사EDI명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.CEXM_EDI_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CEXM_EDI_NM,
COUNT(CEXM_EDI_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CEXM_EDI_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CEXM_EDI_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_DIAG' AND ENG_COL_NM = 'CEXM_EDI_NM';

-- 11081 // 유방암 진단검사SNOMEDCT코드별 
	WITH W1 AS (SELECT 	11081 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.CEXM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CEXM_SMCT_CD FROM BRCN_EXAM_DIAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	CEXM_YMD BETWEEN '20100101' AND '20211231' AND A.CEXM_SMCT_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11081 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 진단검사SNOMEDCT코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.CEXM_SMCT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CEXM_SMCT_CD,
COUNT(CEXM_SMCT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CEXM_SMCT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CEXM_SMCT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_DIAG' AND ENG_COL_NM = 'CEXM_SMCT_CD';

-- 11082 // 유방암 진단검사SNOMEDCT명별 
	WITH W1 AS (SELECT 	11082 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.CEXM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CEXM_SMCT_NM FROM BRCN_EXAM_DIAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	CEXM_YMD BETWEEN '20100101' AND '20211231' AND A.CEXM_SMCT_NM IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11082 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 진단검사SNOMEDCT명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.CEXM_SMCT_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CEXM_SMCT_NM,
COUNT(CEXM_SMCT_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CEXM_SMCT_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CEXM_SMCT_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_DIAG' AND ENG_COL_NM = 'CEXM_SMCT_NM';

-- 11083 // 유방암 진단검사LOINC코드별 
	WITH W1 AS (SELECT 	11083 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.CEXM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CEXM_LOINC_CD FROM BRCN_EXAM_DIAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	CEXM_YMD BETWEEN '20100101' AND '20211231' AND A.CEXM_LOINC_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11083 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 진단검사LOINC코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.CEXM_LOINC_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CEXM_LOINC_CD,
COUNT(CEXM_LOINC_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CEXM_LOINC_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CEXM_LOINC_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_DIAG' AND ENG_COL_NM = 'CEXM_LOINC_CD';

-- 11084 // 유방암 진단검사LOINC명별 
	WITH W1 AS (SELECT 	11084 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.CEXM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.CEXM_LOINC_NM FROM BRCN_EXAM_DIAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	CEXM_YMD BETWEEN '20100101' AND '20211231' AND A.CEXM_LOINC_NM IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11084 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 진단검사LOINC명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.CEXM_LOINC_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, CEXM_LOINC_NM,
COUNT(CEXM_LOINC_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, CEXM_LOINC_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(CEXM_LOINC_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_DIAG' AND ENG_COL_NM = 'CEXM_LOINC_NM';

-- 11085 // 유방암 영상검사종류별 
	WITH W1 AS (SELECT 	11085 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.IMEX_KNCD FROM BRCN_EXAM_IMAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEX_YMD BETWEEN '20100101' AND '20211231' AND A.IMEX_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11085 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 영상검사종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.IMEX_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, IMEX_KNCD,
COUNT(IMEX_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, IMEX_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(IMEX_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_IMAG' AND ENG_COL_NM = 'IMEX_KNCD';

-- 11086 // 유방암 영상검사EDI코드별 
	WITH W1 AS (SELECT 	11086 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.IMEX_EDI_CD FROM BRCN_EXAM_IMAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEX_YMD BETWEEN '20100101' AND '20211231' AND A.IMEX_EDI_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11086 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 영상검사EDI코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.IMEX_EDI_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, IMEX_EDI_CD,
COUNT(IMEX_EDI_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, IMEX_EDI_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(IMEX_EDI_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_IMAG' AND ENG_COL_NM = 'IMEX_EDI_CD';

-- 11087 // 유방암 영상검사EDI명별 
	WITH W1 AS (SELECT 	11087 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.IMEX_EDI_NM FROM BRCN_EXAM_IMAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEX_YMD BETWEEN '20100101' AND '20211231' AND A.IMEX_EDI_NM IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11087 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 영상검사EDI명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.IMEX_EDI_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, IMEX_EDI_NM,
COUNT(IMEX_EDI_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, IMEX_EDI_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(IMEX_EDI_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_IMAG' AND ENG_COL_NM = 'IMEX_EDI_NM';

-- 11088 // 유방암 영상검사SNOMEDCT코드별 
	WITH W1 AS (SELECT 	11088 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.IMEX_SMCT_CD FROM BRCN_EXAM_IMAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEX_YMD BETWEEN '20100101' AND '20211231' AND A.IMEX_SMCT_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11088 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 영상검사SNOMEDCT코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.IMEX_SMCT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, IMEX_SMCT_CD,
COUNT(IMEX_SMCT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, IMEX_SMCT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(IMEX_SMCT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_IMAG' AND ENG_COL_NM = 'IMEX_SMCT_CD';

-- 11089 // 유방암 영상검사SNOMEDCT명별 
	WITH W1 AS (SELECT 	11089 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.IMEX_SMCT_NM FROM BRCN_EXAM_IMAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEX_YMD BETWEEN '20100101' AND '20211231' AND A.IMEX_SMCT_NM IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11089 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 영상검사SNOMEDCT명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.IMEX_SMCT_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, IMEX_SMCT_NM,
COUNT(IMEX_SMCT_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, IMEX_SMCT_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(IMEX_SMCT_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_IMAG' AND ENG_COL_NM = 'IMEX_SMCT_NM';

-- 11090 // 유방암 유방밀도분류별 
	WITH W1 AS (SELECT 	11090 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BRST_DENS_CLCD FROM BRCN_EXAM_IMAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEX_YMD BETWEEN '20100101' AND '20211231' AND A.BRST_DENS_CLCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11090 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 유방밀도분류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.BRST_DENS_CLCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BRST_DENS_CLCD,
COUNT(BRST_DENS_CLCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BRST_DENS_CLCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BRST_DENS_CLCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_IMAG' AND ENG_COL_NM = 'BRST_DENS_CLCD';

-- 11091 // 유방암 영상검사결과진단분류별 
	WITH W1 AS (SELECT 	11091 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.IMEX_RSLT_DIAG_CLCD FROM BRCN_EXAM_IMAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEX_YMD BETWEEN '20100101' AND '20211231' AND A.IMEX_RSLT_DIAG_CLCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11091 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 영상검사결과진단분류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.IMEX_RSLT_DIAG_CLCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, IMEX_RSLT_DIAG_CLCD,
COUNT(IMEX_RSLT_DIAG_CLCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, IMEX_RSLT_DIAG_CLCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(IMEX_RSLT_DIAG_CLCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_IMAG' AND ENG_COL_NM = 'IMEX_RSLT_DIAG_CLCD';

-- 11092 // 유방암 미세석회화여부확인불가구분별 
	WITH W1 AS (SELECT 	11092 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MICF_YN_UNID_SPCD FROM BRCN_EXAM_IMAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEX_YMD BETWEEN '20100101' AND '20211231' AND A.MICF_YN_UNID_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11092 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 미세석회화여부확인불가구분별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MICF_YN_UNID_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MICF_YN_UNID_SPCD,
COUNT(MICF_YN_UNID_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MICF_YN_UNID_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MICF_YN_UNID_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_IMAG' AND ENG_COL_NM = 'MICF_YN_UNID_SPCD';

-- 11093 // 유방암 비대칭여부확인불가구분별 
	WITH W1 AS (SELECT 	11093 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ASYT_YN_UNID_SPCD FROM BRCN_EXAM_IMAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEX_YMD BETWEEN '20100101' AND '20211231' AND A.ASYT_YN_UNID_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11093 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 비대칭여부확인불가구분별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.ASYT_YN_UNID_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ASYT_YN_UNID_SPCD,
COUNT(ASYT_YN_UNID_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ASYT_YN_UNID_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ASYT_YN_UNID_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_IMAG' AND ENG_COL_NM = 'ASYT_YN_UNID_SPCD';

-- 11094 // 유방암 전신전이여부확인불가구분별 
	WITH W1 AS (SELECT 	11094 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BOMS_YN_UNID_SPCD FROM BRCN_EXAM_IMAG AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEX_YMD BETWEEN '20100101' AND '20211231' AND A.BOMS_YN_UNID_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11094 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 전신전이여부확인불가구분별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.BOMS_YN_UNID_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BOMS_YN_UNID_SPCD,
COUNT(BOMS_YN_UNID_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BOMS_YN_UNID_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BOMS_YN_UNID_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_IMAG' AND ENG_COL_NM = 'BOMS_YN_UNID_SPCD';

-- 11095 // 유방암 생체검사부위별 
	WITH W1 AS (SELECT 	11095 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.BPSY_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BPSY_SITE_CD FROM BRCN_EXAM_BYPS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	BPSY_YMD BETWEEN '20100101' AND '20211231' AND A.BPSY_SITE_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11095 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 생체검사부위별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.BPSY_SITE_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BPSY_SITE_CD,
COUNT(BPSY_SITE_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BPSY_SITE_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BPSY_SITE_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_BYPS' AND ENG_COL_NM = 'BPSY_SITE_CD';

-- 11096 // 유방암 생체검사부위편측성별 
	WITH W1 AS (SELECT 	11096 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.BPSY_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BPSY_SITE_LATR_CD FROM BRCN_EXAM_BYPS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	BPSY_YMD BETWEEN '20100101' AND '20211231' AND A.BPSY_SITE_LATR_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11096 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 생체검사부위편측성별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.BPSY_SITE_LATR_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BPSY_SITE_LATR_CD,
COUNT(BPSY_SITE_LATR_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BPSY_SITE_LATR_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BPSY_SITE_LATR_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_BYPS' AND ENG_COL_NM = 'BPSY_SITE_LATR_CD';

-- 11097 // 유방암 생체검사방법종류별 
	WITH W1 AS (SELECT 	11097 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.BPSY_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BPSY_MTHD_KNCD FROM BRCN_EXAM_BYPS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	BPSY_YMD BETWEEN '20100101' AND '20211231' AND A.BPSY_MTHD_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11097 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 생체검사방법종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.BPSY_MTHD_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BPSY_MTHD_KNCD,
COUNT(BPSY_MTHD_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BPSY_MTHD_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BPSY_MTHD_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_BYPS' AND ENG_COL_NM = 'BPSY_MTHD_KNCD';

-- 11098 // 유방암 조직학적진단별 
	WITH W1 AS (SELECT 	11098 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.BPSY_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.HTLG_DIAG_CD FROM BRCN_EXAM_BYPS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	BPSY_YMD BETWEEN '20100101' AND '20211231' AND A.HTLG_DIAG_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11098 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 조직학적진단별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.HTLG_DIAG_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, HTLG_DIAG_CD,
COUNT(HTLG_DIAG_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, HTLG_DIAG_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(HTLG_DIAG_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_BYPS' AND ENG_COL_NM = 'HTLG_DIAG_CD';

-- 11099 // 유방암 조직학적등급별 
	WITH W1 AS (SELECT 	11099 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.BPSY_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.HTLG_GRCD FROM BRCN_EXAM_BYPS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	BPSY_YMD BETWEEN '20100101' AND '20211231' AND A.HTLG_GRCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11099 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 조직학적등급별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.HTLG_GRCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, HTLG_GRCD,
COUNT(HTLG_GRCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, HTLG_GRCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(HTLG_GRCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_BYPS' AND ENG_COL_NM = 'HTLG_GRCD';

-- 11100 // 유방암 면역병리검사종류별 
	WITH W1 AS (SELECT 	11100 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.IMEM_KNCD FROM BRCN_EXAM_IMPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEM_YMD BETWEEN '20100101' AND '20211231' AND A.IMEM_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11100 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 면역병리검사종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.IMEM_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, IMEM_KNCD,
COUNT(IMEM_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, IMEM_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(IMEM_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_IMPT' AND ENG_COL_NM = 'IMEM_KNCD';

-- 11101 // 유방암 면역병리검사소견분류별 
	WITH W1 AS (SELECT 	11101 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.IMEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.IMEM_OPN_CLCD FROM BRCN_EXAM_IMPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	IMEM_YMD BETWEEN '20100101' AND '20211231' AND A.IMEM_OPN_CLCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11101 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 면역병리검사소견분류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.IMEM_OPN_CLCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, IMEM_OPN_CLCD,
COUNT(IMEM_OPN_CLCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, IMEM_OPN_CLCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(IMEM_OPN_CLCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_IMPT' AND ENG_COL_NM = 'IMEM_OPN_CLCD';

-- 11102 // 유방암 분자병리검사종류별 
	WITH W1 AS (SELECT 	11102 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.MLEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MLEM_KNCD FROM BRCN_EXAM_MLPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	MLEM_YMD BETWEEN '20100101' AND '20211231' AND A.MLEM_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11102 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 분자병리검사종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MLEM_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MLEM_KNCD,
COUNT(MLEM_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MLEM_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MLEM_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_MLPT' AND ENG_COL_NM = 'MLEM_KNCD';

-- 11103 // 유방암 분자병리검사방법별 
	WITH W1 AS (SELECT 	11103 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.MLEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MLEM_MTCD FROM BRCN_EXAM_MLPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	MLEM_YMD BETWEEN '20100101' AND '20211231' AND A.MLEM_MTCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11103 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 분자병리검사방법별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MLEM_MTCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MLEM_MTCD,
COUNT(MLEM_MTCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MLEM_MTCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MLEM_MTCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_MLPT' AND ENG_COL_NM = 'MLEM_MTCD';

-- 11104 // 유방암 분자병리검사결과별 
	WITH W1 AS (SELECT 	11104 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.MLEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MLEM_RSLT_CD FROM BRCN_EXAM_MLPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	MLEM_YMD BETWEEN '20100101' AND '20211231' AND A.MLEM_RSLT_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11104 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 분자병리검사결과별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MLEM_RSLT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MLEM_RSLT_CD,
COUNT(MLEM_RSLT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MLEM_RSLT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MLEM_RSLT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_MLPT' AND ENG_COL_NM = 'MLEM_RSLT_CD';

-- 11105 // 유방암 분자병리검사결과종류별 
	WITH W1 AS (SELECT 	11105 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.MLEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MLEM_RSLT_KNCD FROM BRCN_EXAM_MLPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	MLEM_YMD BETWEEN '20100101' AND '20211231' AND A.MLEM_RSLT_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11105 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 분자병리검사결과종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MLEM_RSLT_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MLEM_RSLT_KNCD,
COUNT(MLEM_RSLT_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MLEM_RSLT_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MLEM_RSLT_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_MLPT' AND ENG_COL_NM = 'MLEM_RSLT_KNCD';

-- 11106 // 유방암 생식세포변이검사방법별 
	WITH W1 AS (SELECT 	11106 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.GMVX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.GMVX_MTCD FROM BRCN_EXAM_GMVX AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	GMVX_YMD BETWEEN '20100101' AND '20211231' AND A.GMVX_MTCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11106 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 생식세포변이검사방법별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.GMVX_MTCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, GMVX_MTCD,
COUNT(GMVX_MTCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, GMVX_MTCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(GMVX_MTCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_GMVX' AND ENG_COL_NM = 'GMVX_MTCD';

-- 11107 // 유방암 생식세포변이검사유전자종류별 
	WITH W1 AS (SELECT 	11107 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.GMVX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.GMVX_GENE_KNCD FROM BRCN_EXAM_GMVX AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	GMVX_YMD BETWEEN '20100101' AND '20211231' AND A.GMVX_GENE_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11107 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 생식세포변이검사유전자종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.GMVX_GENE_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, GMVX_GENE_KNCD,
COUNT(GMVX_GENE_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, GMVX_GENE_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(GMVX_GENE_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_GMVX' AND ENG_COL_NM = 'GMVX_GENE_KNCD';

-- 11108 // 유방암 병원변형체감지여부별 
	WITH W1 AS (SELECT 	11108 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.GMVX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.PAVR_DETECT_YN_SPCD FROM BRCN_EXAM_GMVX AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	GMVX_YMD BETWEEN '20100101' AND '20211231' AND A.PAVR_DETECT_YN_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11108 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 병원변형체감지여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.PAVR_DETECT_YN_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, PAVR_DETECT_YN_SPCD,
COUNT(PAVR_DETECT_YN_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, PAVR_DETECT_YN_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(PAVR_DETECT_YN_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_GMVX' AND ENG_COL_NM = 'PAVR_DETECT_YN_SPCD';

-- 11109 // 유방암 미확인변형체감지여부별 
	WITH W1 AS (SELECT 	11109 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.GMVX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.UNCL_VARNT_DETECT_YN_SPCD FROM BRCN_EXAM_GMVX AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	GMVX_YMD BETWEEN '20100101' AND '20211231' AND A.UNCL_VARNT_DETECT_YN_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11109 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 미확인변형체감지여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.UNCL_VARNT_DETECT_YN_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, UNCL_VARNT_DETECT_YN_SPCD,
COUNT(UNCL_VARNT_DETECT_YN_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, UNCL_VARNT_DETECT_YN_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(UNCL_VARNT_DETECT_YN_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_GMVX' AND ENG_COL_NM = 'UNCL_VARNT_DETECT_YN_SPCD';

-- 11110 // 유방암 DNA변이정보A별 
	WITH W1 AS (SELECT 	11110 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.GMVX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DNA_VAINF_A_VL FROM BRCN_EXAM_GMVX AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	GMVX_YMD BETWEEN '20100101' AND '20211231' AND A.DNA_VAINF_A_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11110 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 DNA변이정보A별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DNA_VAINF_A_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DNA_VAINF_A_VL,
COUNT(DNA_VAINF_A_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DNA_VAINF_A_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DNA_VAINF_A_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_GMVX' AND ENG_COL_NM = 'DNA_VAINF_A_VL';

-- 11111 // 유방암 DNA변이정보B별 
	WITH W1 AS (SELECT 	11111 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.GMVX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DNA_VAINF_B_CD FROM BRCN_EXAM_GMVX AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	GMVX_YMD BETWEEN '20100101' AND '20211231' AND A.DNA_VAINF_B_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11111 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 DNA변이정보B별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DNA_VAINF_B_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DNA_VAINF_B_CD,
COUNT(DNA_VAINF_B_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DNA_VAINF_B_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DNA_VAINF_B_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_GMVX' AND ENG_COL_NM = 'DNA_VAINF_B_CD';

-- 11112 // 유방암 DNA변이정보C별 
	WITH W1 AS (SELECT 	11112 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.GMVX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DNA_VAINF_C_CD FROM BRCN_EXAM_GMVX AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	GMVX_YMD BETWEEN '20100101' AND '20211231' AND A.DNA_VAINF_C_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11112 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 DNA변이정보C별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DNA_VAINF_C_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DNA_VAINF_C_CD,
COUNT(DNA_VAINF_C_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DNA_VAINF_C_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DNA_VAINF_C_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_GMVX' AND ENG_COL_NM = 'DNA_VAINF_C_CD';

-- 11113 // 유방암 아미노산변이정보A별 
	WITH W1 AS (SELECT 	11113 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.GMVX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AMSN_VAINF_A_CD FROM BRCN_EXAM_GMVX AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	GMVX_YMD BETWEEN '20100101' AND '20211231' AND A.AMSN_VAINF_A_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11113 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 아미노산변이정보A별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.AMSN_VAINF_A_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AMSN_VAINF_A_CD,
COUNT(AMSN_VAINF_A_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AMSN_VAINF_A_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AMSN_VAINF_A_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_GMVX' AND ENG_COL_NM = 'AMSN_VAINF_A_CD';

-- 11114 // 유방암 아미노산변이정보B별 
	WITH W1 AS (SELECT 	11114 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.GMVX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AMSN_VAINF_B_VL FROM BRCN_EXAM_GMVX AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	GMVX_YMD BETWEEN '20100101' AND '20211231' AND A.AMSN_VAINF_B_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11114 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 아미노산변이정보B별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.AMSN_VAINF_B_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AMSN_VAINF_B_VL,
COUNT(AMSN_VAINF_B_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AMSN_VAINF_B_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AMSN_VAINF_B_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_GMVX' AND ENG_COL_NM = 'AMSN_VAINF_B_VL';

-- 11115 // 유방암 아미노산변이정보C별 
	WITH W1 AS (SELECT 	11115 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.GMVX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AMSN_VAINF_C_CD FROM BRCN_EXAM_GMVX AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	GMVX_YMD BETWEEN '20100101' AND '20211231' AND A.AMSN_VAINF_C_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11115 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 아미노산변이정보C별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.AMSN_VAINF_C_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AMSN_VAINF_C_CD,
COUNT(AMSN_VAINF_C_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AMSN_VAINF_C_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AMSN_VAINF_C_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_GMVX' AND ENG_COL_NM = 'AMSN_VAINF_C_CD';

-- 11116 // 유방암 유전자발현검사종류별 
	WITH W1 AS (SELECT 	11116 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.GNRX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.GNRX_KNCD FROM BRCN_EXAM_GNRX AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	GNRX_YMD BETWEEN '20100101' AND '20211231' AND A.GNRX_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11116 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 유전자발현검사종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.GNRX_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, GNRX_KNCD,
COUNT(GNRX_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, GNRX_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(GNRX_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_GNRX' AND ENG_COL_NM = 'GNRX_KNCD';

-- 11117 // 유방암 유전자발현검사결과종류별 
	WITH W1 AS (SELECT 	11117 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.GNRX_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.GNRX_RSLT_KNCD FROM BRCN_EXAM_GNRX AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	GNRX_YMD BETWEEN '20100101' AND '20211231' AND A.GNRX_RSLT_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11117 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 유전자발현검사결과종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.GNRX_RSLT_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, GNRX_RSLT_KNCD,
COUNT(GNRX_RSLT_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, GNRX_RSLT_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(GNRX_RSLT_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_GNRX' AND ENG_COL_NM = 'GNRX_RSLT_KNCD';

-- 11118 // 유방암 수술종류별 
	WITH W1 AS (SELECT 	11118 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_KNCD FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.OPRT_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11118 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.OPRT_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_KNCD,
COUNT(OPRT_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_KNCD';

-- 11119 // 유방암 수술EDI코드별 
	WITH W1 AS (SELECT 	11119 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_EDI_CD FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.OPRT_EDI_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11119 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술EDI코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.OPRT_EDI_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_EDI_CD,
COUNT(OPRT_EDI_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_EDI_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_EDI_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_EDI_CD';

-- 11120 // 유방암 수술EDI명별 
	WITH W1 AS (SELECT 	11120 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_EDI_NM FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.OPRT_EDI_NM IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11120 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술EDI명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.OPRT_EDI_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_EDI_NM,
COUNT(OPRT_EDI_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_EDI_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_EDI_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_EDI_NM';

-- 11121 // 유방암 수술SNOMEDCT코드별 
	WITH W1 AS (SELECT 	11121 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_SMCT_CD FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.OPRT_SMCT_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11121 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술SNOMEDCT코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.OPRT_SMCT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_SMCT_CD,
COUNT(OPRT_SMCT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_SMCT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_SMCT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_SMCT_CD';

-- 11122 // 유방암 수술SNOMEDCT명별 
	WITH W1 AS (SELECT 	11122 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_SMCT_NM FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.OPRT_SMCT_NM IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11122 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술SNOMEDCT명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.OPRT_SMCT_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_SMCT_NM,
COUNT(OPRT_SMCT_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_SMCT_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_SMCT_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_SMCT_NM';

-- 11123 // 유방암 수술ICD9CM코드별 
	WITH W1 AS (SELECT 	11123 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_ICD9CM_CD FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.OPRT_ICD9CM_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11123 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술ICD9CM코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.OPRT_ICD9CM_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_ICD9CM_CD,
COUNT(OPRT_ICD9CM_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_ICD9CM_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_ICD9CM_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_ICD9CM_CD';

-- 11124 // 유방암 수술ICD9CM명별 
	WITH W1 AS (SELECT 	11124 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_ICD9CM_NM FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.OPRT_ICD9CM_NM IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11124 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술ICD9CM명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.OPRT_ICD9CM_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_ICD9CM_NM,
COUNT(OPRT_ICD9CM_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_ICD9CM_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_ICD9CM_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_ICD9CM_NM';

-- 11125 // 유방암 수술마취부위별 
	WITH W1 AS (SELECT 	11125 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_ANST_SITE_CD FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.OPRT_ANST_SITE_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11125 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술마취부위별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.OPRT_ANST_SITE_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_ANST_SITE_CD,
COUNT(OPRT_ANST_SITE_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_ANST_SITE_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_ANST_SITE_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_ANST_SITE_CD';

-- 11126 // 유방암 추정실혈량별 
	WITH W1 AS (SELECT 	11126 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.EBL_QTY FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.EBL_QTY IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11126 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 추정실혈량별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.EBL_QTY AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, EBL_QTY,
COUNT(EBL_QTY) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, EBL_QTY) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(EBL_QTY) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'EBL_QTY';

-- 11127 // 유방암 수술목적별 
	WITH W1 AS (SELECT 	11127 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_PRPS_CD FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.OPRT_PRPS_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11127 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술목적별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.OPRT_PRPS_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_PRPS_CD,
COUNT(OPRT_PRPS_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_PRPS_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_PRPS_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_PRPS_CD';

-- 11128 // 유방암 수술부위별 
	WITH W1 AS (SELECT 	11128 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_SITE_CD FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.OPRT_SITE_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11128 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술부위별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.OPRT_SITE_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_SITE_CD,
COUNT(OPRT_SITE_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_SITE_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_SITE_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_SITE_CD';

-- 11129 // 유방암 유방암수술방법별 
	WITH W1 AS (SELECT 	11129 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BRCN_OPRT_MTCD FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.BRCN_OPRT_MTCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11129 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 유방암수술방법별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.BRCN_OPRT_MTCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BRCN_OPRT_MTCD,
COUNT(BRCN_OPRT_MTCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BRCN_OPRT_MTCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BRCN_OPRT_MTCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'BRCN_OPRT_MTCD';

-- 11130 // 유방암 ASA점수별 
	WITH W1 AS (SELECT 	11130 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ASA_SCOR_CD FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.ASA_SCOR_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11130 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 ASA점수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.ASA_SCOR_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ASA_SCOR_CD,
COUNT(ASA_SCOR_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ASA_SCOR_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ASA_SCOR_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'ASA_SCOR_CD';

-- 11131 // 유방암 수술절개선유형별 
	WITH W1 AS (SELECT 	11131 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_ICLN_TPCD FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.OPRT_ICLN_TPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11131 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술절개선유형별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.OPRT_ICLN_TPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_ICLN_TPCD,
COUNT(OPRT_ICLN_TPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_ICLN_TPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_ICLN_TPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_ICLN_TPCD';

-- 11132 // 유방암 수술종양위치별 
	WITH W1 AS (SELECT 	11132 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_TUMR_LOCA_CD FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.OPRT_TUMR_LOCA_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11132 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술종양위치별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.OPRT_TUMR_LOCA_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_TUMR_LOCA_CD,
COUNT(OPRT_TUMR_LOCA_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_TUMR_LOCA_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_TUMR_LOCA_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_TUMR_LOCA_CD';

-- 11133 // 유방암 수술종양상세위치별 
	WITH W1 AS (SELECT 	11133 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.OPRT_TUMR_DETL_LOCA_CD FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.OPRT_TUMR_DETL_LOCA_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11133 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술종양상세위치별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.OPRT_TUMR_DETL_LOCA_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, OPRT_TUMR_DETL_LOCA_CD,
COUNT(OPRT_TUMR_DETL_LOCA_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, OPRT_TUMR_DETL_LOCA_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(OPRT_TUMR_DETL_LOCA_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'OPRT_TUMR_DETL_LOCA_CD';

-- 11134 // 유방암 재건술분류별 
	WITH W1 AS (SELECT 	11134 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.REPR_CLCD FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.REPR_CLCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11134 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 재건술분류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.REPR_CLCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, REPR_CLCD,
COUNT(REPR_CLCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, REPR_CLCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(REPR_CLCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'REPR_CLCD';

-- 11135 // 유방암 재건술방법별 
	WITH W1 AS (SELECT 	11135 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.REPR_MTCD FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.REPR_MTCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11135 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 재건술방법별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.REPR_MTCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, REPR_MTCD,
COUNT(REPR_MTCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, REPR_MTCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(REPR_MTCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'REPR_MTCD';

-- 11136 // 유방암 감시림프절검출방법별 
	WITH W1 AS (SELECT 	11136 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.SLND_DTCT_MTCD FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.SLND_DTCT_MTCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11136 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 감시림프절검출방법별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.SLND_DTCT_MTCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, SLND_DTCT_MTCD,
COUNT(SLND_DTCT_MTCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, SLND_DTCT_MTCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(SLND_DTCT_MTCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'SLND_DTCT_MTCD';

-- 11137 // 유방암 수술후평가항목별 
	WITH W1 AS (SELECT 	11137 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AFOP_ASMT_ITEM_CD FROM BRCN_TRTM_OPRT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.AFOP_ASMT_ITEM_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11137 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술후평가항목별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.AFOP_ASMT_ITEM_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AFOP_ASMT_ITEM_CD,
COUNT(AFOP_ASMT_ITEM_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AFOP_ASMT_ITEM_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AFOP_ASMT_ITEM_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_OPRT' AND ENG_COL_NM = 'AFOP_ASMT_ITEM_CD';

-- 11138 // 유방암 혈액제제종류별 
	WITH W1 AS (SELECT 	11138 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.BLTR_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BLPT_KNCD FROM BRCN_TRTM_BLTR AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	BLTR_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.BLPT_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11138 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 혈액제제종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.BLPT_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BLPT_KNCD,
COUNT(BLPT_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BLPT_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BLPT_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_BLTR' AND ENG_COL_NM = 'BLPT_KNCD';

-- 11139 // 유방암 혈액제제용량별 
	WITH W1 AS (SELECT 	11139 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.BLTR_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BLPT_CAPA FROM BRCN_TRTM_BLTR AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	BLTR_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.BLPT_CAPA IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11139 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 혈액제제용량별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.BLPT_CAPA AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BLPT_CAPA,
COUNT(BLPT_CAPA) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BLPT_CAPA) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BLPT_CAPA) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_BLTR' AND ENG_COL_NM = 'BLPT_CAPA';

-- 11140 // 유방암 수혈팩수별 
	WITH W1 AS (SELECT 	11140 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.BLTR_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BLTR_PACK_CNT FROM BRCN_TRTM_BLTR AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	BLTR_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.BLTR_PACK_CNT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11140 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수혈팩수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.BLTR_PACK_CNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BLTR_PACK_CNT,
COUNT(BLTR_PACK_CNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BLTR_PACK_CNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BLTR_PACK_CNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_BLTR' AND ENG_COL_NM = 'BLTR_PACK_CNT';

-- 11141 // 유방암 수혈총량별 
	WITH W1 AS (SELECT 	11141 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.BLTR_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.BLTR_TOTL_QTY FROM BRCN_TRTM_BLTR AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	BLTR_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.BLTR_TOTL_QTY IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11141 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수혈총량별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.BLTR_TOTL_QTY AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, BLTR_TOTL_QTY,
COUNT(BLTR_TOTL_QTY) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, BLTR_TOTL_QTY) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(BLTR_TOTL_QTY) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_BLTR' AND ENG_COL_NM = 'BLTR_TOTL_QTY';

-- 11142 // 유방암 외과병리채취부위별 
	WITH W1 AS (SELECT 	11142 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.SGPT_HVST_SITE_CD FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.SGPT_HVST_SITE_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11142 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 외과병리채취부위별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.SGPT_HVST_SITE_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, SGPT_HVST_SITE_CD,
COUNT(SGPT_HVST_SITE_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, SGPT_HVST_SITE_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(SGPT_HVST_SITE_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'SGPT_HVST_SITE_CD';

-- 11143 // 유방암 외과병리검사부위편측성별 
	WITH W1 AS (SELECT 	11143 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.SGPT_EXAM_SITE_LATR_CD FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.SGPT_EXAM_SITE_LATR_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11143 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 외과병리검사부위편측성별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.SGPT_EXAM_SITE_LATR_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, SGPT_EXAM_SITE_LATR_CD,
COUNT(SGPT_EXAM_SITE_LATR_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, SGPT_EXAM_SITE_LATR_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(SGPT_EXAM_SITE_LATR_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'SGPT_EXAM_SITE_LATR_CD';

-- 11144 // 유방암 외과병리검사결과종양수별 
	WITH W1 AS (SELECT 	11144 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.SRGC_PTEM_RSLT_TUMR_CNT FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.SRGC_PTEM_RSLT_TUMR_CNT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11144 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 외과병리검사결과종양수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.SRGC_PTEM_RSLT_TUMR_CNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, SRGC_PTEM_RSLT_TUMR_CNT,
COUNT(SRGC_PTEM_RSLT_TUMR_CNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, SRGC_PTEM_RSLT_TUMR_CNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(SRGC_PTEM_RSLT_TUMR_CNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'SRGC_PTEM_RSLT_TUMR_CNT';

-- 11145 // 유방암 종양가로길이별 
	WITH W1 AS (SELECT 	11145 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.TUMR_WDTH_LNTH_VL FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.TUMR_WDTH_LNTH_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11145 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 종양가로길이별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.TUMR_WDTH_LNTH_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, TUMR_WDTH_LNTH_VL,
COUNT(TUMR_WDTH_LNTH_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, TUMR_WDTH_LNTH_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(TUMR_WDTH_LNTH_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'TUMR_WDTH_LNTH_VL';

-- 11146 // 유방암 종양세로길이별 
	WITH W1 AS (SELECT 	11146 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.TUMR_LGTD_LNTH_VL FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.TUMR_LGTD_LNTH_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11146 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 종양세로길이별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.TUMR_LGTD_LNTH_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, TUMR_LGTD_LNTH_VL,
COUNT(TUMR_LGTD_LNTH_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, TUMR_LGTD_LNTH_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(TUMR_LGTD_LNTH_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'TUMR_LGTD_LNTH_VL';

-- 11147 // 유방암 종양높이별 
	WITH W1 AS (SELECT 	11147 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.TUMR_HGHT_VL FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.TUMR_HGHT_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11147 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 종양높이별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.TUMR_HGHT_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, TUMR_HGHT_VL,
COUNT(TUMR_HGHT_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, TUMR_HGHT_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(TUMR_HGHT_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'TUMR_HGHT_VL';

-- 11148 // 유방암 종양최대직경별 
	WITH W1 AS (SELECT 	11148 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.TUMR_MAX_DIAM_VL FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.TUMR_MAX_DIAM_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11148 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 종양최대직경별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.TUMR_MAX_DIAM_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, TUMR_MAX_DIAM_VL,
COUNT(TUMR_MAX_DIAM_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, TUMR_MAX_DIAM_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(TUMR_MAX_DIAM_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'TUMR_MAX_DIAM_VL';

-- 11149 // 유방암 조직학적진단별 
	WITH W1 AS (SELECT 	11149 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.HTLG_DIAG_CD FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.HTLG_DIAG_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11149 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 조직학적진단별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.HTLG_DIAG_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, HTLG_DIAG_CD,
COUNT(HTLG_DIAG_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, HTLG_DIAG_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(HTLG_DIAG_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'HTLG_DIAG_CD';

-- 11150 // 유방암 조직학적등급별 
	WITH W1 AS (SELECT 	11150 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.HTLG_GRCD FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.HTLG_GRCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11150 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 조직학적등급별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.HTLG_GRCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, HTLG_GRCD,
COUNT(HTLG_GRCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, HTLG_GRCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(HTLG_GRCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'HTLG_GRCD';

-- 11151 // 유방암 림프혈관침윤존재여부별 
	WITH W1 AS (SELECT 	11151 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.LVIN_EX_YN_SPCD FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.LVIN_EX_YN_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11151 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 림프혈관침윤존재여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.LVIN_EX_YN_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, LVIN_EX_YN_SPCD,
COUNT(LVIN_EX_YN_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, LVIN_EX_YN_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(LVIN_EX_YN_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'LVIN_EX_YN_SPCD';

-- 11152 // 유방암 림프절주위침윤존재여부별 
	WITH W1 AS (SELECT 	11152 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.LPIN_EX_YN_SPCD FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.LPIN_EX_YN_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11152 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 림프절주위침윤존재여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.LPIN_EX_YN_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, LPIN_EX_YN_SPCD,
COUNT(LPIN_EX_YN_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, LPIN_EX_YN_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(LPIN_EX_YN_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'LPIN_EX_YN_SPCD';

-- 11153 // 유방암 유두침윤존재여부별 
	WITH W1 AS (SELECT 	11153 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.NIIN_EX_YN_SPCD FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.NIIN_EX_YN_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11153 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 유두침윤존재여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.NIIN_EX_YN_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, NIIN_EX_YN_SPCD,
COUNT(NIIN_EX_YN_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, NIIN_EX_YN_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(NIIN_EX_YN_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'NIIN_EX_YN_SPCD';

-- 11154 // 유방암 외과병리미세석회화존재여부별 
	WITH W1 AS (SELECT 	11154 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.SGPT_MICF_EX_YN_SPCD FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.SGPT_MICF_EX_YN_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11154 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 외과병리미세석회화존재여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.SGPT_MICF_EX_YN_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, SGPT_MICF_EX_YN_SPCD,
COUNT(SGPT_MICF_EX_YN_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, SGPT_MICF_EX_YN_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(SGPT_MICF_EX_YN_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'SGPT_MICF_EX_YN_SPCD';

-- 11155 // 유방암 상피내암괴사존재여부별 
	WITH W1 AS (SELECT 	11155 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.INCN_NECR_EX_YN_SPCD FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.INCN_NECR_EX_YN_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11155 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 상피내암괴사존재여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.INCN_NECR_EX_YN_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, INCN_NECR_EX_YN_SPCD,
COUNT(INCN_NECR_EX_YN_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, INCN_NECR_EX_YN_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(INCN_NECR_EX_YN_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'INCN_NECR_EX_YN_SPCD';

-- 11156 // 유방암 상피내암동반존재여부별 
	WITH W1 AS (SELECT 	11156 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.INCN_ASSO_EX_YN_SPCD FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.INCN_ASSO_EX_YN_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11156 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 상피내암동반존재여부별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.INCN_ASSO_EX_YN_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, INCN_ASSO_EX_YN_SPCD,
COUNT(INCN_ASSO_EX_YN_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, INCN_ASSO_EX_YN_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(INCN_ASSO_EX_YN_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'INCN_ASSO_EX_YN_SPCD';

-- 11157 // 유방암 상피내암핵등급별 
	WITH W1 AS (SELECT 	11157 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.INCN_CORE_GRCD FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.INCN_CORE_GRCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11157 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 상피내암핵등급별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.INCN_CORE_GRCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, INCN_CORE_GRCD,
COUNT(INCN_CORE_GRCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, INCN_CORE_GRCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(INCN_CORE_GRCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'INCN_CORE_GRCD';

-- 11158 // 유방암 수술절제면안전경계길이별 
	WITH W1 AS (SELECT 	11158 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.SRMG_SFMG_LNTH_VL FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.SRMG_SFMG_LNTH_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11158 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술절제면안전경계길이별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.SRMG_SFMG_LNTH_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, SRMG_SFMG_LNTH_VL,
COUNT(SRMG_SFMG_LNTH_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, SRMG_SFMG_LNTH_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(SRMG_SFMG_LNTH_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'SRMG_SFMG_LNTH_VL';

-- 11159 // 유방암 수술절제면잔존별 
	WITH W1 AS (SELECT 	11159 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.SRMG_RLCT_CD FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.SRMG_RLCT_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11159 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술절제면잔존별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.SRMG_RLCT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, SRMG_RLCT_CD,
COUNT(SRMG_RLCT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, SRMG_RLCT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(SRMG_RLCT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'SRMG_RLCT_CD';

-- 11160 // 유방암 전이암크기별 
	WITH W1 AS (SELECT 	11160 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.MTCR_SIZE_VL FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.MTCR_SIZE_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11160 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 전이암크기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.MTCR_SIZE_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, MTCR_SIZE_VL,
COUNT(MTCR_SIZE_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, MTCR_SIZE_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(MTCR_SIZE_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'MTCR_SIZE_VL';

-- 11161 // 유방암 동반병변별 
	WITH W1 AS (SELECT 	11161 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ASSO_LESN_CD FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.ASSO_LESN_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11161 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 동반병변별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.ASSO_LESN_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ASSO_LESN_CD,
COUNT(ASSO_LESN_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ASSO_LESN_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ASSO_LESN_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'ASSO_LESN_CD';

-- 11162 // 유방암 잔여종양별 
	WITH W1 AS (SELECT 	11162 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RESI_TUMR_CD FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.RESI_TUMR_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11162 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 잔여종양별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RESI_TUMR_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RESI_TUMR_CD,
COUNT(RESI_TUMR_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RESI_TUMR_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RESI_TUMR_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'RESI_TUMR_CD';

-- 11163 // 유방암 림프절총수별 
	WITH W1 AS (SELECT 	11163 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.LN_TOTL_CNT FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.LN_TOTL_CNT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11163 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 림프절총수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.LN_TOTL_CNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, LN_TOTL_CNT,
COUNT(LN_TOTL_CNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, LN_TOTL_CNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(LN_TOTL_CNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'LN_TOTL_CNT';

-- 11164 // 유방암 양성림프절수별 
	WITH W1 AS (SELECT 	11164 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.PSTV_LN_CNT FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.PSTV_LN_CNT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11164 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 양성림프절수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.PSTV_LN_CNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, PSTV_LN_CNT,
COUNT(PSTV_LN_CNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, PSTV_LN_CNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(PSTV_LN_CNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'PSTV_LN_CNT';

-- 11165 // 유방암 감시림프절총수별 
	WITH W1 AS (SELECT 	11165 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.SLND_TOTL_CNT FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.SLND_TOTL_CNT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11165 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 감시림프절총수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.SLND_TOTL_CNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, SLND_TOTL_CNT,
COUNT(SLND_TOTL_CNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, SLND_TOTL_CNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(SLND_TOTL_CNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'SLND_TOTL_CNT';

-- 11166 // 유방암 양성감시림프절수별 
	WITH W1 AS (SELECT 	11166 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.PSTV_SLND_CNT FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.PSTV_SLND_CNT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11166 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 양성감시림프절수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.PSTV_SLND_CNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, PSTV_SLND_CNT,
COUNT(PSTV_SLND_CNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, PSTV_SLND_CNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(PSTV_SLND_CNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'PSTV_SLND_CNT';

-- 11167 // 유방암 비감시림프절총수별 
	WITH W1 AS (SELECT 	11167 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.NSND_TOTL_CNT FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.NSND_TOTL_CNT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11167 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 비감시림프절총수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.NSND_TOTL_CNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, NSND_TOTL_CNT,
COUNT(NSND_TOTL_CNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, NSND_TOTL_CNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(NSND_TOTL_CNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'NSND_TOTL_CNT';

-- 11168 // 유방암 양성비감시림프절수별 
	WITH W1 AS (SELECT 	11168 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.PSTV_NSND_CNT FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.PSTV_NSND_CNT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11168 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 양성비감시림프절수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.PSTV_NSND_CNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, PSTV_NSND_CNT,
COUNT(PSTV_NSND_CNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, PSTV_NSND_CNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(PSTV_NSND_CNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'PSTV_NSND_CNT';

-- 11169 // 유방암 AJCC년도별 
	WITH W1 AS (SELECT 	11169 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AJCC_YR FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.AJCC_YR IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11169 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 AJCC년도별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.AJCC_YR AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AJCC_YR,
COUNT(AJCC_YR) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AJCC_YR) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AJCC_YR) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'AJCC_YR';

-- 11170 // 유방암 수술후병리TNM병기별 
	WITH W1 AS (SELECT 	11170 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AFOP_PATH_TNM_STAG_VL FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.AFOP_PATH_TNM_STAG_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11170 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술후병리TNM병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.AFOP_PATH_TNM_STAG_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AFOP_PATH_TNM_STAG_VL,
COUNT(AFOP_PATH_TNM_STAG_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AFOP_PATH_TNM_STAG_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AFOP_PATH_TNM_STAG_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'AFOP_PATH_TNM_STAG_VL';

-- 11171 // 유방암 수술후병리T병기별 
	WITH W1 AS (SELECT 	11171 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AFOP_PATH_T_STAG_VL FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.AFOP_PATH_T_STAG_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11171 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술후병리T병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.AFOP_PATH_T_STAG_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AFOP_PATH_T_STAG_VL,
COUNT(AFOP_PATH_T_STAG_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AFOP_PATH_T_STAG_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AFOP_PATH_T_STAG_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'AFOP_PATH_T_STAG_VL';

-- 11172 // 유방암 수술후병리N병기별 
	WITH W1 AS (SELECT 	11172 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AFOP_PATH_N_STAG_VL FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.AFOP_PATH_N_STAG_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11172 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술후병리N병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.AFOP_PATH_N_STAG_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AFOP_PATH_N_STAG_VL,
COUNT(AFOP_PATH_N_STAG_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AFOP_PATH_N_STAG_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AFOP_PATH_N_STAG_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'AFOP_PATH_N_STAG_VL';

-- 11173 // 유방암 수술후병리M병기별 
	WITH W1 AS (SELECT 	11173 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.SRGC_PTEM_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.AFOP_PATH_M_STAG_VL FROM BRCN_EXAM_SGPT AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	SRGC_PTEM_YMD BETWEEN '20100101' AND '20211231' AND A.AFOP_PATH_M_STAG_VL IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11173 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술후병리M병기별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.AFOP_PATH_M_STAG_VL AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AFOP_PATH_M_STAG_VL,
COUNT(AFOP_PATH_M_STAG_VL) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AFOP_PATH_M_STAG_VL) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AFOP_PATH_M_STAG_VL) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_EXAM_SGPT' AND ENG_COL_NM = 'AFOP_PATH_M_STAG_VL';

-- 11174 // 유방암 수술후합병증내용별 
	WITH W1 AS (SELECT 	11174 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.COMP_OCRN_OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, SUBSTRING(A.AFOC_CONT,1,100) AS AFOC_CONT FROM BRCN_DIAG_AFOC AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	COMP_OCRN_OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.AFOC_CONT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11174 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 수술후합병증내용별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.AFOC_CONT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, AFOC_CONT,
COUNT(AFOC_CONT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, AFOC_CONT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(AFOC_CONT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_AFOC' AND ENG_COL_NM = 'AFOC_CONT';

-- 11175 // 유방암 합병증등급별 
	WITH W1 AS (SELECT 	11175 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.COMP_OCRN_OPRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.COMP_GRCD FROM BRCN_DIAG_AFOC AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	COMP_OCRN_OPRT_YMD BETWEEN '20100101' AND '20211231' AND A.COMP_GRCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11175 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 합병증등급별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.COMP_GRCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, COMP_GRCD,
COUNT(COMP_GRCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, COMP_GRCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(COMP_GRCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_DIAG_AFOC' AND ENG_COL_NM = 'COMP_GRCD';

-- 11176 // 유방암 약제분류별 
	WITH W1 AS (SELECT 	11176 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_CLCD FROM BRCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.DRUG_CLCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11176 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 약제분류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRUG_CLCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_CLCD,
COUNT(DRUG_CLCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_CLCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_CLCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_CLCD';

-- 11177 // 유방암 항암약제구분별 
	WITH W1 AS (SELECT 	11177 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ANDR_SPCD FROM BRCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.ANDR_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11177 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 항암약제구분별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.ANDR_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ANDR_SPCD,
COUNT(ANDR_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ANDR_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ANDR_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_DRIN' AND ENG_COL_NM = 'ANDR_SPCD';

-- 11178 // 유방암 약제성분종류별 
	WITH W1 AS (SELECT 	11178 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRIN_KNCD FROM BRCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.DRIN_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11178 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 약제성분종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRIN_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRIN_KNCD,
COUNT(DRIN_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRIN_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRIN_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_DRIN' AND ENG_COL_NM = 'DRIN_KNCD';

-- 11179 // 유방암 약제성분별 
	WITH W1 AS (SELECT 	11179 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRIN_CD FROM BRCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.DRIN_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11179 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 약제성분별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRIN_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRIN_CD,
COUNT(DRIN_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRIN_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRIN_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_DRIN' AND ENG_COL_NM = 'DRIN_CD';

-- 11180 // 유방암 약제성분명별 
	WITH W1 AS (SELECT 	11180 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRIN_NM FROM BRCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.DRIN_NM IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11180 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 약제성분명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRIN_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRIN_NM,
COUNT(DRIN_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRIN_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRIN_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_DRIN' AND ENG_COL_NM = 'DRIN_NM';

-- 11181 // 유방암 약제성분SNOMEDCT코드별 
	WITH W1 AS (SELECT 	11181 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRIN_SMCT_CD FROM BRCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.DRIN_SMCT_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11181 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 약제성분SNOMEDCT코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRIN_SMCT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRIN_SMCT_CD,
COUNT(DRIN_SMCT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRIN_SMCT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRIN_SMCT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_DRIN' AND ENG_COL_NM = 'DRIN_SMCT_CD';

-- 11182 // 유방암 약제성분SNOMEDCT명별 
	WITH W1 AS (SELECT 	11182 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRIN_SMCT_NM FROM BRCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.DRIN_SMCT_NM IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11182 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 약제성분SNOMEDCT명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRIN_SMCT_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRIN_SMCT_NM,
COUNT(DRIN_SMCT_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRIN_SMCT_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRIN_SMCT_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_DRIN' AND ENG_COL_NM = 'DRIN_SMCT_NM';

-- 11183 // 유방암 약제EDI코드별 
	WITH W1 AS (SELECT 	11183 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_EDI_CD FROM BRCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.DRUG_EDI_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11183 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 약제EDI코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRUG_EDI_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_EDI_CD,
COUNT(DRUG_EDI_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_EDI_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_EDI_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_EDI_CD';

-- 11184 // 유방암 약제EDI명별 
	WITH W1 AS (SELECT 	11184 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_EDI_NM FROM BRCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.DRUG_EDI_NM IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11184 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 약제EDI명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRUG_EDI_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_EDI_NM,
COUNT(DRUG_EDI_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_EDI_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_EDI_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_EDI_NM';

-- 11185 // 유방암 약제ATC코드별 
	WITH W1 AS (SELECT 	11185 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_ATC_CD FROM BRCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.DRUG_ATC_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11185 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 약제ATC코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRUG_ATC_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_ATC_CD,
COUNT(DRUG_ATC_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_ATC_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_ATC_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_ATC_CD';

-- 11186 // 유방암 약제ATC명별 
	WITH W1 AS (SELECT 	11186 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_ATC_NM FROM BRCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.DRUG_ATC_NM IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11186 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 약제ATC명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRUG_ATC_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_ATC_NM,
COUNT(DRUG_ATC_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_ATC_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_ATC_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_ATC_NM';

-- 11187 // 유방암 약제RXNORM코드별 
	WITH W1 AS (SELECT 	11187 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_RXNM_CD FROM BRCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.DRUG_RXNM_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11187 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 약제RXNORM코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRUG_RXNM_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_RXNM_CD,
COUNT(DRUG_RXNM_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_RXNM_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_RXNM_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_RXNM_CD';

-- 11188 // 유방암 약제RXNORM명별 
	WITH W1 AS (SELECT 	11188 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_RXNM_NM FROM BRCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.DRUG_RXNM_NM IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11188 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 약제RXNORM명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRUG_RXNM_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_RXNM_NM,
COUNT(DRUG_RXNM_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_RXNM_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_RXNM_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_RXNM_NM';

-- 11189 // 유방암 약제처방용량단위별 
	WITH W1 AS (SELECT 	11189 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_PRSC_CAPA_UNIT_CD FROM BRCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.DRUG_PRSC_CAPA_UNIT_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11189 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 약제처방용량단위별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRUG_PRSC_CAPA_UNIT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_PRSC_CAPA_UNIT_CD,
COUNT(DRUG_PRSC_CAPA_UNIT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_PRSC_CAPA_UNIT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_PRSC_CAPA_UNIT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_PRSC_CAPA_UNIT_CD';

-- 11190 // 유방암 약제투여경로별 
	WITH W1 AS (SELECT 	11190 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.DRUG_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.DRUG_INJC_PTH_CD FROM BRCN_TRTM_DRIN AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	DRUG_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.DRUG_INJC_PTH_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11190 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 약제투여경로별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.DRUG_INJC_PTH_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, DRUG_INJC_PTH_CD,
COUNT(DRUG_INJC_PTH_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, DRUG_INJC_PTH_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(DRUG_INJC_PTH_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_DRIN' AND ENG_COL_NM = 'DRUG_INJC_PTH_CD';

-- 11191 // 유방암 항암요법주기수별 
	WITH W1 AS (SELECT 	11191 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTP_STRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ANTP_CYCL_CNT FROM BRCN_TRTM_ANTP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTP_STRT_YMD BETWEEN '20100101' AND '20211231' AND A.ANTP_CYCL_CNT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11191 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 항암요법주기수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.ANTP_CYCL_CNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ANTP_CYCL_CNT,
COUNT(ANTP_CYCL_CNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ANTP_CYCL_CNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ANTP_CYCL_CNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_ANTP' AND ENG_COL_NM = 'ANTP_CYCL_CNT';

-- 11192 // 유방암 항암요법라인수별 
	WITH W1 AS (SELECT 	11192 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTP_STRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ANTP_LINE_CNT FROM BRCN_TRTM_ANTP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTP_STRT_YMD BETWEEN '20100101' AND '20211231' AND A.ANTP_LINE_CNT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11192 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 항암요법라인수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.ANTP_LINE_CNT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ANTP_LINE_CNT,
COUNT(ANTP_LINE_CNT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ANTP_LINE_CNT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ANTP_LINE_CNT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_ANTP' AND ENG_COL_NM = 'ANTP_LINE_CNT';

-- 11193 // 유방암 항암요법임시중단여부확인불가구분별 
	WITH W1 AS (SELECT 	11193 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTP_STRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ANTP_TEMP_STOP_YN_UNID_SPCD FROM BRCN_TRTM_ANTP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTP_STRT_YMD BETWEEN '20100101' AND '20211231' AND A.ANTP_TEMP_STOP_YN_UNID_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11193 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 항암요법임시중단여부확인불가구분별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.ANTP_TEMP_STOP_YN_UNID_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ANTP_TEMP_STOP_YN_UNID_SPCD,
COUNT(ANTP_TEMP_STOP_YN_UNID_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ANTP_TEMP_STOP_YN_UNID_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ANTP_TEMP_STOP_YN_UNID_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_ANTP' AND ENG_COL_NM = 'ANTP_TEMP_STOP_YN_UNID_SPCD';

-- 11194 // 유방암 항암요법종료이유별 
	WITH W1 AS (SELECT 	11194 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTP_STRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ANTP_END_RESN_CD FROM BRCN_TRTM_ANTP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTP_STRT_YMD BETWEEN '20100101' AND '20211231' AND A.ANTP_END_RESN_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11194 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 항암요법종료이유별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.ANTP_END_RESN_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ANTP_END_RESN_CD,
COUNT(ANTP_END_RESN_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ANTP_END_RESN_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ANTP_END_RESN_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_ANTP' AND ENG_COL_NM = 'ANTP_END_RESN_CD';

-- 11195 // 유방암 항암요법평가항목별 
	WITH W1 AS (SELECT 	11195 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTP_STRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ANTP_ASMT_ITEM_CD FROM BRCN_TRTM_ANTP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTP_STRT_YMD BETWEEN '20100101' AND '20211231' AND A.ANTP_ASMT_ITEM_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11195 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 항암요법평가항목별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.ANTP_ASMT_ITEM_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ANTP_ASMT_ITEM_CD,
COUNT(ANTP_ASMT_ITEM_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ANTP_ASMT_ITEM_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ANTP_ASMT_ITEM_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_ANTP' AND ENG_COL_NM = 'ANTP_ASMT_ITEM_CD';

-- 11196 // 유방암 항암요법부작용항목별 
	WITH W1 AS (SELECT 	11196 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTP_STRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ANTP_SEFF_ITEM_CD FROM BRCN_TRTM_ANTP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTP_STRT_YMD BETWEEN '20100101' AND '20211231' AND A.ANTP_SEFF_ITEM_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11196 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 항암요법부작용항목별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.ANTP_SEFF_ITEM_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ANTP_SEFF_ITEM_CD,
COUNT(ANTP_SEFF_ITEM_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ANTP_SEFF_ITEM_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ANTP_SEFF_ITEM_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_ANTP' AND ENG_COL_NM = 'ANTP_SEFF_ITEM_CD';

-- 11197 // 유방암 항암요법부작용등급별 
	WITH W1 AS (SELECT 	11197 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTP_STRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ANTP_SEFF_GRCD FROM BRCN_TRTM_ANTP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTP_STRT_YMD BETWEEN '20100101' AND '20211231' AND A.ANTP_SEFF_GRCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11197 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 항암요법부작용등급별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.ANTP_SEFF_GRCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ANTP_SEFF_GRCD,
COUNT(ANTP_SEFF_GRCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ANTP_SEFF_GRCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ANTP_SEFF_GRCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_ANTP' AND ENG_COL_NM = 'ANTP_SEFF_GRCD';

-- 11198 // 유방암 항암요법치료목적별 
	WITH W1 AS (SELECT 	11198 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.ANTP_STRT_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.ANTP_TRTM_PRPS_CD FROM BRCN_TRTM_ANTP AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	ANTP_STRT_YMD BETWEEN '20100101' AND '20211231' AND A.ANTP_TRTM_PRPS_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11198 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 항암요법치료목적별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.ANTP_TRTM_PRPS_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, ANTP_TRTM_PRPS_CD,
COUNT(ANTP_TRTM_PRPS_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, ANTP_TRTM_PRPS_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(ANTP_TRTM_PRPS_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_ANTP' AND ENG_COL_NM = 'ANTP_TRTM_PRPS_CD';

-- 11199 // 유방암 방사선치료종류별 
	WITH W1 AS (SELECT 	11199 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_KNCD FROM BRCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.RDT_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11199 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 방사선치료종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RDT_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_KNCD,
COUNT(RDT_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_RD' AND ENG_COL_NM = 'RDT_KNCD';

-- 11200 // 유방암 방사선치료EDI코드별 
	WITH W1 AS (SELECT 	11200 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_EDI_CD FROM BRCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.RDT_EDI_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11200 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 방사선치료EDI코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RDT_EDI_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_EDI_CD,
COUNT(RDT_EDI_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_EDI_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_EDI_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_RD' AND ENG_COL_NM = 'RDT_EDI_CD';

-- 11201 // 유방암 방사선치료EDI명별 
	WITH W1 AS (SELECT 	11201 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_EDI_NM FROM BRCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.RDT_EDI_NM IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11201 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 방사선치료EDI명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RDT_EDI_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_EDI_NM,
COUNT(RDT_EDI_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_EDI_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_EDI_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_RD' AND ENG_COL_NM = 'RDT_EDI_NM';

-- 11202 // 유방암 방사선치료SNOMEDCT코드별 
	WITH W1 AS (SELECT 	11202 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_SMCT_CD FROM BRCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.RDT_SMCT_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11202 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 방사선치료SNOMEDCT코드별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RDT_SMCT_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_SMCT_CD,
COUNT(RDT_SMCT_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_SMCT_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_SMCT_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_RD' AND ENG_COL_NM = 'RDT_SMCT_CD';

-- 11203 // 유방암 방사선치료SNOMEDCT명별 
	WITH W1 AS (SELECT 	11203 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_SMCT_NM FROM BRCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.RDT_SMCT_NM IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11203 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 방사선치료SNOMEDCT명별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RDT_SMCT_NM AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_SMCT_NM,
COUNT(RDT_SMCT_NM) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_SMCT_NM) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_SMCT_NM) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_RD' AND ENG_COL_NM = 'RDT_SMCT_NM';

-- 11204 // 유방암 방사선치료목적별 
	WITH W1 AS (SELECT 	11204 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_PRPS_CD FROM BRCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.RDT_PRPS_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11204 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 방사선치료목적별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RDT_PRPS_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_PRPS_CD,
COUNT(RDT_PRPS_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_PRPS_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_PRPS_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_RD' AND ENG_COL_NM = 'RDT_PRPS_CD';

-- 11205 // 유방암 방사선치료부위별 
	WITH W1 AS (SELECT 	11205 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_SITE_CD FROM BRCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.RDT_SITE_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11205 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 방사선치료부위별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RDT_SITE_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_SITE_CD,
COUNT(RDT_SITE_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_SITE_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_SITE_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_RD' AND ENG_COL_NM = 'RDT_SITE_CD';

-- 11206 // 유방암 방사선선량별 
	WITH W1 AS (SELECT 	11206 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RD_GY FROM BRCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.RD_GY IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11206 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 방사선선량별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RD_GY AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RD_GY,
COUNT(RD_GY) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RD_GY) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RD_GY) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_RD' AND ENG_COL_NM = 'RD_GY';

-- 11207 // 유방암 방사선시행횟수별 
	WITH W1 AS (SELECT 	11207 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RD_IMPL_NT FROM BRCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.RD_IMPL_NT IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11207 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 방사선시행횟수별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RD_IMPL_NT AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RD_IMPL_NT,
COUNT(RD_IMPL_NT) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RD_IMPL_NT) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RD_IMPL_NT) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_RD' AND ENG_COL_NM = 'RD_IMPL_NT';

-- 11208 // 유방암 방사선총선량별 
	WITH W1 AS (SELECT 	11208 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RD_TOTL_GY FROM BRCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.RD_TOTL_GY IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11208 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 방사선총선량별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RD_TOTL_GY AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RD_TOTL_GY,
COUNT(RD_TOTL_GY) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RD_TOTL_GY) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RD_TOTL_GY) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_RD' AND ENG_COL_NM = 'RD_TOTL_GY';

-- 11209 // 유방암 방사선치료부작용시기구분별 
	WITH W1 AS (SELECT 	11209 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_SEFF_PERD_SPCD FROM BRCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.RDT_SEFF_PERD_SPCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11209 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 방사선치료부작용시기구분별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RDT_SEFF_PERD_SPCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_SEFF_PERD_SPCD,
COUNT(RDT_SEFF_PERD_SPCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_SEFF_PERD_SPCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_SEFF_PERD_SPCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_RD' AND ENG_COL_NM = 'RDT_SEFF_PERD_SPCD';

-- 11210 // 유방암 방사선치료부작용종류별 
	WITH W1 AS (SELECT 	11210 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_SEFF_KNCD FROM BRCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.RDT_SEFF_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11210 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 방사선치료부작용종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RDT_SEFF_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_SEFF_KNCD,
COUNT(RDT_SEFF_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_SEFF_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_SEFF_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_RD' AND ENG_COL_NM = 'RDT_SEFF_KNCD';

-- 11211 // 유방암 방사선치료부작용등급별 
	WITH W1 AS (SELECT 	11211 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_SEFF_GRCD FROM BRCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.RDT_SEFF_GRCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11211 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 방사선치료부작용등급별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RDT_SEFF_GRCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_SEFF_GRCD,
COUNT(RDT_SEFF_GRCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_SEFF_GRCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_SEFF_GRCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_RD' AND ENG_COL_NM = 'RDT_SEFF_GRCD';

-- 11212 // 유방암 방사선치료평가항목별 
	WITH W1 AS (SELECT 	11212 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RDT_PRSC_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RDT_ASMT_ITEM_CD FROM BRCN_TRTM_RD AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RDT_PRSC_YMD BETWEEN '20100101' AND '20211231' AND A.RDT_ASMT_ITEM_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11212 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 방사선치료평가항목별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RDT_ASMT_ITEM_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RDT_ASMT_ITEM_CD,
COUNT(RDT_ASMT_ITEM_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RDT_ASMT_ITEM_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RDT_ASMT_ITEM_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_TRTM_RD' AND ENG_COL_NM = 'RDT_ASMT_ITEM_CD';

-- 11213 // 유방암 재발부위별 
	WITH W1 AS (SELECT 	11213 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RLDG_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RLPS_SITE_CD FROM BRCN_FUOR_RLPS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RLDG_YMD BETWEEN '20100101' AND '20211231' AND A.RLPS_SITE_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11213 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 재발부위별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RLPS_SITE_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RLPS_SITE_CD,
COUNT(RLPS_SITE_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RLPS_SITE_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RLPS_SITE_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_FUOR_RLPS' AND ENG_COL_NM = 'RLPS_SITE_CD';

-- 11214 // 유방암 재발진단방법별 
	WITH W1 AS (SELECT 	11214 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RLDG_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RLDG_MTCD FROM BRCN_FUOR_RLPS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RLDG_YMD BETWEEN '20100101' AND '20211231' AND A.RLDG_MTCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11214 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 재발진단방법별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RLDG_MTCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RLDG_MTCD,
COUNT(RLDG_MTCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RLDG_MTCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RLDG_MTCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_FUOR_RLPS' AND ENG_COL_NM = 'RLDG_MTCD';

-- 11215 // 유방암 재발종류별 
	WITH W1 AS (SELECT 	11215 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RLDG_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RLPS_KNCD FROM BRCN_FUOR_RLPS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RLDG_YMD BETWEEN '20100101' AND '20211231' AND A.RLPS_KNCD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11215 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 재발종류별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RLPS_KNCD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RLPS_KNCD,
COUNT(RLPS_KNCD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RLPS_KNCD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RLPS_KNCD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_FUOR_RLPS' AND ENG_COL_NM = 'RLPS_KNCD';

-- 11216 // 유방암 재발증상별 
	WITH W1 AS (SELECT 	11216 AS SMRY_STATS_NO, A.HOSP_CD, A.PT_SBST_NO, SUBSTRING(A.RLDG_YMD,1,4) AS CRIT_YR, 
B.AGE AS PT_AGE, B.SEX AS PT_SEX_CD, A.RLPS_SYM_CD FROM BRCN_FUOR_RLPS AS A	INNER JOIN CNCR_RGST AS B ON A.HOSP_CD = B.HCODE AND A.PT_SBST_NO = B.PTNO WHERE 	RLDG_YMD BETWEEN '20100101' AND '20211231' AND A.RLPS_SYM_CD IS NOT NULL)
INSERT INTO CNCR_TBL_SMRY_STATS SELECT	11216 AS SMRY_STATS_NO, A.HOSP_CD, A.CRIT_YR,
'유방암 재발증상별' AS SMRY_STATS_NM, D.TBL_ID, D.COL_ID, A.PT_AGE, A.PT_SEX_CD,
 A.RLPS_SYM_CD AS STATS_TRGT_VL, A.NCS, B.WHOL_NCS, A.PT_CNT, B.WHOL_PT_CNT,
'20230216' AS STATS_WORK_YMD, '20100101' AS COLL_STRT_YMD, '20211231' AS COLL_END_YMD, CURRENT_TIMESTAMP AS CRTN_DT FROM	(SELECT HOSP_CD, CRIT_YR, PT_AGE, PT_SEX_CD, RLPS_SYM_CD,
COUNT(RLPS_SYM_CD) AS NCS,  COUNT(DISTINCT PT_SBST_NO) AS PT_CNT
FROM W1 GROUP BY HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD, RLPS_SYM_CD) AS A	INNER JOIN ( SELECT HOSP_CD,CRIT_YR,PT_AGE,PT_SEX_CD,
COUNT(RLPS_SYM_CD) AS WHOL_NCS, COUNT(DISTINCT PT_SBST_NO) AS WHOL_PT_CNT
FROM W1 GROUP BY HOSP_CD, CRIT_YR,PT_AGE,PT_SEX_CD) AS B	ON A.HOSP_CD = B.HOSP_CD AND A.CRIT_YR=B.CRIT_YR AND A.PT_AGE = B.PT_AGE AND A.PT_SEX_CD = B.PT_SEX_CD
INNER JOIN (SELECT COUNT(PTNO) AS WHOL_PT_CNT FROM CNCR_RGST) AS C ON 1=1 
INNER JOIN(SELECT * FROM CNCR_TBL_COL_META) AS D ON ENG_TBL_NM = 'BRCN_FUOR_RLPS' AND ENG_COL_NM = 'RLPS_SYM_CD';
